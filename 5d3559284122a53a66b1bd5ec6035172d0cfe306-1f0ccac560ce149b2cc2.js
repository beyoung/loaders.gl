(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{"+7vx":function(e,t,n){"use strict";n.d(t,"a",(function(){return P}));var i=n("rePB"),r=n("1OyB"),o=n("vuIU"),a=n("ReuC"),s=n("Ji7U"),l=n("md7G"),c=n("foSv"),u=n("K4gp"),f=n("BQ9P"),p=n("V3d6"),d=n("K7jV"),g=n("ykdB"),h=n("0i8A");function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){Object(i.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(c.a)(e);if(t){var r=Object(c.a)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Object(l.a)(this,n)}}var b=[0,0,0,255],x={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:function(e){return e.position}},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:b},getLineColor:{type:"accessor",value:b},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}},P=function(e){Object(s.a)(n,e);var t=m(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"getShaders",value:function(){return Object(a.a)(Object(c.a)(n.prototype),"getShaders",this).call(this,{vs:"#define SHADER_NAME scatterplot-layer-vertex-shader\n\nattribute vec3 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute float instanceRadius;\nattribute float instanceLineWidths;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\nuniform float opacity;\nuniform float radiusScale;\nuniform float radiusMinPixels;\nuniform float radiusMaxPixels;\nuniform float lineWidthScale;\nuniform float lineWidthMinPixels;\nuniform float lineWidthMaxPixels;\nuniform float stroked;\nuniform bool filled;\nuniform bool billboard;\nuniform int radiusUnits;\nuniform int lineWidthUnits;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\nvarying float outerRadiusPixels;\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  outerRadiusPixels = clamp(\n    project_size_to_pixel(radiusScale * instanceRadius, radiusUnits),\n    radiusMinPixels, radiusMaxPixels\n  );\n  float lineWidthPixels = clamp(\n    project_size_to_pixel(lineWidthScale * instanceLineWidths, lineWidthUnits),\n    lineWidthMinPixels, lineWidthMaxPixels\n  );\n  outerRadiusPixels += stroked * lineWidthPixels / 2.0;\n  unitPosition = positions.xy;\n  geometry.uv = unitPosition;\n  geometry.pickingColor = instancePickingColors;\n\n  innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;\n  \n  if (billboard) {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    vec3 offset = positions * outerRadiusPixels;\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  } else {\n    vec3 offset = positions * project_pixel_size(outerRadiusPixels);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);\n  }\n\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);\n  DECKGL_FILTER_COLOR(vFillColor, geometry);\n  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);\n  DECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",fs:"#define SHADER_NAME scatterplot-layer-fragment-shader\n\nprecision highp float;\n\nuniform bool filled;\nuniform float stroked;\nuniform bool antialiasing;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\nvarying float outerRadiusPixels;\n\nvoid main(void) {\n  geometry.uv = unitPosition;\n\n  float distToCenter = length(unitPosition) * outerRadiusPixels;\n  float inCircle = antialiasing ? \n    smoothedge(distToCenter, outerRadiusPixels) : \n    step(distToCenter, outerRadiusPixels);\n\n  if (inCircle == 0.0) {\n    discard;\n  }\n\n  if (stroked > 0.5) {\n    float isLine = antialiasing ? \n      smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :\n      step(innerUnitRadius * outerRadiusPixels, distToCenter);\n\n    if (filled) {\n      gl_FragColor = mix(vFillColor, vLineColor, isLine);\n    } else {\n      if (isLine == 0.0) {\n        discard;\n      }\n      gl_FragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);\n    }\n  } else if (filled) {\n    gl_FragColor = vFillColor;\n  } else {\n    discard;\n  }\n\n  gl_FragColor.a *= inCircle;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[u.a,f.a]})}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}},{key:"updateState",value:function(e){var t=e.props,i=e.oldProps,r=e.changeFlags;if(Object(a.a)(Object(c.a)(n.prototype),"updateState",this).call(this,{props:t,oldProps:i,changeFlags:r}),r.extensionsChanged){var o,s=this.context.gl;null===(o=this.state.model)||void 0===o||o.delete(),this.state.model=this._getModel(s),this.getAttributeManager().invalidateAll()}}},{key:"draw",value:function(e){var t=e.uniforms,n=this.props,i=n.radiusUnits,r=n.radiusScale,o=n.radiusMinPixels,a=n.radiusMaxPixels,s=n.stroked,l=n.filled,c=n.billboard,u=n.antialiasing,f=n.lineWidthUnits,d=n.lineWidthScale,g=n.lineWidthMinPixels,h=n.lineWidthMaxPixels;this.state.model.setUniforms(t).setUniforms({stroked:s?1:0,filled:l,billboard:c,antialiasing:u,radiusUnits:p.d[i],radiusScale:r,radiusMinPixels:o,radiusMaxPixels:a,lineWidthUnits:p.d[f],lineWidthScale:d,lineWidthMinPixels:g,lineWidthMaxPixels:h}).draw()}},{key:"_getModel",value:function(e){return new g.a(e,y(y({},this.getShaders()),{},{id:this.props.id,geometry:new h.a({drawMode:6,vertexCount:4,attributes:{positions:{size:3,value:new Float32Array([-1,-1,0,1,-1,0,1,1,0,-1,1,0])}}}),isInstanced:!0}))}}]),n}(d.a);P.layerName="ScatterplotLayer",P.defaultProps=x},"/qmn":function(e,t,n){var i=n("2oRo");e.exports=i.Promise},"8GlL":function(e,t,n){"use strict";var i=n("HAuM"),r=function(e){var t,n;this.promise=new e((function(e,i){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=i})),this.resolve=i(t),this.reject=i(n)};e.exports.f=function(e){return new r(e)}},SEBh:function(e,t,n){var i=n("glrk"),r=n("HAuM"),o=n("tiKp")("species");e.exports=function(e,t){var n,a=i(e).constructor;return void 0===a||null==(n=i(a)[o])?t:r(n)}},URgk:function(e,t,n){(function(e){var i=void 0!==e&&e||"undefined"!=typeof self&&self||window,r=Function.prototype.apply;function o(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new o(r.call(setTimeout,i,arguments),clearTimeout)},t.setInterval=function(){return new o(r.call(setInterval,i,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(i,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},n("YBdB"),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n("yLpj"))},VmRL:function(e,t,n){"use strict";function i(e,t,n){n=n||2;var i,s,l,c,u,d,g,v=t&&t.length,y=v?t[0]*n:e.length,m=r(e,0,y,n,!0),b=[];if(!m||m.next===m.prev)return b;if(v&&(m=function(e,t,n,i){var a,s,l,c,u,d=[];for(a=0,s=t.length;a<s;a++)l=t[a]*i,c=a<s-1?t[a+1]*i:e.length,(u=r(e,l,c,i,!1))===u.next&&(u.steiner=!0),d.push(h(u));for(d.sort(f),a=0;a<d.length;a++)p(d[a],n),n=o(n,n.next);return n}(e,t,m,n)),e.length>80*n){i=l=e[0],s=c=e[1];for(var x=n;x<y;x+=n)(u=e[x])<i&&(i=u),(d=e[x+1])<s&&(s=d),u>l&&(l=u),d>c&&(c=d);g=0!==(g=Math.max(l-i,c-s))?1/g:0}return a(m,b,n,i,s,g),b}function r(e,t,n,i,r){var o,a;if(r===A(e,t,n,i)>0)for(o=t;o<n;o+=i)a=w(o,e[o],e[o+1],a);else for(o=n-i;o>=t;o-=i)a=w(o,e[o],e[o+1],a);return a&&b(a,a.next)&&(C(a),a=a.next),a}function o(e,t){if(!e)return e;t||(t=e);var n,i=e;do{if(n=!1,i.steiner||!b(i,i.next)&&0!==m(i.prev,i,i.next))i=i.next;else{if(C(i),(i=t=i.prev)===i.next)break;n=!0}}while(n||i!==t);return t}function a(e,t,n,i,r,f,p){if(e){!p&&f&&function(e,t,n,i){var r=e;do{null===r.z&&(r.z=g(r.x,r.y,t,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==e);r.prevZ.nextZ=null,r.prevZ=null,function(e){var t,n,i,r,o,a,s,l,c=1;do{for(n=e,e=null,o=null,a=0;n;){for(a++,i=n,s=0,t=0;t<c&&(s++,i=i.nextZ);t++);for(l=c;s>0||l>0&&i;)0!==s&&(0===l||!i||n.z<=i.z)?(r=n,n=n.nextZ,s--):(r=i,i=i.nextZ,l--),o?o.nextZ=r:e=r,r.prevZ=o,o=r;n=i}o.nextZ=null,c*=2}while(a>1)}(r)}(e,i,r,f);for(var d,h,v=e;e.prev!==e.next;)if(d=e.prev,h=e.next,f?l(e,i,r,f):s(e))t.push(d.i/n),t.push(e.i/n),t.push(h.i/n),C(e),e=h.next,v=h.next;else if((e=h)===v){p?1===p?a(e=c(o(e),t,n),t,n,i,r,f,2):2===p&&u(e,t,n,i,r,f):a(o(e),t,n,i,r,f,1);break}}}function s(e){var t=e.prev,n=e,i=e.next;if(m(t,n,i)>=0)return!1;for(var r=e.next.next;r!==e.prev;){if(v(t.x,t.y,n.x,n.y,i.x,i.y,r.x,r.y)&&m(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function l(e,t,n,i){var r=e.prev,o=e,a=e.next;if(m(r,o,a)>=0)return!1;for(var s=r.x<o.x?r.x<a.x?r.x:a.x:o.x<a.x?o.x:a.x,l=r.y<o.y?r.y<a.y?r.y:a.y:o.y<a.y?o.y:a.y,c=r.x>o.x?r.x>a.x?r.x:a.x:o.x>a.x?o.x:a.x,u=r.y>o.y?r.y>a.y?r.y:a.y:o.y>a.y?o.y:a.y,f=g(s,l,t,n,i),p=g(c,u,t,n,i),d=e.prevZ,h=e.nextZ;d&&d.z>=f&&h&&h.z<=p;){if(d!==e.prev&&d!==e.next&&v(r.x,r.y,o.x,o.y,a.x,a.y,d.x,d.y)&&m(d.prev,d,d.next)>=0)return!1;if(d=d.prevZ,h!==e.prev&&h!==e.next&&v(r.x,r.y,o.x,o.y,a.x,a.y,h.x,h.y)&&m(h.prev,h,h.next)>=0)return!1;h=h.nextZ}for(;d&&d.z>=f;){if(d!==e.prev&&d!==e.next&&v(r.x,r.y,o.x,o.y,a.x,a.y,d.x,d.y)&&m(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;h&&h.z<=p;){if(h!==e.prev&&h!==e.next&&v(r.x,r.y,o.x,o.y,a.x,a.y,h.x,h.y)&&m(h.prev,h,h.next)>=0)return!1;h=h.nextZ}return!0}function c(e,t,n){var i=e;do{var r=i.prev,a=i.next.next;!b(r,a)&&x(r,i,i.next,a)&&S(r,a)&&S(a,r)&&(t.push(r.i/n),t.push(i.i/n),t.push(a.i/n),C(i),C(i.next),i=e=a),i=i.next}while(i!==e);return o(i)}function u(e,t,n,i,r,s){var l=e;do{for(var c=l.next.next;c!==l.prev;){if(l.i!==c.i&&y(l,c)){var u=_(l,c);return l=o(l,l.next),u=o(u,u.next),a(l,t,n,i,r,s),void a(u,t,n,i,r,s)}c=c.next}l=l.next}while(l!==e)}function f(e,t){return e.x-t.x}function p(e,t){if(t=function(e,t){var n,i=t,r=e.x,o=e.y,a=-1/0;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){var s=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(s<=r&&s>a){if(a=s,s===r){if(o===i.y)return i;if(o===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}i=i.next}while(i!==t);if(!n)return null;if(r===a)return n;var l,c=n,u=n.x,f=n.y,p=1/0;i=n;do{r>=i.x&&i.x>=u&&r!==i.x&&v(o<f?r:a,o,u,f,o<f?a:r,o,i.x,i.y)&&(l=Math.abs(o-i.y)/(r-i.x),S(i,e)&&(l<p||l===p&&(i.x>n.x||i.x===n.x&&d(n,i)))&&(n=i,p=l)),i=i.next}while(i!==c);return n}(e,t)){var n=_(t,e);o(t,t.next),o(n,n.next)}}function d(e,t){return m(e.prev,e,t.prev)<0&&m(t.next,e,e.next)<0}function g(e,t,n,i,r){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*r)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*r)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function h(e){var t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function v(e,t,n,i,r,o,a,s){return(r-a)*(t-s)-(e-a)*(o-s)>=0&&(e-a)*(i-s)-(n-a)*(t-s)>=0&&(n-a)*(o-s)-(r-a)*(i-s)>=0}function y(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&x(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(S(e,t)&&S(t,e)&&function(e,t){var n=e,i=!1,r=(e.x+t.x)/2,o=(e.y+t.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&r<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==e);return i}(e,t)&&(m(e.prev,e,t.prev)||m(e,t.prev,t))||b(e,t)&&m(e.prev,e,e.next)>0&&m(t.prev,t,t.next)>0)}function m(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function b(e,t){return e.x===t.x&&e.y===t.y}function x(e,t,n,i){var r=O(m(e,t,n)),o=O(m(e,t,i)),a=O(m(n,i,e)),s=O(m(n,i,t));return r!==o&&a!==s||(!(0!==r||!P(e,n,t))||(!(0!==o||!P(e,i,t))||(!(0!==a||!P(n,e,i))||!(0!==s||!P(n,t,i)))))}function P(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function O(e){return e>0?1:e<0?-1:0}function S(e,t){return m(e.prev,e,e.next)<0?m(e,t,e.next)>=0&&m(e,e.prev,t)>=0:m(e,t,e.prev)<0||m(e,e.next,t)<0}function _(e,t){var n=new j(e.i,e.x,e.y),i=new j(t.i,t.x,t.y),r=e.next,o=t.prev;return e.next=t,t.prev=e,n.next=r,r.prev=n,i.next=n,n.prev=i,o.next=i,i.prev=o,i}function w(e,t,n,i){var r=new j(e,t,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function C(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function j(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function A(e,t,n,i){for(var r=0,o=t,a=n-i;o<n;o+=i)r+=(e[a]-e[o])*(e[o+1]+e[a+1]),a=o;return r}e.exports=i,e.exports.default=i,i.deviation=function(e,t,n,i){var r=t&&t.length,o=r?t[0]*n:e.length,a=Math.abs(A(e,0,o,n));if(r)for(var s=0,l=t.length;s<l;s++){var c=t[s]*n,u=s<l-1?t[s+1]*n:e.length;a-=Math.abs(A(e,c,u,n))}var f=0;for(s=0;s<i.length;s+=3){var p=i[s]*n,d=i[s+1]*n,g=i[s+2]*n;f+=Math.abs((e[p]-e[g])*(e[d+1]-e[p+1])-(e[p]-e[d])*(e[g+1]-e[p+1]))}return 0===a&&0===f?0:Math.abs((f-a)/a)},i.flatten=function(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},i=0,r=0;r<e.length;r++){for(var o=0;o<e[r].length;o++)for(var a=0;a<t;a++)n.vertices.push(e[r][o][a]);r>0&&(i+=e[r-1].length,n.holes.push(i))}return n}},YBdB:function(e,t,n){(function(e,t){!function(e,n){"use strict";if(!e.setImmediate){var i,r,o,a,s,l=1,c={},u=!1,f=e.document,p=Object.getPrototypeOf&&Object.getPrototypeOf(e);p=p&&p.setTimeout?p:e,"[object process]"==={}.toString.call(e.process)?i=function(e){t.nextTick((function(){g(e)}))}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?e.MessageChannel?((o=new MessageChannel).port1.onmessage=function(e){g(e.data)},i=function(e){o.port2.postMessage(e)}):f&&"onreadystatechange"in f.createElement("script")?(r=f.documentElement,i=function(e){var t=f.createElement("script");t.onreadystatechange=function(){g(e),t.onreadystatechange=null,r.removeChild(t),t=null},r.appendChild(t)}):i=function(e){setTimeout(g,0,e)}:(a="setImmediate$"+Math.random()+"$",s=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(a)&&g(+t.data.slice(a.length))},e.addEventListener?e.addEventListener("message",s,!1):e.attachEvent("onmessage",s),i=function(t){e.postMessage(a+t,"*")}),p.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var r={callback:e,args:t};return c[l]=r,i(l),l++},p.clearImmediate=d}function d(e){delete c[e]}function g(e){if(u)setTimeout(g,0,e);else{var t=c[e];if(t){u=!0;try{!function(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(void 0,n)}}(t)}finally{d(e),u=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,n("yLpj"),n("8oxB"))},cwYr:function(e,t,n){"use strict";n.d(t,"a",(function(){return Pn}));var i=n("1OyB"),r=n("vuIU"),o=n("ReuC"),a=n("Ji7U"),s=n("md7G"),l=n("foSv"),c=n("rePB"),u=n("Jh/b"),f=n("5lV4");function p(e){for(var t=e.data,n=e.getIndex,i=e.dataRange,r=e.replace,o=i.startRow,a=void 0===o?0:o,s=i.endRow,l=void 0===s?1/0:s,c=t.length,u=c,f=c,p=0;p<c;p++){var d=n(t[p]);if(u>p&&d>=a&&(u=p),d>=l){f=p;break}}for(var g=u,h=f-u!==r.length,v=h&&t.slice(f),y=0;y<r.length;y++)t[g++]=r[y];if(h){for(var m=0;m<v.length;m++)t[g++]=v[m];t.length=g}return{startRow:u,endRow:u+r.length}}function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){Object(c.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t){if(!e)return null;var n="startIndices"in e?e.startIndices[t]:t,i=e.featureIds.value[n];return-1!==n?function(e,t,n){var i={properties:g({},e.properties[t])};for(var r in e.numericProps)i.properties[r]=e.numericProps[r].value[n];return i}(e,i,n):null}var v,y=n("K4gp"),m=n("BQ9P"),b=n("V3d6"),x=n("K7jV"),P=n("ykdB"),O=n("0i8A"),S=(n("p532"),n("MdWm")),_=n("p7wt"),w=n("f5Sf"),C=n("j7CB"),j=n("xszv"),A=n("rpwb");function L(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return z(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return z(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach((function(t){Object(c.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var M=function(){},E=(v={},Object(c.a)(v,10241,9987),Object(c.a)(v,10240,9729),Object(c.a)(v,10242,33071),Object(c.a)(v,10243,33071),v);function T(e){return e&&(e.id||e.url)}function F(e,t,n){for(var i=0;i<t.length;i++){var r=t[i],o=r.icon,a=r.xOffset;e[T(o)]=k(k({},o),{},{x:a,y:n})}}var R=function(){function e(t,n){var r=n.onUpdate,o=void 0===r?M:r,a=n.onError,s=void 0===a?M:a;Object(i.a)(this,e),this.gl=t,this.onUpdate=o,this.onError=s,this._loadOptions=null,this._getIcon=null,this._texture=null,this._externalTexture=null,this._mapping={},this._pendingCount=0,this._autoPacking=!1,this._xOffset=0,this._yOffset=0,this._rowHeight=0,this._buffer=4,this._canvasWidth=1024,this._canvasHeight=0,this._canvas=null}return Object(r.a)(e,[{key:"finalize",value:function(){var e;null===(e=this._texture)||void 0===e||e.delete()}},{key:"getTexture",value:function(){return this._texture||this._externalTexture}},{key:"getIconMapping",value:function(e){var t=this._autoPacking?T(e):e;return this._mapping[t]||{}}},{key:"setProps",value:function(e){var t=e.loadOptions,n=e.autoPacking,i=e.iconAtlas,r=e.iconMapping,o=e.data,a=e.getIcon;t&&(this._loadOptions=t),void 0!==n&&(this._autoPacking=n),a&&(this._getIcon=a),r&&(this._mapping=r),i&&this._updateIconAtlas(i),this._autoPacking&&(o||a)&&"undefined"!=typeof document&&(this._canvas=this._canvas||document.createElement("canvas"),this._updateAutoPacking(o))}},{key:"isLoaded",get:function(){return 0===this._pendingCount}},{key:"_updateIconAtlas",value:function(e){var t;null===(t=this._texture)||void 0===t||t.delete(),this._texture=null,this._externalTexture=e,this.onUpdate()}},{key:"_updateAutoPacking",value:function(e){var t,n,i,r,o,a,s=Object.values(function(e,t,n){if(!e||!t)return null;n=n||{};var i,r={},o=Object(A.a)(e),a=o.iterable,s=o.objectInfo,l=L(a);try{for(l.s();!(i=l.n()).done;){var c=i.value;s.index++;var u=t(c,s),f=T(u);if(!u)throw new Error("Icon is missing.");if(!u.url)throw new Error("Icon url is missing.");r[f]||n[f]&&u.url===n[f].url||(r[f]=k(k({},u),{},{source:c,sourceIndex:s.index}))}}catch(p){l.e(p)}finally{l.f()}return r}(e,this._getIcon,this._mapping)||{});if(s.length>0){var l=function(e){for(var t,n=e.icons,i=e.buffer,r=e.mapping,o=void 0===r?{}:r,a=e.xOffset,s=void 0===a?0:a,l=e.yOffset,c=void 0===l?0:l,u=e.rowHeight,f=void 0===u?0:u,p=e.canvasWidth,d=[],g=0;g<n.length;g++){var h=n[g];if(!o[T(h)]){var v=h.height,y=h.width;s+y+i>p&&(F(o,d,c),s=0,c=f+c+i,f=0,d=[]),d.push({icon:h,xOffset:s}),s=s+y+i,f=Math.max(f,v)}}return d.length>0&&F(o,d,c),{mapping:o,rowHeight:f,xOffset:s,yOffset:c,canvasWidth:p,canvasHeight:(t=f+c+i,Math.pow(2,Math.ceil(Math.log2(t))))}}({icons:s,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset}),c=l.mapping,u=l.xOffset,f=l.yOffset,p=l.rowHeight,d=l.canvasHeight;this._rowHeight=p,this._mapping=c,this._xOffset=u,this._yOffset=f,this._canvasHeight=d,this._texture||(this._texture=new w.a(this.gl,{width:this._canvasWidth,height:this._canvasHeight,parameters:E})),this._texture.height!==this._canvasHeight&&(this._texture=(this.gl,t=this._texture,n=this._canvasWidth,i=this._canvasHeight,r=t.width,o=t.height,a=Object(S.a)(t,{width:n,height:i}),Object(_.b)(t,a,{targetY:0,width:r,height:o}),t.delete(),a)),this.onUpdate(),this._loadIcons(s)}}},{key:"_loadIcons",value:function(e){var t,n=this,i=this._canvas.getContext("2d"),r=L(e);try{var o=function(){var e=t.value;n._pendingCount++,Object(j.a)(e.url,C.a,n._loadOptions).then((function(t){var r=T(e),o=n._mapping[r],a=o.x,s=o.y,l=o.width,c=o.height,u=function(e,t,n,i){return n===t.width&&i===t.height?t:(e.canvas.height=i,e.canvas.width=n,e.clearRect(0,0,e.canvas.width,e.canvas.height),e.drawImage(t,0,0,t.width,t.height,0,0,n,i),e.canvas)}(i,t,l,c);n._texture.setSubImageData({data:u,x:a,y:s,width:l,height:c}),n._texture.generateMipmap(),n.onUpdate()})).catch((function(t){n.onError({url:e.url,source:e.source,sourceIndex:e.sourceIndex,loadOptions:n._loadOptions,error:t})})).finally((function(){n._pendingCount--}))};for(r.s();!(t=r.n()).done;)o()}catch(a){r.e(a)}finally{r.f()}}}]),e}();function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function B(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){Object(c.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function W(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(l.a)(e);if(t){var r=Object(l.a)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Object(s.a)(this,n)}}var G=[0,0,0,255],U={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:function(e){return e.position}},getIcon:{type:"accessor",value:function(e){return e.icon}},getColor:{type:"accessor",value:G},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,compare:!1,optional:!0}},N=function(e){Object(a.a)(n,e);var t=W(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"getShaders",value:function(){return Object(o.a)(Object(l.a)(n.prototype),"getShaders",this).call(this,{vs:"#define SHADER_NAME icon-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute vec4 instanceIconFrames;\nattribute float instanceColorModes;\nattribute vec2 instanceOffsets;\nattribute vec2 instancePixelOffset;\n\nuniform float sizeScale;\nuniform vec2 iconsTextureDim;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform bool billboard;\nuniform int sizeUnits;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = angle * PI / 180.0;\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = positions;\n  geometry.pickingColor = instancePickingColors;\n  uv = positions;\n\n  vec2 iconSize = instanceIconFrames.zw;\n  float sizePixels = clamp(\n    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits), \n    sizeMinPixels, sizeMaxPixels\n  );\n  float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;\n  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;\n  pixelOffset += instancePixelOffset;\n  pixelOffset.y *= -1.0;\n\n  if (billboard)  {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    vec3 offset = vec3(pixelOffset, 0.0);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n\n  } else {\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\n    DECKGL_FILTER_SIZE(offset_common, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position); \n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  vTextureCoords = mix(\n    instanceIconFrames.xy,\n    instanceIconFrames.xy + iconSize,\n    (positions.xy + 1.0) / 2.0\n  ) / iconsTextureDim;\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n\n  vColorMode = instanceColorModes;\n}\n",fs:"#define SHADER_NAME icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float alphaCutoff;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  vec4 texColor = texture2D(iconsTexture, vTextureCoords);\n  vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);\n  float a = texColor.a * opacity * vColor.a;\n\n  if (a < alphaCutoff) {\n    discard;\n  }\n\n  gl_FragColor = vec4(color, a);\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[y.a,m.a]})}},{key:"initializeState",value:function(){this.state={iconManager:new R(this.context.gl,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:5121,accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:G},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}},{key:"updateState",value:function(e){var t=e.oldProps,i=e.props,r=e.changeFlags;Object(o.a)(Object(l.a)(n.prototype),"updateState",this).call(this,{props:i,oldProps:t,changeFlags:r});var a=this.getAttributeManager(),s=i.iconAtlas,c=i.iconMapping,u=i.data,f=i.getIcon,p=this.state.iconManager;p.setProps({loadOptions:i.loadOptions});var d=!1;if(s||this.internalState.isAsyncPropLoading("iconAtlas")?(t.iconAtlas!==i.iconAtlas&&p.setProps({iconAtlas:s,autoPacking:!1}),t.iconMapping!==i.iconMapping&&(p.setProps({iconMapping:c}),d=!0)):p.setProps({autoPacking:!0}),(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getIcon))&&p.setProps({data:u,getIcon:f}),d&&(a.invalidate("instanceOffsets"),a.invalidate("instanceIconFrames"),a.invalidate("instanceColorModes")),r.extensionsChanged){var g,h=this.context.gl;null===(g=this.state.model)||void 0===g||g.delete(),this.state.model=this._getModel(h),a.invalidateAll()}}},{key:"isLoaded",get:function(){return Object(o.a)(Object(l.a)(n.prototype),"isLoaded",this)&&this.state.iconManager.isLoaded}},{key:"finalizeState",value:function(){Object(o.a)(Object(l.a)(n.prototype),"finalizeState",this).call(this),this.state.iconManager.finalize()}},{key:"draw",value:function(e){var t=e.uniforms,n=this.props,i=n.sizeScale,r=n.sizeMinPixels,o=n.sizeMaxPixels,a=n.sizeUnits,s=n.billboard,l=n.alphaCutoff,c=this.state.iconManager.getTexture();c&&this.state.model.setUniforms(t).setUniforms({iconsTexture:c,iconsTextureDim:[c.width,c.height],sizeUnits:b.d[a],sizeScale:i,sizeMinPixels:r,sizeMaxPixels:o,billboard:s,alphaCutoff:l}).draw()}},{key:"_getModel",value:function(e){return new P.a(e,B(B({},this.getShaders()),{},{id:this.props.id,geometry:new O.a({drawMode:6,attributes:{positions:{size:2,value:new Float32Array([-1,-1,-1,1,1,1,1,-1])}}}),isInstanced:!0}))}},{key:"_onUpdate",value:function(){this.setNeedsRedraw()}},{key:"_onError",value:function(e){var t=this.getCurrentLayer().props.onIconError;t?t(e):u.a.error(e.error)()}},{key:"getInstanceOffset",value:function(e){var t=this.state.iconManager.getIconMapping(e);return[t.width/2-t.anchorX||0,t.height/2-t.anchorY||0]}},{key:"getInstanceColorMode",value:function(e){return this.state.iconManager.getIconMapping(e).mask?1:0}},{key:"getInstanceIconFrame",value:function(e){var t=this.state.iconManager.getIconMapping(e);return[t.x||0,t.y||0,t.width||0,t.height||0]}}]),n}(x.a);N.layerName="IconLayer",N.defaultProps=U;var V=n("+7vx"),H=n("ODXe");function Z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function K(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(n),!0).forEach((function(t){Object(c.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function J(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(l.a)(e);if(t){var r=Object(l.a)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Object(s.a)(this,n)}}var X=[],$=function(e){Object(a.a)(n,e);var t=J(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"getShaders",value:function(){return K(K({},Object(o.a)(Object(l.a)(n.prototype),"getShaders",this).call(this)),{},{fs:"#define SHADER_NAME multi-icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float gamma;\nuniform bool sdf;\nuniform float alphaCutoff;\nuniform float buffer;\nuniform float outlineBuffer;\nuniform vec4 outlineColor;\n\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  if (!picking_uActive) {\n    float alpha = texture2D(iconsTexture, vTextureCoords).a;\n    vec4 color = vColor;\n    if (sdf) {\n      float distance = alpha;\n      alpha = smoothstep(buffer - gamma, buffer + gamma, distance);\n\n      if (outlineBuffer > 0.0) {\n        float inFill = alpha;\n        float inBorder = smoothstep(outlineBuffer - gamma, outlineBuffer + gamma, distance);\n        color = mix(outlineColor, vColor, inFill);\n        alpha = inBorder;\n      }\n    }\n    float a = alpha * color.a;\n    \n    if (a < alphaCutoff) {\n      discard;\n    }\n\n    gl_FragColor = vec4(color.rgb, a * opacity);\n  }\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n"})}},{key:"initializeState",value:function(){var e=this;Object(o.a)(Object(l.a)(n.prototype),"initializeState",this).call(this),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:5121,size:3,accessor:function(t,n){var i=n.index,r=n.target;return e.encodePickingColor(i,r)}}})}},{key:"updateState",value:function(e){Object(o.a)(Object(l.a)(n.prototype),"updateState",this).call(this,e);var t=e.props,i=e.oldProps,r=t.outlineColor;r!==i.outlineColor&&((r=r.map((function(e){return e/255})))[3]=Number.isFinite(r[3])?r[3]:1,this.setState({outlineColor:r})),!t.sdf&&t.outlineWidth&&u.a.warn("".concat(this.id,": fontSettings.sdf is required to render outline"))()}},{key:"draw",value:function(e){var t=this.props,i=t.sdf,r=t.smoothing,a=t.outlineWidth,s=this.state.outlineColor;e.uniforms=K(K({},e.uniforms),{},{buffer:.75,outlineBuffer:a?Math.max(r,.75*(1-a)):-1,gamma:r,sdf:Boolean(i),outlineColor:s}),Object(o.a)(Object(l.a)(n.prototype),"draw",this).call(this,e)}},{key:"getInstanceOffset",value:function(e){var t=this;return e?Array.from(e).map((function(e){return Object(o.a)(Object(l.a)(n.prototype),"getInstanceOffset",t).call(t,e)})):X}},{key:"getInstanceColorMode",value:function(e){return 1}},{key:"getInstanceIconFrame",value:function(e){var t=this;return e?Array.from(e).map((function(e){return Object(o.a)(Object(l.a)(n.prototype),"getInstanceIconFrame",t).call(t,e)})):X}}]),n}(N);$.layerName="MultiIconLayer",$.defaultProps={getIconOffsets:{type:"accessor",value:function(e){return e.offsets}},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}};var Y=n("rxlC"),q=n.n(Y);function Q(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return ee(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ee(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function ee(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var te=[];function ne(e,t,n,i){for(var r=0,o=t;o<n;o++){var a=e[o],s=null,l=i&&i[a];l&&(s=l.width),r+=s}return r}function ie(e,t,n,i,r,o){for(var a=t,s=0,l=t;l<n;l++){var c=ne(e,l,l+1,r);s+c>i&&(a<l&&o.push(l),a=l,s=0),s+=c}return s}function re(e,t,n,i,r,o){for(var a=t,s=t,l=t,c=0,u=t;u<n;u++)if(" "===e[u]?l=u+1:" "!==e[u+1]&&u+1!==n||(l=u+1),l>s){var f=ne(e,s,l,r);c+f>i&&(a<s&&(o.push(s),a=s,c=0),f>i&&(f=ie(e,s,l,i,r,o),a=o[o.length-1])),s=l,c+=f}return c}function oe(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5?arguments[5]:void 0;void 0===o&&(o=e.length);var a=[];return"break-all"===t?ie(e,r,o,n,i,a):re(e,r,o,n,i,a),a}function ae(e,t,n,i,r,o){for(var a=0,s=0,l=t;l<n;l++){var c=e[l],f=i[c];f?(s||(s=f.height),r[l]=a+f.width/2,a+=f.width):(u.a.warn("Missing character: ".concat(c," (").concat(c.codePointAt(0),")"))(),r[l]=a,a+=32)}o[0]=a,o[1]=s}function se(e,t,n,i,r){for(var o=(e=Array.from(e)).length,a=new Array(o),s=new Array(o),l=new Array(o),c=("break-word"===n||"break-all"===n)&&isFinite(i)&&i>0,u=[0,0],f=[],p=0,d=0,g=0,h=0;h<=o;h++){var v=e[h];if("\n"!==v&&h!==o||(g=h),g>d){for(var y=c?oe(e,n,i,r,d,g):te,m=0;m<=y.length;m++){var b=0===m?d:y[m-1],x=m<y.length?y[m]:g;ae(e,b,x,r,a,f);for(var P=b;P<x;P++)s[P]=p+f[1]/2,l[P]=f[0];p+=f[1]*t,u[0]=Math.max(u[0],f[0])}d=g}"\n"===v&&(a[d]=0,s[d]=0,l[d]=0,d++)}return u[1]=p,{x:a,y:s,rowWidth:l,size:u}}var le=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;Object(i.a)(this,e),this.limit=t,this.clear()}return Object(r.a)(e,[{key:"clear",value:function(){this._cache={},this._order=[]}},{key:"get",value:function(e){var t=this._cache[e];return t&&(this._deleteOrder(e),this._appendOrder(e)),t}},{key:"set",value:function(e,t){this._cache[e]?(this.delete(e),this._cache[e]=t,this._appendOrder(e)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[e]=t,this._appendOrder(e))}},{key:"delete",value:function(e){this._cache[e]&&(this._deleteCache(e),this._deleteOrder(e))}},{key:"_deleteCache",value:function(e){delete this._cache[e]}},{key:"_deleteOrder",value:function(e){var t=this._order.findIndex((function(t){return t===e}));t>=0&&this._order.splice(t,1)}},{key:"_appendOrder",value:function(e){this._order.push(e)}}]),e}();function ce(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return ue(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ue(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function ue(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function fe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}var pe=function(){for(var e=[],t=32;t<128;t++)e.push(String.fromCharCode(t));return e}(),de=new le(3),ge=["fontFamily","fontWeight","characterSet","fontSize","sdf","buffer","cutoff","radius"];function he(e,t){var n=de.get(e);if(!n)return t;var i=[],r=n.mapping,o=Object.keys(r);o=new Set(o);var a=t;return a instanceof Array&&(a=new Set(a)),a.forEach((function(e){o.has(e)||i.push(e)})),i}function ve(e,t){for(var n=0;n<e.length;n++)t.data[4*n+3]=e[n]}function ye(e,t,n,i){e.font="".concat(i," ").concat(n,"px ").concat(t),e.fillStyle="#000",e.textBaseline="baseline",e.textAlign="left"}var me=function(){function e(){Object(i.a)(this,e),this.props={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:pe,fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12},this._key=null,this._atlas=null}return Object(r.a)(e,[{key:"texture",get:function(){return this._atlas}},{key:"mapping",get:function(){return this._atlas&&this._atlas.mapping}},{key:"scale",get:function(){return 1.2}},{key:"setProps",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ge.forEach((function(n){n in t&&(e.props[n]=t[n])}));var n=this._key;this._key=this._getKey();var i=he(this._key,this.props.characterSet),r=de.get(this._key);if(r&&0===i.length)this._key!==n&&(this._atlas=r);else{var o=this._generateFontAtlas(this._key,i,r);this._atlas=o,de.set(this._key,o)}}},{key:"_generateFontAtlas",value:function(e,t,n){var i=this.props,r=i.fontFamily,o=i.fontWeight,a=i.fontSize,s=i.buffer,l=i.sdf,u=i.radius,f=i.cutoff,p=n&&n.data;p||((p=document.createElement("canvas")).width=1024);var d=p.getContext("2d");ye(d,r,a,o);var g=function(e){var t,n=e.characterSet,i=e.getFontWidth,r=e.fontHeight,o=e.buffer,a=e.maxCanvasWidth,s=e.mapping,l=void 0===s?{}:s,c=e.xOffset,u=void 0===c?0:c,f=e.yOffset,p=void 0===f?0:f,d=0,g=u,h=0,v=Q(n);try{for(v.s();!(t=v.n()).done;){var y=t.value;if(!l[y]){var m=i(y,h++);g+m+2*o>a&&(g=0,d++),l[y]={x:g+o,y:p+d*(r+2*o)+o,width:m,height:r},g+=m+2*o}}}catch(P){v.e(P)}finally{v.f()}var b,x=r+2*o;return{mapping:l,xOffset:g,yOffset:p+d*x,canvasHeight:(b=p+(d+1)*x,Math.pow(2,Math.ceil(Math.log2(b))))}}(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fe(Object(n),!0).forEach((function(t){Object(c.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({getFontWidth:function(e){return d.measureText(e).width},fontHeight:1.2*a,buffer:s,characterSet:t,maxCanvasWidth:1024},n&&{mapping:n.mapping,xOffset:n.xOffset,yOffset:n.yOffset})),h=g.mapping,v=g.canvasHeight,y=g.xOffset,m=g.yOffset;if(p.height!==v){var b=d.getImageData(0,0,p.width,p.height);p.height=v,d.putImageData(b,0,0)}if(ye(d,r,a,o),l){var x,P=new q.a(a,s,u,f,r,o),O=d.getImageData(0,0,P.size,P.size),S=ce(t);try{for(S.s();!(x=S.n()).done;){var _=x.value;ve(P.draw(_),O),d.putImageData(O,h[_].x-s,h[_].y+s)}}catch(A){S.e(A)}finally{S.f()}}else{var w,C=ce(t);try{for(C.s();!(w=C.n()).done;){var j=w.value;d.fillText(j,h[j].x,h[j].y+.9*a)}}catch(A){C.e(A)}finally{C.f()}}return{xOffset:y,yOffset:m,mapping:h,data:p,width:p.width,height:p.height}}},{key:"_getKey",value:function(){var e=this.props,t=e.fontFamily,n=e.fontWeight,i=e.fontSize,r=e.buffer,o=e.sdf,a=e.radius,s=e.cutoff;return o?"".concat(t," ").concat(n," ").concat(i," ").concat(r," ").concat(a," ").concat(s):"".concat(t," ").concat(n," ").concat(i," ").concat(r)}}]),e}();function be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function xe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?be(Object(n),!0).forEach((function(t){Object(c.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Pe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(l.a)(e);if(t){var r=Object(l.a)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Object(s.a)(this,n)}}var Oe={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:function(e){return e.position}},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}},Se=function(e){Object(a.a)(n,e);var t=Pe(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"getShaders",value:function(){return Object(o.a)(Object(l.a)(n.prototype),"getShaders",this).call(this,{vs:"#define SHADER_NAME text-background-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute vec4 instanceRects;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec2 instancePixelOffsets;\nattribute float instanceLineWidths;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\nuniform bool billboard;\nuniform float opacity;\nuniform float sizeScale;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform vec4 padding;\nuniform int sizeUnits;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying float vLineWidth;\nvarying vec2 uv;\nvarying vec2 dimensions;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = radians(angle);\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = positions;\n  geometry.pickingColor = instancePickingColors;\n  uv = positions;\n  vLineWidth = instanceLineWidths;\n  float sizePixels = clamp(\n    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits),\n    sizeMinPixels, sizeMaxPixels\n  );\n\n  dimensions = instanceRects.zw * sizePixels + padding.xy + padding.zw;\n\n  vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-padding.xy, padding.zw, positions);\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);\n  pixelOffset += instancePixelOffsets;\n  pixelOffset.y *= -1.0;\n\n  if (billboard)  {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    vec3 offset = vec3(pixelOffset, 0.0);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  } else {\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\n    DECKGL_FILTER_SIZE(offset_common, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);\n  DECKGL_FILTER_COLOR(vFillColor, geometry);\n  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);\n  DECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",fs:"#define SHADER_NAME text-background-layer-fragment-shader\n\nprecision highp float;\n\nuniform bool stroked;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying float vLineWidth;\nvarying vec2 uv;\nvarying vec2 dimensions;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  vec2 pixelPosition = uv * dimensions;\n  if (stroked) {\n    float distToEdge = min(\n      min(pixelPosition.x, dimensions.x - pixelPosition.x),\n      min(pixelPosition.y, dimensions.y - pixelPosition.y)\n    );\n    float isBorder = smoothedge(distToEdge, vLineWidth);\n    gl_FragColor = mix(vFillColor, vLineColor, isBorder);\n  } else {\n    gl_FragColor = vFillColor;\n  }\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[y.a,m.a]})}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}},{key:"updateState",value:function(e){var t=e.props,i=e.oldProps,r=e.changeFlags;if(Object(o.a)(Object(l.a)(n.prototype),"updateState",this).call(this,{props:t,oldProps:i,changeFlags:r}),r.extensionsChanged){var a,s=this.context.gl;null===(a=this.state.model)||void 0===a||a.delete(),this.state.model=this._getModel(s),this.getAttributeManager().invalidateAll()}}},{key:"draw",value:function(e){var t=e.uniforms,n=this.props,i=n.billboard,r=n.sizeScale,o=n.sizeUnits,a=n.sizeMinPixels,s=n.sizeMaxPixels,l=n.getLineWidth,c=this.props.padding;c.length<4&&(c=[c[0],c[1],c[0],c[1]]),this.state.model.setUniforms(t).setUniforms({billboard:i,stroked:Boolean(l),padding:c,sizeUnits:b.d[o],sizeScale:r,sizeMinPixels:a,sizeMaxPixels:s}).draw()}},{key:"_getModel",value:function(e){return new P.a(e,xe(xe({},this.getShaders()),{},{id:this.props.id,geometry:new O.a({drawMode:6,vertexCount:4,attributes:{positions:{size:2,value:new Float32Array([0,0,1,0,1,1,0,1])}}}),isInstanced:!0}))}}]),n}(x.a);function _e(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return we(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return we(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function we(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Ce(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function je(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ce(Object(n),!0).forEach((function(t){Object(c.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ce(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ae(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(l.a)(e);if(t){var r=Object(l.a)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Object(s.a)(this,n)}}Se.layerName="TextBackgroundLayer",Se.defaultProps=Oe;var Le={fontSize:64,buffer:4,sdf:!1,radius:12,cutoff:.25,smoothing:.1},ze={start:1,middle:0,end:-1},Ie={top:1,center:0,bottom:-1},ke=[0,0,0,255],Me=["fontSize","buffer","sdf","radius","cutoff"],Ee={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:ke},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:pe},fontFamily:"Monaco, monospace",fontWeight:"normal",lineHeight:1,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:ke},fontSettings:{},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:function(e){return e.text}},getPosition:{type:"accessor",value:function(e){return e.position}},getColor:{type:"accessor",value:ke},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}},Te=function(e){Object(a.a)(n,e);var t=Ae(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"initializeState",value:function(){this.state={styleVersion:0,fontAtlasManager:new me}}},{key:"updateState",value:function(e){var t=e.props,n=e.oldProps,i=e.changeFlags,r=i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getText),o=this.state.characterSet;r&&this._updateText();var a=o!==this.state.characterSet||this._fontChanged(n,t);a&&this._updateFontAtlas(n,t),(a||t.lineHeight!==n.lineHeight||t.wordBreak!==n.wordBreak||t.maxWidth!==n.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}},{key:"getPickingInfo",value:function(e){var t=e.info;return t.object=t.index>=0?this.props.data[t.index]:null,t}},{key:"_updateFontAtlas",value:function(e,t){var n=t.fontSettings,i=t.fontFamily,r=t.fontWeight,o=this.state,a=o.fontAtlasManager,s=o.characterSet;a.setProps(je(je(je({},Le),n),{},{characterSet:s,fontFamily:i,fontWeight:r}))}},{key:"_fontChanged",value:function(e,t){if(e.fontFamily!==t.fontFamily||e.fontWeight!==t.fontWeight)return!0;if(e.fontSettings===t.fontSettings)return!1;var n=e.fontSettings||{},i=t.fontSettings||{};return Me.some((function(e){return n[e]!==i[e]}))}},{key:"_updateText",value:function(){var e,t=this.props,n=t.data,i=t.characterSet,r=n.attributes&&n.attributes.getText,o=this.props.getText,a=n.startIndices,s="auto"===i&&new Set;if(r&&a){var l=function(e){var t=e.value,n=e.length,i=e.stride,r=e.offset,o=e.startIndices,a=e.characterSet,s=t.BYTES_PER_ELEMENT,l=i?i/s:1,c=r?r/s:0,u=o[n]||Math.ceil((t.length-c)/l),f=a&&new Set,p=new Array(n),d=t;if(l>1||c>0){d=new t.constructor(u);for(var g=0;g<u;g++)d[g]=t[g*l+c]}for(var h=0;h<n;h++){var v=o[h],y=o[h+1]||u,m=d.subarray(v,y);p[h]=String.fromCodePoint.apply(null,m),f&&m.forEach(f.add,f)}if(f){var b,x=Q(f);try{for(x.s();!(b=x.n()).done;){var P=b.value;a.add(String.fromCodePoint(P))}}catch(O){x.e(O)}finally{x.f()}}return{texts:p,characterCount:u}}(je(je({},ArrayBuffer.isView(r)?{value:r}:r),{},{length:n.length,startIndices:a,characterSet:s})),c=l.texts;e=l.characterCount,o=function(e,t){var n=t.index;return c[n]}}else{var u=Object(A.a)(n),f=u.iterable,p=u.objectInfo;a=[0],e=0;var d,g=_e(f);try{for(g.s();!(d=g.n()).done;){var h=d.value;p.index++;var v=Array.from(o(h,p)||"");s&&v.forEach(s.add,s),e+=v.length,a.push(e)}}catch(y){g.e(y)}finally{g.f()}}this.setState({getText:o,startIndices:a,numInstances:e,characterSet:s||i})}},{key:"getBoundingRect",value:function(e,t){var n=this.state.fontAtlasManager.mapping,i=this.state.getText,r=this.props,o=r.wordBreak,a=r.maxWidth,s=r.lineHeight,l=r.getTextAnchor,c=r.getAlignmentBaseline,u=se(i(e,t)||"",s,o,a,n),f=Object(H.a)(u.size,2),p=f[0],d=f[1];return[(ze["function"==typeof l?l(e,t):l]-1)*p/2,(Ie["function"==typeof c?c(e,t):c]-1)*d/2,p,d]}},{key:"getIconOffsets",value:function(e,t){for(var n=this.state.fontAtlasManager.mapping,i=this.state.getText,r=this.props,o=r.wordBreak,a=r.maxWidth,s=r.lineHeight,l=r.getTextAnchor,c=r.getAlignmentBaseline,u=se(i(e,t)||"",s,o,a,n),f=u.x,p=u.y,d=u.rowWidth,g=Object(H.a)(u.size,2),h=g[0],v=g[1],y=ze["function"==typeof l?l(e,t):l],m=Ie["function"==typeof c?c(e,t):c],b=f.length,x=new Array(2*b),P=0,O=0;O<b;O++){var S=(1-y)*(h-d[O])/2;x[P++]=(y-1)*h/2+S+f[O],x[P++]=(m-1)*v/2+p[O]}return x}},{key:"renderLayers",value:function(){var e=this.state,t=e.startIndices,n=e.numInstances,i=e.getText,r=e.fontAtlasManager,o=r.scale,a=r.texture,s=r.mapping,l=e.styleVersion,c=this.props,u=c.data,f=c._dataDiff,p=c.getPosition,d=c.getColor,g=c.getSize,h=c.getAngle,v=c.getPixelOffset,y=c.getBackgroundColor,m=c.getBorderColor,b=c.getBorderWidth,x=c.backgroundPadding,P=c.background,O=c.billboard,S=c.fontSettings,_=c.outlineWidth,w=c.outlineColor,C=c.sizeScale,j=c.sizeUnits,A=c.sizeMinPixels,L=c.sizeMaxPixels,z=c.transitions,I=c.updateTriggers,k=this.getSubLayerClass("characters",$),M=this.getSubLayerClass("background",Se);return[P&&new M({getFillColor:y,getLineColor:m,getLineWidth:b,padding:x,getPosition:p,getSize:g,getAngle:h,getPixelOffset:v,billboard:O,sizeScale:C/this.state.fontAtlasManager.props.fontSize,sizeUnits:j,sizeMinPixels:A,sizeMaxPixels:L,transitions:z&&{getPosition:z.getPosition,getAngle:z.getAngle,getSize:z.getSize,getFillColor:z.getBackgroundColor,getLineColor:z.getBorderColor,getLineWidth:z.getBorderWidth,getPixelOffset:z.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:I.getPosition,getAngle:I.getAngle,getSize:I.getSize,getFillColor:I.getBackgroundColor,getLineColor:I.getBorderColor,getLineWidth:I.getBorderWidth,getPixelOffset:I.getPixelOffset,getBoundingRect:{getText:I.getText,getTextAnchor:I.getTextAnchor,getAlignmentBaseline:I.getAlignmentBaseline,styleVersion:l}}}),{data:u.attributes?{length:u.length,attributes:u.attributes.background||{}}:u,_dataDiff:f,autoHighlight:!1,getBoundingRect:this.getBoundingRect.bind(this)}),new k({sdf:S.sdf,smoothing:Number.isFinite(S.smoothing)?S.smoothing:Le.smoothing,outlineWidth:_,outlineColor:w,iconAtlas:a,iconMapping:s,getPosition:p,getColor:d,getSize:g,getAngle:h,getPixelOffset:v,billboard:O,sizeScale:C*o,sizeUnits:j,sizeMinPixels:A*o,sizeMaxPixels:L*o,transitions:z&&{getPosition:z.getPosition,getAngle:z.getAngle,getColor:z.getColor,getSize:z.getSize,getPixelOffset:z.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{getIcon:I.getText,getPosition:I.getPosition,getAngle:I.getAngle,getColor:I.getColor,getSize:I.getSize,getPixelOffset:I.getPixelOffset,getIconOffsets:{getText:I.getText,getTextAnchor:I.getTextAnchor,getAlignmentBaseline:I.getAlignmentBaseline,styleVersion:l}}}),{data:u,_dataDiff:f,startIndices:t,numInstances:n,getIconOffsets:this.getIconOffsets.bind(this),getIcon:i})]}}]),n}(f.a);Te.layerName="TextLayer",Te.defaultProps=Ee;var Fe=n("b0ih"),Re=n("VMBB"),De=n("sc/6");function Be(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return We(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return We(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function We(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var Ge=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(i.a)(this,e);var n=t.attributes,r=void 0===n?{}:n;this.typedArrayManager=Fe.a,this.indexStarts=null,this.vertexStarts=null,this.vertexCount=0,this.instanceCount=0,this.attributes={},this._attributeDefs=r,this.opts=t,this.updateGeometry(t),Object.seal(this)}return Object(r.a)(e,[{key:"updateGeometry",value:function(e){Object.assign(this.opts,e);var t=this.opts,n=t.data,i=t.buffers,r=void 0===i?{}:i,o=t.getGeometry,a=t.geometryBuffer,s=t.positionFormat,l=t.dataChanged,c=t.normalize,u=void 0===c||c;if(this.data=n,this.getGeometry=o,this.positionSize=a&&a.size||("XY"===s?2:3),this.buffers=r,this.normalize=u,a&&(Object(Re.a)(n.startIndices),this.getGeometry=this.getGeometryFromBuffer(a),u||(r.positions=a)),this.geometryBuffer=r.positions,Array.isArray(l)){var f,p=Be(l);try{for(p.s();!(f=p.n()).done;){var d=f.value;this._rebuildGeometry(d)}}catch(g){p.e(g)}finally{p.f()}}else this._rebuildGeometry()}},{key:"updatePartialGeometry",value:function(e){var t=e.startRow,n=e.endRow;this._rebuildGeometry({startRow:t,endRow:n})}},{key:"normalizeGeometry",value:function(e){return e}},{key:"updateGeometryAttributes",value:function(e,t,n){throw new Error("Not implemented")}},{key:"getGeometrySize",value:function(e){throw new Error("Not implemented")}},{key:"getGeometryFromBuffer",value:function(e){var t=e.value||e;return Object(Re.a)(ArrayBuffer.isView(t)),Object(A.b)(t,{size:this.positionSize,offset:e.offset,stride:e.stride,startIndices:this.data.startIndices})}},{key:"_allocate",value:function(e,t){var n=this.attributes,i=this.buffers,r=this._attributeDefs,o=this.typedArrayManager;for(var a in r)if(a in i)o.release(n[a]),n[a]=null;else{var s=r[a];s.copy=t,n[a]=o.allocate(n[a],e,s)}}},{key:"_forEachGeometry",value:function(e,t,n){var i,r=this.data,o=this.getGeometry,a=Object(A.a)(r,t,n),s=a.iterable,l=a.objectInfo,c=Be(s);try{for(c.s();!(i=c.n()).done;){var u=i.value;l.index++,e(o(u,l),l.index)}}catch(f){c.e(f)}finally{c.f()}}},{key:"_rebuildGeometry",value:function(e){var t=this;if(this.data&&this.getGeometry){var n=this.indexStarts,i=this.vertexStarts,r=this.instanceCount,o=this.data,a=this.geometryBuffer,s=e||{},l=s.startRow,c=void 0===l?0:l,u=s.endRow,f=void 0===u?1/0:u,p={};if(e||(n=[0],i=[0]),this.normalize||!a)this._forEachGeometry((function(e,n){e=t.normalizeGeometry(e),p[n]=e,i[n+1]=i[n]+t.getGeometrySize(e)}),c,f),r=i[i.length-1];else if(a.buffer instanceof De.a){var d=a.stride||4*this.positionSize;i=o.startIndices,r=i[o.length]||a.buffer.byteLength/d}else{var g=a.value||a,h=a.stride/g.BYTES_PER_ELEMENT||this.positionSize;i=o.startIndices,r=i[o.length]||g.length/h}this._allocate(r,Boolean(e)),this.indexStarts=n,this.vertexStarts=i,this.instanceCount=r;var v={};this._forEachGeometry((function(e,o){e=p[o]||e,v.vertexStart=i[o],v.indexStart=n[o];var a=o<i.length-1?i[o+1]:r;v.geometrySize=a-i[o],v.geometryIndex=o,t.updateGeometryAttributes(e,v)}),c,f),this.vertexCount=n[n.length-1]}}}]),e}(),Ue=(n("a3TU"),1),Ne=-1;function Ve(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=He(e,n);return i!==t&&(Ke(e,n),!0)}function He(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Math.sign(Ze(e,t))}function Ze(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.start,i=void 0===n?0:n,r=t.end,o=void 0===r?e.length:r,a=t.size||2,s=0,l=i,c=o-a;l<o;l+=a)s+=(e[l]-e[c])*(e[l+1]+e[c+1]),c=l;return s/2}function Ke(e,t){for(var n=t.start,i=void 0===n?0:n,r=t.end,o=void 0===r?e.length:r,a=t.size,s=void 0===a?2:a,l=(o-i)/s,c=Math.floor(l/2),u=0;u<c;++u)for(var f=i+u*s,p=i+(l-1-u)*s,d=0;d<s;++d){var g=e[f+d];e[f+d]=e[p+d],e[p+d]=g}}function Je(e,t){var n=t.length,i=e.length;if(i>0){for(var r=!0,o=0;o<n;o++)if(e[i-n+o]!==t[o]){r=!1;break}if(r)return!1}for(var a=0;a<n;a++)e[i+a]=t[a];return!0}function Xe(e,t){for(var n=t.length,i=0;i<n;i++)e[i]=t[i]}function $e(e,t,n,i){for(var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],o=i+t*n,a=0;a<n;a++)r[a]=e[o+a];return r}function Ye(e,t,n,i){var r,o,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];if(8&n)r=(i[3]-e[1])/(t[1]-e[1]),o=3;else if(4&n)r=(i[1]-e[1])/(t[1]-e[1]),o=1;else if(2&n)r=(i[2]-e[0])/(t[0]-e[0]),o=2;else{if(!(1&n))return null;r=(i[0]-e[0])/(t[0]-e[0]),o=0}for(var s=0;s<e.length;s++)a[s]=(1&o)===s?i[o]:r*(t[s]-e[s])+e[s];return a}function qe(e,t){var n=0;return e[0]<t[0]?n|=1:e[0]>t[2]&&(n|=2),e[1]<t[1]?n|=4:e[1]>t[3]&&(n|=8),n}function Qe(e){var t,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=i.size,o=void 0===r?2:r,a=i.broken,s=void 0!==a&&a,l=i.gridResolution,c=void 0===l?10:l,u=i.gridOffset,f=void 0===u?[0,0]:u,p=i.startIndex,d=void 0===p?0:p,g=i.endIndex,h=void 0===g?e.length:g,v=(h-d)/o,y=[],m=[y],b=$e(e,0,o,d),x=it(b,c,f,[]),P=[];Je(y,b);for(var O=1;O<v;O++){for(n=qe(t=$e(e,O,o,d,t),x);n;){Ye(b,t,n,x,P);var S=qe(P,x);S&&(Ye(b,P,S,x,P),n=S),Je(y,P),Xe(b,P),rt(x,c,n),s&&y.length>o&&(y=[],m.push(y),Je(y,b)),n=qe(t,x)}Je(y,t),Xe(b,t)}return s?m:m[0]}function et(e,t){for(var n=0;n<t.length;n++)e.push(t[n]);return e}function tt(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e.length)return[];for(var i=n.size,r=void 0===i?2:i,o=n.gridResolution,a=void 0===o?10:o,s=n.gridOffset,l=void 0===s?[0,0]:s,c=n.edgeTypes,u=void 0!==c&&c,f=[],p=[{pos:e,types:u&&new Array(e.length/r).fill(1),holes:t||[]}],d=[[],[]],g=[];p.length;){var h=p.shift(),v=h.pos,y=h.types,m=h.holes;ot(v,r,m[0]||v.length,d),g=it(d[0],a,l,g);var b=qe(d[1],g);if(b){var x=nt(v,y,r,0,m[0]||v.length,g,b),P={pos:x[0].pos,types:x[0].types,holes:[]},O={pos:x[1].pos,types:x[1].types,holes:[]};p.push(P,O);for(var S=0;S<m.length;S++)(x=nt(v,y,r,m[S],m[S+1]||v.length,g,b))[0]&&(P.holes.push(P.pos.length),P.pos=et(P.pos,x[0].pos),u&&(P.types=et(P.types,x[0].types))),x[1]&&(O.holes.push(O.pos.length),O.pos=et(O.pos,x[1].pos),u&&(O.types=et(O.types,x[1].types)))}else{var _={positions:v};u&&(_.edgeTypes=y),m.length&&(_.holeIndices=m),f.push(_)}}return f}function nt(e,t,n,i,r,o,a){for(var s,l,c,u=(r-i)/n,f=[],p=[],d=[],g=[],h=[],v=$e(e,u-1,n,i),y=Math.sign(8&a?v[1]-o[3]:v[0]-o[2]),m=t&&t[u-1],b=0,x=0,P=0;P<u;P++)s=$e(e,P,n,i,s),l=Math.sign(8&a?s[1]-o[3]:s[0]-o[2]),c=t&&t[i/n+P],l&&y&&y!==l&&(Ye(v,s,a,o,h),Je(f,h)&&d.push(m),Je(p,h)&&g.push(m)),l<=0?(Je(f,s)&&d.push(c),b-=l):d.length&&(d[d.length-1]=0),l>=0?(Je(p,s)&&g.push(c),x+=l):g.length&&(g[g.length-1]=0),Xe(v,s),y=l,m=c;return[b?{pos:f,types:t&&d}:null,x?{pos:p,types:t&&g}:null]}function it(e,t,n,i){var r=Math.floor((e[0]-n[0])/t)*t+n[0],o=Math.floor((e[1]-n[1])/t)*t+n[1];return i[0]=r,i[1]=o,i[2]=r+t,i[3]=o+t,i}function rt(e,t,n){8&n?(e[1]+=t,e[3]+=t):4&n?(e[1]-=t,e[3]-=t):2&n?(e[0]+=t,e[2]+=t):1&n&&(e[0]-=t,e[2]-=t)}function ot(e,t,n,i){for(var r=1/0,o=-1/0,a=1/0,s=-1/0,l=0;l<n;l+=t){var c=e[l],u=e[l+1];r=c<r?c:r,o=c>o?c:o,a=u<a?u:a,s=u>s?u:s}return i[0][0]=r,i[0][1]=a,i[1][0]=o,i[1][1]=s,i}function at(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return st(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return st(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function st(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function lt(e,t,n,i){for(var r=-1,o=-1,a=n+1;a<i;a+=t){var s=Math.abs(e[a]);s>r&&(r=s,o=a-1)}return o}function ct(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:85.051129,o=e[n],a=e[i-t];if(Math.abs(o-a)>180){var s=$e(e,0,t,n);s[0]+=360*Math.round((a-o)/360),Je(e,s),s[1]=Math.sign(s[1])*r,Je(e,s),s[0]=o,Je(e,s)}}function ut(e,t,n,i){for(var r,o=e[0],a=n;a<i;a+=t){var s=(r=e[a])-o;(s>180||s<-180)&&(r-=360*Math.round(s/360)),e[a]=o=r}}function ft(e,t){for(var n,i=e.length/t,r=0;r<i&&((n=e[r*t])+180)%360==0;r++);var o=360*-Math.round(n/360);if(0!==o)for(var a=0;a<i;a++)e[a*t]+=o}function pt(e,t,n,i){var r=e;if(Array.isArray(e[0])){var o=e.length*t;r=new Array(o);for(var a=0;a<e.length;a++)for(var s=0;s<t;s++)r[a*t+s]=e[a][s]||0}return n?Qe(r,{size:t,gridResolution:n}):i?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.size,i=void 0===n?2:n,r=t.startIndex,o=void 0===r?0:r,a=t.endIndex,s=void 0===a?e.length:a,l=t.normalize,c=void 0===l||l,u=e.slice(o,s);ut(u,i,0,s-o);var f=Qe(u,{size:i,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(c){var p,d=at(f);try{for(d.s();!(p=d.n()).done;){var g=p.value;ft(g,i)}}catch(h){d.e(h)}finally{d.f()}}return f}(r,{size:t}):r}function dt(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return gt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return gt(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function gt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function ht(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function vt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ht(Object(n),!0).forEach((function(t){Object(c.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ht(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function yt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(l.a)(e);if(t){var r=Object(l.a)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Object(s.a)(this,n)}}var mt=function(e){Object(a.a)(n,e);var t=yt(n);function n(e){return Object(i.a)(this,n),t.call(this,vt(vt({},e),{},{attributes:{positions:{size:3,padding:18,initialize:!0,type:e.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}}))}return Object(r.a)(n,[{key:"getGeometryFromBuffer",value:function(e){return this.normalize?Object(o.a)(Object(l.a)(n.prototype),"getGeometryFromBuffer",this).call(this,e):function(){return null}}},{key:"normalizeGeometry",value:function(e){return this.normalize?pt(e,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):e}},{key:"get",value:function(e){return this.attributes[e]}},{key:"getGeometrySize",value:function(e){if(Array.isArray(e[0])){var t,n=0,i=dt(e);try{for(i.s();!(t=i.n()).done;){var r=t.value;n+=this.getGeometrySize(r)}}catch(a){i.e(a)}finally{i.f()}return n}var o=this.getPathLength(e);return o<2?0:this.isClosed(e)?o<3?0:o+2:o}},{key:"updateGeometryAttributes",value:function(e,t){if(0!==t.geometrySize)if(e&&Array.isArray(e[0])){var n,i=dt(e);try{for(i.s();!(n=i.n()).done;){var r=n.value,o=this.getGeometrySize(r);t.geometrySize=o,this.updateGeometryAttributes(r,t),t.vertexStart+=o}}catch(a){i.e(a)}finally{i.f()}}else this._updateSegmentTypes(e,t),this._updatePositions(e,t)}},{key:"_updateSegmentTypes",value:function(e,t){var n=this.attributes.segmentTypes,i=this.isClosed(e),r=t.vertexStart,o=t.geometrySize;n.fill(0,r,r+o),i?(n[r]=4,n[r+o-2]=4):(n[r]+=1,n[r+o-2]+=2),n[r+o-1]=4}},{key:"_updatePositions",value:function(e,t){var n=this.attributes.positions;if(n)for(var i=t.vertexStart,r=t.geometrySize,o=new Array(3),a=i,s=0;s<r;a++,s++)this.getPointOnPath(e,s,o),n[3*a]=o[0],n[3*a+1]=o[1],n[3*a+2]=o[2]}},{key:"getPathLength",value:function(e){return e.length/this.positionSize}},{key:"getPointOnPath",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=this.positionSize;t*i>=e.length&&(t+=1-e.length/i);var r=t*i;return n[0]=e[r],n[1]=e[r+1],n[2]=3===i&&e[r+2]||0,n}},{key:"isClosed",value:function(e){if(!this.normalize)return this.opts.loop;var t=this.positionSize,n=e.length-t;return e[0]===e[n]&&e[1]===e[n+1]&&(2===t||e[2]===e[n+2])}}]),n}(Ge);function bt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function xt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bt(Object(n),!0).forEach((function(t){Object(c.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Pt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(l.a)(e);if(t){var r=Object(l.a)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Object(s.a)(this,n)}}var Ot=[0,0,0,255],St={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:function(e){return e.path}},getColor:{type:"accessor",value:Ot},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},_t={enter:function(e,t){return t.length?t.subarray(t.length-e.length):e}},wt=function(e){Object(a.a)(n,e);var t=Pt(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"getShaders",value:function(){return Object(o.a)(Object(l.a)(n.prototype),"getShaders",this).call(this,{vs:"#define SHADER_NAME path-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute float instanceTypes;\nattribute vec3 instanceStartPositions;\nattribute vec3 instanceEndPositions;\nattribute vec3 instanceLeftPositions;\nattribute vec3 instanceRightPositions;\nattribute vec3 instanceLeftPositions64Low;\nattribute vec3 instanceStartPositions64Low;\nattribute vec3 instanceEndPositions64Low;\nattribute vec3 instanceRightPositions64Low;\nattribute float instanceStrokeWidths;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\n\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform float jointType;\nuniform float capType;\nuniform float miterLimit;\nuniform bool billboard;\nuniform int widthUnits;\n\nuniform float opacity;\n\nvarying vec4 vColor;\nvarying vec2 vCornerOffset;\nvarying float vMiterLength;\nvarying vec2 vPathPosition;\nvarying float vPathLength;\nvarying float vJointType;\n\nconst float EPSILON = 0.001;\nconst vec3 ZERO_OFFSET = vec3(0.0);\n\nfloat flipIfTrue(bool flag) {\n  return -(float(flag) * 2. - 1.);\n}\nvec3 lineJoin(\n  vec3 prevPoint, vec3 currPoint, vec3 nextPoint,\n  vec2 width\n) {\n  bool isEnd = positions.x > 0.0;\n  float sideOfPath = positions.y;\n  float isJoint = float(sideOfPath == 0.0);\n\n  vec3 deltaA3 = (currPoint - prevPoint);\n  vec3 deltaB3 = (nextPoint - currPoint);\n\n  mat3 rotationMatrix;\n  bool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);\n  if (needsRotation) {\n    deltaA3 = deltaA3 * rotationMatrix;\n    deltaB3 = deltaB3 * rotationMatrix;\n  }\n  vec2 deltaA = deltaA3.xy / width;\n  vec2 deltaB = deltaB3.xy / width;\n\n  float lenA = length(deltaA);\n  float lenB = length(deltaB);\n\n  vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);\n  vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);\n\n  vec2 perpA = vec2(-dirA.y, dirA.x);\n  vec2 perpB = vec2(-dirB.y, dirB.x);\n  vec2 tangent = dirA + dirB;\n  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;\n  vec2 miterVec = vec2(-tangent.y, tangent.x);\n  vec2 dir = isEnd ? dirA : dirB;\n  vec2 perp = isEnd ? perpA : perpB;\n  float L = isEnd ? lenA : lenB;\n  float sinHalfA = abs(dot(miterVec, perp));\n  float cosHalfA = abs(dot(dirA, miterVec));\n  float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);\n  float cornerPosition = sideOfPath * turnDirection;\n\n  float miterSize = 1.0 / max(sinHalfA, EPSILON);\n  miterSize = mix(\n    min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),\n    miterSize,\n    step(0.0, cornerPosition)\n  );\n\n  vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))\n    * (sideOfPath + isJoint * turnDirection);\n  bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));\n  bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));\n  bool isCap = isStartCap || isEndCap;\n  if (isCap) {\n    offsetVec = mix(perp * sideOfPath, dir * capType * 4.0 * flipIfTrue(isStartCap), isJoint);\n    vJointType = capType;\n  } else {\n    vJointType = jointType;\n  }\n  vPathLength = L;\n  vCornerOffset = offsetVec;\n  vMiterLength = dot(vCornerOffset, miterVec * turnDirection);\n  vMiterLength = isCap ? isJoint : vMiterLength;\n\n  vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);\n  vPathPosition = vec2(\n    dot(offsetFromStartOfPath, perp),\n    dot(offsetFromStartOfPath, dir)\n  );\n  geometry.uv = vPathPosition;\n\n  float isValid = step(instanceTypes, 3.5);\n  vec3 offset = vec3(offsetVec * width * isValid, 0.0);\n\n  if (needsRotation) {\n    offset = rotationMatrix * offset;\n  }\n  return currPoint + offset;\n}\nvoid clipLine(inout vec4 position, vec4 refPosition) {\n  if (position.w < EPSILON) {\n    float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);\n    position = refPosition + (position - refPosition) * r;\n  }\n}\n\nvoid main() {\n  geometry.pickingColor = instancePickingColors;\n\n  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);\n\n  float isEnd = positions.x;\n\n  vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);\n  vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);\n\n  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);\n  vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);\n\n  vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);\n  vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);\n\n  geometry.worldPosition = currPosition;\n  vec2 widthPixels = vec2(clamp(\n    project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),\n    widthMinPixels, widthMaxPixels) / 2.0);\n  vec3 width;\n\n  if (billboard) {\n    vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);\n    vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);\n    vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);\n\n    clipLine(prevPositionScreen, currPositionScreen);\n    clipLine(nextPositionScreen, currPositionScreen);\n    clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));\n\n    width = vec3(widthPixels, 0.0);\n    DECKGL_FILTER_SIZE(width, geometry);\n\n    vec3 pos = lineJoin(\n      prevPositionScreen.xyz / prevPositionScreen.w,\n      currPositionScreen.xyz / currPositionScreen.w,\n      nextPositionScreen.xyz / nextPositionScreen.w,\n      project_pixel_size_to_clipspace(width.xy)\n    );\n\n    gl_Position = vec4(pos * currPositionScreen.w, currPositionScreen.w);\n  } else {\n    prevPosition = project_position(prevPosition, prevPosition64Low);\n    currPosition = project_position(currPosition, currPosition64Low);\n    nextPosition = project_position(nextPosition, nextPosition64Low);\n\n    width = vec3(project_pixel_size(widthPixels), 0.0);\n    DECKGL_FILTER_SIZE(width, geometry);\n\n    vec4 pos = vec4(\n      lineJoin(prevPosition, currPosition, nextPosition, width.xy),\n      1.0);\n    geometry.position = pos;\n    gl_Position = project_common_position_to_clipspace(pos);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#define SHADER_NAME path-layer-fragment-shader\n\nprecision highp float;\n\nuniform float miterLimit;\n\nvarying vec4 vColor;\nvarying vec2 vCornerOffset;\nvarying float vMiterLength;\nvarying vec2 vPathPosition;\nvarying float vPathLength;\nvarying float vJointType;\n\nvoid main(void) {\n  geometry.uv = vPathPosition;\n\n  if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {\n    if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {\n      discard;\n    }\n    if (vJointType < 0.5 && vMiterLength > miterLimit + 1.0) {\n      discard;\n    }\n  }\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[y.a,m.a]})}},{key:"wrapLongitude",get:function(){return!1}},{key:"initializeState",value:function(){var e=this;this.getAttributeManager().addInstanced({positions:{size:3,vertexOffset:1,type:5130,fp64:this.use64bitPositions(),transition:_t,accessor:"getPath",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:5121,update:this.calculateSegmentTypes,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:_t,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,accessor:"getColor",transition:_t,defaultValue:Ot},instancePickingColors:{size:3,type:5121,accessor:function(t,n){var i=n.index,r=n.target;return e.encodePickingColor(t&&t.__source?t.__source.index:i,r)}}}),this.setState({pathTesselator:new mt({fp64:this.use64bitPositions()})}),this.props.getDashArray&&!this.props.extensions.length&&u.a.removed("getDashArray","PathStyleExtension")()}},{key:"updateState",value:function(e){var t=e.oldProps,i=e.props,r=e.changeFlags;Object(o.a)(Object(l.a)(n.prototype),"updateState",this).call(this,{props:i,oldProps:t,changeFlags:r});var a=this.getAttributeManager();if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPath)){var s=this.state.pathTesselator,c=i.data.attributes||{};s.updateGeometry({data:i.data,geometryBuffer:c.getPath,buffers:c,normalize:!i._pathType,loop:"loop"===i._pathType,getGeometry:i.getPath,positionFormat:i.positionFormat,wrapLongitude:i.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:r.dataChanged}),this.setState({numInstances:s.instanceCount,startIndices:s.vertexStarts}),r.dataChanged||a.invalidateAll()}if(r.extensionsChanged){var u,f=this.context.gl;null===(u=this.state.model)||void 0===u||u.delete(),this.state.model=this._getModel(f),a.invalidateAll()}}},{key:"getPickingInfo",value:function(e){var t=Object(o.a)(Object(l.a)(n.prototype),"getPickingInfo",this).call(this,e),i=t.index,r=this.props.data;return r[0]&&r[0].__source&&(t.object=r.find((function(e){return e.__source.index===i}))),t}},{key:"disablePickingIndex",value:function(e){var t=this.props.data;if(t[0]&&t[0].__source)for(var n=0;n<t.length;n++)t[n].__source.index===e&&this._disablePickingIndex(n);else this._disablePickingIndex(e)}},{key:"draw",value:function(e){var t=e.uniforms,n=this.props,i=n.jointRounded,r=n.capRounded,o=n.billboard,a=n.miterLimit,s=n.widthUnits,l=n.widthScale,c=n.widthMinPixels,u=n.widthMaxPixels;this.state.model.setUniforms(t).setUniforms({jointType:Number(i),capType:Number(r),billboard:o,widthUnits:b.d[s],widthScale:l,miterLimit:a,widthMinPixels:c,widthMaxPixels:u}).draw()}},{key:"_getModel",value:function(e){return new P.a(e,xt(xt({},this.getShaders()),{},{id:this.props.id,geometry:new O.a({drawMode:4,attributes:{indices:new Uint16Array([0,1,2,1,4,2,1,3,4,3,5,4]),positions:{value:new Float32Array([0,0,0,-1,0,1,1,-1,1,1,1,0]),size:2}}}),isInstanced:!0}))}},{key:"calculatePositions",value:function(e){var t=this.state.pathTesselator;e.startIndices=t.vertexStarts,e.value=t.get("positions")}},{key:"calculateSegmentTypes",value:function(e){var t=this.state.pathTesselator;e.startIndices=t.vertexStarts,e.value=t.get("segmentTypes")}}]),n}(x.a);wt.layerName="PathLayer",wt.defaultProps=St;var Ct=n("DAeo"),jt=n("d3kR"),At=n("tMmZ"),Lt=n("VmRL"),zt=n.n(Lt);function It(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return kt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return kt(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function kt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var Mt=Ue,Et=Ne,Tt={isClosed:!0};function Ft(e,t,n,i){for(var r=0;r<t;r++)if(e[n+r]!==e[i-t+r])return!1;return!0}function Rt(e,t,n,i,r){for(var o=t,a=n.length,s=0;s<a;s++)for(var l=0;l<i;l++)e[o++]=n[s][l]||0;if(!function(e){var t=e[0],n=e[e.length-1];return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]}(n))for(var c=0;c<i;c++)e[o++]=n[0][c]||0;return Tt.start=t,Tt.end=o,Tt.size=i,Ve(e,r,Tt),o}function Dt(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5?arguments[5]:void 0,a=arguments.length>6?arguments[6]:void 0,s=(o=o||n.length)-r;if(s<=0)return t;for(var l=t,c=0;c<s;c++)e[l++]=n[r+c];if(!Ft(n,i,r,o))for(var u=0;u<i;u++)e[l++]=n[r+u];return Tt.start=t,Tt.end=l,Tt.size=i,Ve(e,a,Tt),l}function Bt(e,t){!function(e){if(e=e&&e.positions||e,!Array.isArray(e)&&!ArrayBuffer.isView(e))throw new Error("invalid polygon")}(e);var n=[],i=[];if(e.positions){var r=e,o=r.positions,a=r.holeIndices;if(a){for(var s=0,l=0;l<=a.length;l++)s=Dt(n,s,o,t,a[l-1],a[l],0===l?Mt:Et),i.push(s);return i.pop(),{positions:n,holeIndices:i}}e=o}if(Number.isFinite(e[0]))return Dt(n,0,e,t,0,n.length,Mt),n;if(!function(e){return e.length>=1&&e[0].length>=2&&Number.isFinite(e[0][0])}(e)){var c,u=0,f=It(e.entries());try{for(f.s();!(c=f.n()).done;){var p=Object(H.a)(c.value,2),d=p[0];u=Rt(n,u,p[1],t,0===d?Mt:Et),i.push(u)}}catch(g){f.e(g)}finally{f.f()}return i.pop(),{positions:n,holeIndices:i}}return Rt(n,0,e,t,Mt),n}function Wt(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Gt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Gt(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Gt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Ut(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Nt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ut(Object(n),!0).forEach((function(t){Object(c.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ut(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Vt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(l.a)(e);if(t){var r=Object(l.a)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Object(s.a)(this,n)}}var Ht=function(e){Object(a.a)(n,e);var t=Vt(n);function n(e){Object(i.a)(this,n);var r=e.fp64,o=e.IndexType,a=void 0===o?Uint32Array:o;return t.call(this,Nt(Nt({},e),{},{attributes:{positions:{size:3,type:r?Float64Array:Float32Array},vertexValid:{type:Uint8ClampedArray,size:1},indices:{type:a,size:1}}}))}return Object(r.a)(n,[{key:"get",value:function(e){var t=this.attributes;return"indices"===e?t.indices&&t.indices.subarray(0,this.vertexCount):t[e]}},{key:"updateGeometry",value:function(e){Object(o.a)(Object(l.a)(n.prototype),"updateGeometry",this).call(this,e);var t=this.buffers.indices;t&&(this.vertexCount=(t.value||t).length)}},{key:"normalizeGeometry",value:function(e){if(this.normalize){if(e=Bt(e,this.positionSize),this.opts.resolution)return tt(e.positions||e,e.holeIndices,{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0});if(this.opts.wrapLongitude)return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=n.size,r=void 0===i?2:i,o=n.normalize,a=void 0===o||o,s=n.edgeTypes,l=void 0!==s&&s;t=t||[];for(var c=[],u=[],f=0,p=0,d=0;d<=t.length;d++){for(var g=t[d]||e.length,h=p,v=lt(e,r,f,g),y=v;y<g;y++)c[p++]=e[y];for(var m=f;m<v;m++)c[p++]=e[m];ut(c,r,h,p),ct(c,r,h,p,n.maxLatitude),f=g,u[d]=p}u.pop();var b=tt(c,u,{size:r,gridResolution:360,gridOffset:[-180,-180],edgeTypes:l});if(a){var x,P=at(b);try{for(P.s();!(x=P.n()).done;){var O=x.value;ft(O.positions,r)}}catch(S){P.e(S)}finally{P.f()}}return b}(e.positions||e,e.holeIndices,{size:this.positionSize,maxLatitude:86,edgeTypes:!0})}return e}},{key:"getGeometrySize",value:function(e){if(Array.isArray(e)&&!Number.isFinite(e[0])){var t,n=0,i=Wt(e);try{for(i.s();!(t=i.n()).done;){var r=t.value;n+=this.getGeometrySize(r)}}catch(o){i.e(o)}finally{i.f()}return n}return(e.positions||e).length/this.positionSize}},{key:"getGeometryFromBuffer",value:function(e){return this.normalize||!this.buffers.indices?Object(o.a)(Object(l.a)(n.prototype),"getGeometryFromBuffer",this).call(this,e):function(){return null}}},{key:"updateGeometryAttributes",value:function(e,t){if(Array.isArray(e)&&!Number.isFinite(e[0])){var n,i=Wt(e);try{for(i.s();!(n=i.n()).done;){var r=n.value,o=this.getGeometrySize(r);t.geometrySize=o,this.updateGeometryAttributes(r,t),t.vertexStart+=o,t.indexStart=this.indexStarts[t.geometryIndex+1]}}catch(a){i.e(a)}finally{i.f()}}else this._updateIndices(e,t),this._updatePositions(e,t),this._updateVertexValid(e,t)}},{key:"_updateIndices",value:function(e,t){var n=t.geometryIndex,i=t.vertexStart,r=t.indexStart,o=this.attributes,a=this.indexStarts,s=this.typedArrayManager,l=o.indices;if(l){var c=r,u=function(e,t,n){var i=null;e.holeIndices&&(i=e.holeIndices.map((function(e){return e/t})));var r=e.positions||e;if(n){var o=r.length;r=r.slice();for(var a=[],s=0;s<o;s+=t){a[0]=r[s],a[1]=r[s+1];var l=n(a);r[s]=l[0],r[s+1]=l[1]}}return zt()(r,i,t)}(e,this.positionSize,this.opts.preproject);l=s.allocate(l,r+u.length,{copy:!0});for(var f=0;f<u.length;f++)l[c++]=u[f]+i;a[n+1]=r+u.length,o.indices=l}}},{key:"_updatePositions",value:function(e,t){var n=t.vertexStart,i=t.geometrySize,r=this.attributes.positions,o=this.positionSize;if(r)for(var a=e.positions||e,s=n,l=0;l<i;s++,l++){var c=a[l*o],u=a[l*o+1],f=o>2?a[l*o+2]:0;r[3*s]=c,r[3*s+1]=u,r[3*s+2]=f}}},{key:"_updateVertexValid",value:function(e,t){var n=t.vertexStart,i=t.geometrySize,r=this.attributes.vertexValid,o=this.positionSize,a=e&&e.holeIndices;if(e&&e.edgeTypes?r.set(e.edgeTypes,n):r.fill(1,n,n+i),a)for(var s=0;s<a.length;s++)r[n+a[s]/o-1]=0;r[n+i-1]=0}}]),n}(Ge),Zt="\nattribute vec2 vertexPositions;\nattribute float vertexValid;\n\nuniform bool extruded;\nuniform bool isWireframe;\nuniform float elevationScale;\nuniform float opacity;\n\nvarying vec4 vColor;\n\nstruct PolygonProps {\n  vec4 fillColors;\n  vec4 lineColors;\n  vec3 positions;\n  vec3 nextPositions;\n  vec3 pickingColors;\n  vec3 positions64Low;\n  vec3 nextPositions64Low;\n  float elevations;\n};\n\nvec3 project_offset_normal(vec3 vector) {\n  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {\n    return normalize(vector * project_uCommonUnitsPerWorldUnit);\n  }\n  return project_normal(vector);\n}\n\nvoid calculatePosition(PolygonProps props) {\n#ifdef IS_SIDE_VERTEX\n  if(vertexValid < 0.5){\n    gl_Position = vec4(0.);\n    return;\n  }\n#endif\n\n  vec3 pos;\n  vec3 pos64Low;\n  vec3 normal;\n  vec4 colors = isWireframe ? props.lineColors : props.fillColors;\n\n  geometry.worldPosition = props.positions;\n  geometry.worldPositionAlt = props.nextPositions;\n  geometry.pickingColor = props.pickingColors;\n\n#ifdef IS_SIDE_VERTEX\n  pos = mix(props.positions, props.nextPositions, vertexPositions.x);\n  pos64Low = mix(props.positions64Low, props.nextPositions64Low, vertexPositions.x);\n#else\n  pos = props.positions;\n  pos64Low = props.positions64Low;\n#endif\n\n  if (extruded) {\n    pos.z += props.elevations * vertexPositions.y * elevationScale;\n  }\n  gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);\n\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  if (extruded) {\n  #ifdef IS_SIDE_VERTEX\n    normal = vec3(\n      props.positions.y - props.nextPositions.y + (props.positions64Low.y - props.nextPositions64Low.y),\n      props.nextPositions.x - props.positions.x + (props.nextPositions64Low.x - props.positions64Low.x),\n      0.0);\n    normal = project_offset_normal(normal);\n  #else\n    normal = project_normal(vec3(0.0, 0.0, 1.0));\n  #endif\n    geometry.normal = normal;\n    vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, normal);\n    vColor = vec4(lightColor, colors.a * opacity);\n  } else {\n    vColor = vec4(colors.rgb, colors.a * opacity);\n  }\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",Kt="#define SHADER_NAME solid-polygon-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 positions64Low;\nattribute float elevations;\nattribute vec4 fillColors;\nattribute vec4 lineColors;\nattribute vec3 pickingColors;\n\n".concat(Zt,"\n\nvoid main(void) {\n  PolygonProps props;\n\n  props.positions = positions;\n  props.positions64Low = positions64Low;\n  props.elevations = elevations;\n  props.fillColors = fillColors;\n  props.lineColors = lineColors;\n  props.pickingColors = pickingColors;\n\n  calculatePosition(props);\n}\n"),Jt="#define SHADER_NAME solid-polygon-layer-vertex-shader-side\n#define IS_SIDE_VERTEX\n\n\nattribute vec3 instancePositions;\nattribute vec3 nextPositions;\nattribute vec3 instancePositions64Low;\nattribute vec3 nextPositions64Low;\nattribute float instanceElevations;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\n".concat(Zt,"\n\nvoid main(void) {\n  PolygonProps props;\n\n  #if RING_WINDING_ORDER_CW == 1\n    props.positions = instancePositions;\n    props.positions64Low = instancePositions64Low;\n    props.nextPositions = nextPositions;\n    props.nextPositions64Low = nextPositions64Low;\n  #else\n    props.positions = nextPositions;\n    props.positions64Low = nextPositions64Low;\n    props.nextPositions = instancePositions;\n    props.nextPositions64Low = instancePositions64Low;\n  #endif\n  props.elevations = instanceElevations;\n  props.fillColors = instanceFillColors;\n  props.lineColors = instanceLineColors;\n  props.pickingColors = instancePickingColors;\n\n  calculatePosition(props);\n}\n");function Xt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function $t(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xt(Object(n),!0).forEach((function(t){Object(c.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Yt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(l.a)(e);if(t){var r=Object(l.a)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Object(s.a)(this,n)}}var qt=[0,0,0,255],Qt={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:function(e){return e.polygon}},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:qt},getLineColor:{type:"accessor",value:qt},material:!0},en={enter:function(e,t){return t.length?t.subarray(t.length-e.length):e}},tn=function(e){Object(a.a)(n,e);var t=Yt(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"getShaders",value:function(e){return Object(o.a)(Object(l.a)(n.prototype),"getShaders",this).call(this,{vs:"top"===e?Kt:Jt,fs:"#define SHADER_NAME solid-polygon-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\n\nvoid main(void) {\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",defines:{RING_WINDING_ORDER_CW:this.props._normalize||"CCW"!==this.props._windingOrder?1:0},modules:[y.a,Ct.a,m.a]})}},{key:"wrapLongitude",get:function(){return!1}},{key:"initializeState",value:function(){var e=this,t=this.context,n=t.gl,i=t.viewport,r=this.props.coordinateSystem;i.isGeospatial&&r===b.a.DEFAULT&&(r=b.a.LNGLAT),this.setState({numInstances:0,polygonTesselator:new Ht({preproject:r===b.a.LNGLAT&&i.projectFlat,fp64:this.use64bitPositions(),IndexType:!n||Object(jt.c)(n,At.a.ELEMENT_INDEX_UINT32)?Uint32Array:Uint16Array})});var o=this.getAttributeManager();o.remove(["instancePickingColors"]),o.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:!0},positions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:en,accessor:"getPolygon",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{positions:{vertexOffset:0,divisor:0},instancePositions:{vertexOffset:0,divisor:1},nextPositions:{vertexOffset:1,divisor:1}}},vertexValid:{size:1,divisor:1,type:5121,update:this.calculateVertexValid,noAlloc:!0},elevations:{size:1,transition:en,accessor:"getElevation",shaderAttributes:{elevations:{divisor:0},instanceElevations:{divisor:1}}},fillColors:{alias:"colors",size:this.props.colorFormat.length,type:5121,normalized:!0,transition:en,accessor:"getFillColor",defaultValue:qt,shaderAttributes:{fillColors:{divisor:0},instanceFillColors:{divisor:1}}},lineColors:{alias:"colors",size:this.props.colorFormat.length,type:5121,normalized:!0,transition:en,accessor:"getLineColor",defaultValue:qt,shaderAttributes:{lineColors:{divisor:0},instanceLineColors:{divisor:1}}},pickingColors:{size:3,type:5121,accessor:function(t,n){var i=n.index,r=n.target;return e.encodePickingColor(t&&t.__source?t.__source.index:i,r)},shaderAttributes:{pickingColors:{divisor:0},instancePickingColors:{divisor:1}}}})}},{key:"getPickingInfo",value:function(e){var t=Object(o.a)(Object(l.a)(n.prototype),"getPickingInfo",this).call(this,e),i=t.index,r=this.props.data;return r[0]&&r[0].__source&&(t.object=r.find((function(e){return e.__source.index===i}))),t}},{key:"disablePickingIndex",value:function(e){var t=this.props.data;if(t[0]&&t[0].__source)for(var n=0;n<t.length;n++)t[n].__source.index===e&&this._disablePickingIndex(n);else this._disablePickingIndex(e)}},{key:"draw",value:function(e){var t=e.uniforms,n=this.props,i=n.extruded,r=n.filled,o=n.wireframe,a=n.elevationScale,s=this.state,l=s.topModel,c=s.sideModel,u=s.polygonTesselator,f=$t($t({},t),{},{extruded:Boolean(i),elevationScale:a});c&&(c.setInstanceCount(u.instanceCount-1),c.setUniforms(f),o&&(c.setDrawMode(3),c.setUniforms({isWireframe:!0}).draw()),r&&(c.setDrawMode(6),c.setUniforms({isWireframe:!1}).draw())),l&&(l.setVertexCount(u.vertexCount),l.setUniforms(f).draw())}},{key:"updateState",value:function(e){Object(o.a)(Object(l.a)(n.prototype),"updateState",this).call(this,e),this.updateGeometry(e);var t,i=e.props,r=e.oldProps,a=e.changeFlags,s=this.getAttributeManager();(a.extensionsChanged||i.filled!==r.filled||i.extruded!==r.extruded)&&(null===(t=this.state.models)||void 0===t||t.forEach((function(e){return e.delete()})),this.setState(this._getModels(this.context.gl)),s.invalidateAll())}},{key:"updateGeometry",value:function(e){var t=e.props,n=(e.oldProps,e.changeFlags);if(n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPolygon)){var i=this.state.polygonTesselator,r=t.data.attributes||{};i.updateGeometry({data:t.data,normalize:t._normalize,geometryBuffer:r.getPolygon,buffers:r,getGeometry:t.getPolygon,positionFormat:t.positionFormat,wrapLongitude:t.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:n.dataChanged}),this.setState({numInstances:i.instanceCount,startIndices:i.vertexStarts}),n.dataChanged||this.getAttributeManager().invalidateAll()}}},{key:"_getModels",value:function(e){var t,n,i=this.props,r=i.id,o=i.filled,a=i.extruded;if(o){var s=this.getShaders("top");s.defines.NON_INSTANCED_MODEL=1,t=new P.a(e,$t($t({},s),{},{id:"".concat(r,"-top"),drawMode:4,attributes:{vertexPositions:new Float32Array([0,1])},uniforms:{isWireframe:!1,isSideVertex:!1},vertexCount:0,isIndexed:!0}))}return a&&((n=new P.a(e,$t($t({},this.getShaders("side")),{},{id:"".concat(r,"-side"),geometry:new O.a({drawMode:1,vertexCount:4,attributes:{vertexPositions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),instanceCount:0,isInstanced:1}))).userData.excludeAttributes={indices:!0}),{models:[n,t].filter(Boolean),topModel:t,sideModel:n}}},{key:"calculateIndices",value:function(e){var t=this.state.polygonTesselator;e.startIndices=t.indexStarts,e.value=t.get("indices")}},{key:"calculatePositions",value:function(e){var t=this.state.polygonTesselator;e.startIndices=t.vertexStarts,e.value=t.get("positions")}},{key:"calculateVertexValid",value:function(e){e.value=this.state.polygonTesselator.get("vertexValid")}}]),n}(x.a);tn.layerName="SolidPolygonLayer",tn.defaultProps=Qt;var nn={circle:{type:V.a,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",pointBillboard:"billboard",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:N,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",iconAlphaCutoff:"alphaCutoff",iconBillboard:"billboard",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:Te,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",textBillboard:"billboard",textFontSettings:"fontSettings",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},rn={type:wt,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",lineBillboard:"billboard",getLineColor:"getColor",getLineWidth:"getWidth"}},on={type:tn,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function an(e){var t=e.type,n=e.props,i={};for(var r in n)i[r]=t.defaultProps[n[r]];return i}function sn(e,t){var n=e.props,i=n.transitions,r=n.updateTriggers,o={updateTriggers:{},transitions:i&&{getPosition:i.geometry}};for(var a in t){var s=t[a],l=e.props[a];a.startsWith("get")&&(l=e.getSubLayerAccessor(l),o.updateTriggers[s]=r[a],i&&(o.transitions[s]=i[a])),o[s]=l}return o}function ln(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},r=n.startRow,o=void 0===r?0:r,a=n.endRow,s=void 0===a?e.length:a,l=o;l<s;l++){var c=e[l];u.a.assert(c&&c.geometry,"GeoJSON does not have geometry");var f=c.geometry;if("GeometryCollection"===f.type){u.a.assert(Array.isArray(f.geometries),"GeoJSON does not have geometries array");for(var p=f.geometries,d=0;d<p.length;d++){var g=p[d];cn(g,i,t,c,l)}}else cn(f,i,t,c,l)}return i}function cn(e,t,n,i,r){var o=e.type,a=e.coordinates,s=t.pointFeatures,l=t.lineFeatures,c=t.polygonFeatures,f=t.polygonOutlineFeatures;if(function(e,t){var n=un[e];u.a.assert(n,"Unknown GeoJSON type ".concat(e));for(;t&&--n>0;)t=t[0];return t&&Number.isFinite(t[0])}(o,a))switch(o){case"Point":s.push(n({geometry:e},i,r));break;case"MultiPoint":a.forEach((function(e){s.push(n({geometry:{type:"Point",coordinates:e}},i,r))}));break;case"LineString":l.push(n({geometry:e},i,r));break;case"MultiLineString":a.forEach((function(e){l.push(n({geometry:{type:"LineString",coordinates:e}},i,r))}));break;case"Polygon":c.push(n({geometry:e},i,r)),a.forEach((function(e){f.push(n({geometry:{type:"LineString",coordinates:e}},i,r))}));break;case"MultiPolygon":a.forEach((function(e){c.push(n({geometry:{type:"Polygon",coordinates:e}},i,r)),e.forEach((function(e){f.push(n({geometry:{type:"LineString",coordinates:e}},i,r))}))}))}else u.a.warn("".concat(o," coordinates are malformed"))()}var un={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function fn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function pn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fn(Object(n),!0).forEach((function(t){Object(c.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function dn(e){return e.geometry.coordinates}function gn(e,t){var n={points:{},lines:{},polygons:{},polygonsOutline:{}},i=e.points,r=e.lines,o=e.polygons,a=function(e,t){var n={points:null,lines:null,polygons:null};for(var i in n){var r=e[i].globalFeatureIds.value;n[i]=new Uint8ClampedArray(3*r.length);for(var o=[],a=0;a<r.length;a++)t(r[a],o),n[i][3*a+0]=o[0],n[i][3*a+1]=o[1],n[i][3*a+2]=o[2]}return n}(e,t);return n.points.data={length:i.positions.value.length/i.positions.size,attributes:pn(pn({},i.attributes),{},{getPosition:i.positions,instancePickingColors:{size:3,value:a.points}}),properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},n.lines.data={length:r.pathIndices.value.length-1,startIndices:r.pathIndices.value,attributes:pn(pn({},r.attributes),{},{getPath:r.positions,instancePickingColors:{size:3,value:a.lines}}),properties:r.properties,numericProps:r.numericProps,featureIds:r.featureIds},n.lines._pathType="open",n.polygons.data={length:o.polygonIndices.value.length-1,startIndices:o.polygonIndices.value,attributes:pn(pn({},o.attributes),{},{getPolygon:o.positions,pickingColors:{size:3,value:a.polygons}}),properties:o.properties,numericProps:o.numericProps,featureIds:o.featureIds},n.polygons._normalize=!1,o.triangles&&(n.polygons.data.attributes.indices=o.triangles.value),n.polygonsOutline.data={length:o.primitivePolygonIndices.value.length-1,startIndices:o.primitivePolygonIndices.value,attributes:pn(pn({},o.attributes),{},{getPath:o.positions,instancePickingColors:{size:3,value:a.polygons}}),properties:o.properties,numericProps:o.numericProps,featureIds:o.featureIds},n.polygonsOutline._pathType="open",n}function hn(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return vn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return vn(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function vn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function yn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(l.a)(e);if(t){var r=Object(l.a)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Object(s.a)(this,n)}}function mn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function bn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?mn(Object(n),!0).forEach((function(t){Object(c.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var xn=bn(bn(bn(bn(bn(bn({},an(nn.circle)),an(nn.icon)),an(nn.text)),an(rn)),an(on)),{},{stroked:!0,filled:!0,extruded:!1,wireframe:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:function(e){return e.properties.icon}},getText:{type:"accessor",value:function(e){return e.properties.text}},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}}),Pn=function(e){Object(a.a)(n,e);var t=yn(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"initializeState",value:function(){this.state={layerProps:{},features:{}},this.props.getLineDashArray&&u.a.removed("getLineDashArray","PathStyleExtension")()}},{key:"updateState",value:function(e){var t=e.props,n=e.changeFlags;if(n.dataChanged){var i=this.props.data,r=i&&"points"in i&&"polygons"in i&&"lines"in i;this.setState({binary:r}),r?this._updateStateBinary({props:t,changeFlags:n}):this._updateStateJSON({props:t,changeFlags:n})}}},{key:"_updateStateBinary",value:function(e){var t=e.props,n=(e.changeFlags,gn(t.data,this.encodePickingColor));this.setState({layerProps:n})}},{key:"_updateStateJSON",value:function(e){var t=e.props,n=e.changeFlags,i=function(e){if(Array.isArray(e))return e;switch(u.a.assert(e.type,"GeoJSON does not have type"),e.type){case"Feature":return[e];case"FeatureCollection":return u.a.assert(Array.isArray(e.features),"GeoJSON does not have features array"),e.features;default:return[{geometry:e}]}}(t.data),r=this.getSubLayerRow.bind(this),o={},a={};if(Array.isArray(n.dataChanged)){var s=this.state.features;for(var l in s)o[l]=s[l].slice(),a[l]=[];var c,f=hn(n.dataChanged);try{for(f.s();!(c=f.n()).done;){var d=c.value,g=ln(i,r,d);for(var h in s)a[h].push(p({data:o[h],getIndex:function(e){return e.__source.index},dataRange:d,replace:g[h]}))}}catch(y){f.e(y)}finally{f.f()}}else o=ln(i,r);var v=function(e,t){var n={points:{},lines:{},polygons:{},polygonsOutline:{}},i=e.pointFeatures,r=e.lineFeatures,o=e.polygonFeatures,a=e.polygonOutlineFeatures;return n.points.data=i,n.points._dataDiff=t.pointFeatures&&function(){return t.pointFeatures},n.points.getPosition=dn,n.lines.data=r,n.lines._dataDiff=t.lineFeatures&&function(){return t.lineFeatures},n.lines.getPath=dn,n.polygons.data=o,n.polygons._dataDiff=t.polygonFeatures&&function(){return t.polygonFeatures},n.polygons.getPolygon=dn,n.polygonsOutline.data=a,n.polygonsOutline._dataDiff=t.polygonOutlineFeatures&&function(){return t.polygonOutlineFeatures},n.polygonsOutline.getPath=dn,n}(o,a);this.setState({features:o,featuresDiff:a,layerProps:v})}},{key:"_updateAutoHighlight",value:function(e){var t,n="".concat(this.id,"-points-"),i=e.sourceLayer.id.startsWith(n),r=hn(this.getSubLayers());try{for(r.s();!(t=r.n()).done;){var o=t.value;o.id.startsWith(n)===i&&o.updateAutoHighlight(e)}}catch(a){r.e(a)}finally{r.f()}}},{key:"_renderPolygonLayer",value:function(){var e=this.props,t=e.extruded,n=e.wireframe,i=this.state.layerProps,r="polygons-fill",o=this.shouldRenderSubLayer(r,i.polygons.data)&&this.getSubLayerClass(r,on.type);if(o){var a=sn(this,on.props),s=t&&n;return s||delete a.getLineColor,a.updateTriggers.lineColors=s,new o(a,this.getSubLayerProps({id:r,updateTriggers:a.updateTriggers}),i.polygons)}return null}},{key:"_renderLineLayers",value:function(){var e=this.props,t=e.extruded,n=e.stroked,i=this.state.layerProps,r=!t&&n&&this.shouldRenderSubLayer("polygons-stroke",i.polygonsOutline.data)&&this.getSubLayerClass("polygons-stroke",rn.type),o=this.shouldRenderSubLayer("linestrings",i.lines.data)&&this.getSubLayerClass("linestrings",rn.type);if(r||o){var a=sn(this,rn.props);return[r&&new r(a,this.getSubLayerProps({id:"polygons-stroke",updateTriggers:a.updateTriggers}),i.polygonsOutline),o&&new o(a,this.getSubLayerProps({id:"linestrings",updateTriggers:a.updateTriggers}),i.lines)]}return null}},{key:"_renderPointLayers",value:function(){var e=this.props.pointType,t=this.state,n=t.layerProps,i=t.binary,r=this.props.highlightedObjectIndex;!i&&Number.isFinite(r)&&(r=n.points.data.findIndex((function(e){return e.__source.index===r})));var o,a=[],s=hn(new Set(e.split("+")));try{for(s.s();!(o=s.n()).done;){var l=o.value,c="points-".concat(l),u=nn[l],f=u&&this.shouldRenderSubLayer(c,n.points.data)&&this.getSubLayerClass(c,u.type);if(f){var p=sn(this,u.props);a.push(new f(p,this.getSubLayerProps({id:c,updateTriggers:p.updateTriggers,highlightedObjectIndex:r}),n.points))}}}catch(d){s.e(d)}finally{s.f()}return a}},{key:"renderLayers",value:function(){var e=this.props.extruded,t=this._renderPolygonLayer();return[!e&&t,this._renderLineLayers(),this._renderPointLayers(),e&&t]}},{key:"getSubLayerAccessor",value:function(e){return this.state.binary&&"function"==typeof e?function(t,n){var i=h(n.data,n.index);return e(i,n)}:Object(o.a)(Object(l.a)(n.prototype),"getSubLayerAccessor",this).call(this,e)}}]),n}(f.a);Pn.layerName="GeoJsonLayer",Pn.defaultProps=xn},p532:function(e,t,n){"use strict";var i=n("I+eb"),r=n("xDBR"),o=n("/qmn"),a=n("0Dky"),s=n("0GbY"),l=n("SEBh"),c=n("zfnd"),u=n("busE");i({target:"Promise",proto:!0,real:!0,forced:!!o&&a((function(){o.prototype.finally.call({then:function(){}},(function(){}))}))},{finally:function(e){var t=l(this,s("Promise")),n="function"==typeof e;return this.then(n?function(n){return c(t,e()).then((function(){return n}))}:e,n?function(n){return c(t,e()).then((function(){throw n}))}:e)}}),r||"function"!=typeof o||o.prototype.finally||u(o.prototype,"finally",s("Promise").prototype.finally)},rxlC:function(e,t,n){"use strict";e.exports=r,e.exports.default=r;var i=1e20;function r(e,t,n,i,r,o){this.fontSize=e||24,this.buffer=void 0===t?3:t,this.cutoff=i||.25,this.fontFamily=r||"sans-serif",this.fontWeight=o||"normal",this.radius=n||8;var a=this.size=this.fontSize+2*this.buffer,s=a+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=a,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(s*s),this.gridInner=new Float64Array(s*s),this.f=new Float64Array(s),this.z=new Float64Array(s+1),this.v=new Uint16Array(s),this.middle=Math.round(a/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function o(e,t,n,i,r,o){for(var s=0;s<t;s++)a(e,s,t,n,i,r,o);for(var l=0;l<n;l++)a(e,l*t,1,t,i,r,o)}function a(e,t,n,r,o,a,s){var l,c,u,f;for(a[0]=0,s[0]=-i,s[1]=i,l=0;l<r;l++)o[l]=e[t+l*n];for(l=1,c=0,u=0;l<r;l++){do{f=a[c],u=(o[l]-o[f]+l*l-f*f)/(l-f)/2}while(u<=s[c]&&--c>-1);a[++c]=l,s[c]=u,s[c+1]=i}for(l=0,c=0;l<r;l++){for(;s[c+1]<l;)c++;f=a[c],e[t+l*n]=o[f]+(l-f)*(l-f)}}r.prototype._draw=function(e,t){var n,r,a,s,l,c,u,f,p=this.ctx.measureText(e),d=p.width,g=2*this.buffer;t&&void 0!==p.actualBoundingBoxLeft?(l=Math.floor(p.actualBoundingBoxAscent)-this.middle,c=Math.max(0,this.middle-Math.ceil(p.actualBoundingBoxAscent)),u=this.buffer,n=(r=Math.min(this.size,Math.ceil(p.actualBoundingBoxRight-p.actualBoundingBoxLeft)))+g,a=(s=Math.min(this.size-c,Math.ceil(p.actualBoundingBoxAscent+p.actualBoundingBoxDescent)))+g):(n=r=this.size,a=s=this.size,l=0,c=u=0),r&&s&&(this.ctx.clearRect(u,c,r,s),this.ctx.fillText(e,this.buffer,this.middle),f=this.ctx.getImageData(u,c,r,s));var h=new Uint8ClampedArray(n*a);return function(e,t,n,r,o,a,s){a.fill(i,0,t*n),s.fill(0,0,t*n);for(var l=(t-r)/2,c=0;c<o;c++)for(var u=0;u<r;u++){var f=(c+l)*t+u+l,p=e.data[4*(c*r+u)+3]/255;if(1===p)a[f]=0,s[f]=i;else if(0===p)a[f]=i,s[f]=0;else{var d=Math.max(0,.5-p),g=Math.max(0,p-.5);a[f]=d*d,s[f]=g*g}}}(f,n,a,r,s,this.gridOuter,this.gridInner),o(this.gridOuter,n,a,this.f,this.v,this.z),o(this.gridInner,n,a,this.f,this.v,this.z),function(e,t,n,i,r,o,a){for(var s=0;s<t*n;s++){var l=Math.sqrt(i[s])-Math.sqrt(r[s]);e[s]=Math.round(255-255*(l/o+a))}}(h,n,a,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:h,metrics:{width:r,height:s,sdfWidth:n,sdfHeight:a,top:l,left:0,advance:d,fontAscent:p.fontBoundingBoxAscent}}},r.prototype.draw=function(e){return this._draw(e,!1).data},r.prototype.drawWithMetrics=function(e){return this._draw(e,!0)}},zfnd:function(e,t,n){var i=n("glrk"),r=n("hh1v"),o=n("8GlL");e.exports=function(e,t){if(i(e),r(t)&&t.constructor===e)return t;var n=o.f(e);return(0,n.resolve)(t),n.promise}}}]);