"use strict";(self.webpackChunkproject_website=self.webpackChunkproject_website||[]).push([[9221],{29221:(t,e,i)=>{i.d(e,{Z:()=>M});var s=i(81180),o=i(78918),n=i(61855),r=i(94526),a=i(41868),l=i(85451),h=i(14034),d=i(25108);class c{constructor(t){(0,s.Z)(this,"index",void 0),(0,s.Z)(this,"isVisible",void 0),(0,s.Z)(this,"isSelected",void 0),(0,s.Z)(this,"parent",void 0),(0,s.Z)(this,"children",void 0),(0,s.Z)(this,"content",void 0),(0,s.Z)(this,"state",void 0),(0,s.Z)(this,"layers",void 0),(0,s.Z)(this,"id",void 0),(0,s.Z)(this,"zoom",void 0),(0,s.Z)(this,"userData",void 0),(0,s.Z)(this,"boundingBox",void 0),(0,s.Z)(this,"_abortController",void 0),(0,s.Z)(this,"_loader",void 0),(0,s.Z)(this,"_loaderId",void 0),(0,s.Z)(this,"_isLoaded",void 0),(0,s.Z)(this,"_isCancelled",void 0),(0,s.Z)(this,"_needsReload",void 0),(0,s.Z)(this,"_bbox",void 0),this.index=t,this.isVisible=!1,this.isSelected=!1,this.parent=null,this.children=[],this.content=null,this._loader=void 0,this._abortController=null,this._loaderId=0,this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1}get bbox(){return this._bbox}set bbox(t){this._bbox||(this._bbox=t,this.boundingBox="west"in t?[[t.west,t.south],[t.east,t.north]]:[[t.left,t.top],[t.right,t.bottom]])}get data(){return this.isLoading&&this._loader?this._loader.then((()=>this.data)):this.content}get isLoaded(){return this._isLoaded&&!this._needsReload}get isLoading(){return Boolean(this._loader)&&!this._isCancelled}get needsReload(){return this._needsReload||this._isCancelled}get byteLength(){const t=this.content?this.content.byteLength:0;return Number.isFinite(t)||d.error("byteLength not defined in tile data"),t}async _loadData({getData:t,requestScheduler:e,onLoad:i,onError:s}){const{index:o,id:n,bbox:r,userData:a,zoom:l}=this,h=this._loaderId;this._abortController=new AbortController;const{signal:d}=this._abortController,c=await e.scheduleRequest(this,(t=>t.isSelected?1:-1));if(!c)return void(this._isCancelled=!0);if(this._isCancelled)return void c.done();let u,m=null;try{m=await t({index:o,id:n,bbox:r,userData:a,zoom:l,signal:d})}catch(f){u=f||!0}finally{c.done()}h===this._loaderId&&(this._loader=void 0,this.content=m,!this._isCancelled||m?(this._isLoaded=!0,this._isCancelled=!1,u?s(u,this):i(this)):this._isLoaded=!1)}loadData(t){return this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1,this._loaderId++,this._loader=this._loadData(t),this._loader}setNeedsReload(){this.isLoading&&(this.abort(),this._loader=void 0),this._needsReload=!0}abort(){var t;this.isLoaded||(this._isCancelled=!0,null===(t=this._abortController)||void 0===t||t.abort())}}var u=i(10892);function m(t,e){if(t===e)return!0;if(Array.isArray(t)){const i=t.length;if(!e||e.length!==i)return!1;for(let s=0;s<i;s++)if(t[s]!==e[s])return!1;return!0}return!1}const f=2,p="best-available",g={[p]:function(t){for(const e of t)e.state=0;for(const e of t)e.isSelected&&!x(e)&&y(e);for(const e of t)e.isVisible=Boolean(e.state&f)},"no-overlap":function(t){for(const i of t)i.state=0;for(const i of t)i.isSelected&&x(i);const e=Array.from(t).sort(((t,e)=>t.zoom-e.zoom));for(const i of e)if(i.isVisible=Boolean(i.state&f),i.children&&(i.isVisible||1&i.state))for(const t of i.children)t.state=1;else i.isSelected&&y(i)},never:()=>{}},_={extent:null,tileSize:512,maxZoom:null,minZoom:null,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:"best-available",zRange:null,maxRequests:6,zoomOffset:0,onTileLoad:()=>{},onTileUnload:()=>{},onTileError:()=>{}};function x(t){let e=t;for(;e;){if(e.isLoaded||e.content)return e.state|=f,!0;e=e.parent}return!1}function y(t){for(const e of t.children)e.isLoaded||e.content?e.state|=f:y(e)}var v=i(25108);const b={TilesetClass:class{constructor(t){(0,s.Z)(this,"opts",void 0),(0,s.Z)(this,"_requestScheduler",void 0),(0,s.Z)(this,"_cache",void 0),(0,s.Z)(this,"_dirty",void 0),(0,s.Z)(this,"_tiles",void 0),(0,s.Z)(this,"_cacheByteSize",void 0),(0,s.Z)(this,"_viewport",void 0),(0,s.Z)(this,"_zRange",void 0),(0,s.Z)(this,"_selectedTiles",void 0),(0,s.Z)(this,"_frameNumber",void 0),(0,s.Z)(this,"_modelMatrix",void 0),(0,s.Z)(this,"_modelMatrixInverse",void 0),(0,s.Z)(this,"_maxZoom",void 0),(0,s.Z)(this,"_minZoom",void 0),(0,s.Z)(this,"onTileLoad",void 0),(0,s.Z)(this,"_getCullBounds",function(t){let e,i={};return s=>{for(const o in s)if(!m(s[o],i[o])){e=t(s),i=s;break}return e}}(u.XT)),this.opts={..._,...t},this.onTileLoad=t=>{var e,i;null===(e=(i=this.opts).onTileLoad)||void 0===e||e.call(i,t),this.opts.maxCacheByteSize&&(this._cacheByteSize+=t.byteLength,this._resizeCache())},this._requestScheduler=new a.Z({maxRequests:t.maxRequests,throttleRequests:Boolean(t.maxRequests&&t.maxRequests>0)}),this._cache=new Map,this._tiles=[],this._dirty=!1,this._cacheByteSize=0,this._viewport=null,this._selectedTiles=null,this._frameNumber=0,this._modelMatrix=new l.Z,this._modelMatrixInverse=new l.Z,this.setOptions(t)}get tiles(){return this._tiles}get selectedTiles(){return this._selectedTiles}get isLoaded(){return null!==this._selectedTiles&&this._selectedTiles.every((t=>t.isLoaded))}get needsReload(){return null!==this._selectedTiles&&this._selectedTiles.some((t=>t.needsReload))}setOptions(t){Object.assign(this.opts,t),Number.isFinite(t.maxZoom)&&(this._maxZoom=Math.floor(t.maxZoom)),Number.isFinite(t.minZoom)&&(this._minZoom=Math.ceil(t.minZoom))}finalize(){for(const t of this._cache.values())t.isLoading&&t.abort();this._cache.clear(),this._tiles=[],this._selectedTiles=null}reloadAll(){for(const t of this._cache.keys()){const e=this._cache.get(t);this._selectedTiles&&this._selectedTiles.includes(e)?e.setNeedsReload():this._cache.delete(t)}}update(t,{zRange:e,modelMatrix:i}={}){const s=new l.Z(i),o=!s.equals(this._modelMatrix);if(this._viewport&&t.equals(this._viewport)&&(0,h.fS)(this._zRange,e)&&!o)this.needsReload&&(this._selectedTiles=this._selectedTiles.map((t=>this._getTile(t.index,!0))));else{o&&(this._modelMatrixInverse=s.clone().invert(),this._modelMatrix=s),this._viewport=t,this._zRange=e;const i=this.getTileIndices({viewport:t,maxZoom:this._maxZoom,minZoom:this._minZoom,zRange:e,modelMatrix:this._modelMatrix,modelMatrixInverse:this._modelMatrixInverse});this._selectedTiles=i.map((t=>this._getTile(t,!0))),this._dirty&&this._rebuildTree()}const n=this.updateTileStates();return this._pruneRequests(),this._dirty&&this._resizeCache(),n&&this._frameNumber++,this._frameNumber}isTileVisible(t,e){if(!t.isVisible)return!1;if(e&&this._viewport){const i=this._getCullBounds({viewport:this._viewport,z:this._zRange,cullRect:e}),{bbox:s}=t;for(const[t,e,o,n]of i){let i;if("west"in s)i=s.west<o&&s.east>t&&s.south<n&&s.north>e;else{const r=Math.min(s.top,s.bottom),a=Math.max(s.top,s.bottom);i=s.left<o&&s.right>t&&r<n&&a>e}if(i)return!0}return!1}return!0}getTileIndices({viewport:t,maxZoom:e,minZoom:i,zRange:s,modelMatrix:o,modelMatrixInverse:n}){const{tileSize:r,extent:a,zoomOffset:l}=this.opts;return(0,u.rJ)({viewport:t,maxZoom:e,minZoom:i,zRange:s,tileSize:r,extent:a,modelMatrix:o,modelMatrixInverse:n,zoomOffset:l})}getTileId(t){return"".concat(t.x,"-").concat(t.y,"-").concat(t.z)}getTileZoom(t){return t.z}getTileMetadata(t){const{tileSize:e}=this.opts;return{bbox:(0,u.z_)(this._viewport,t.x,t.y,t.z,e)}}getParentIndex(t){return{x:Math.floor(t.x/2),y:Math.floor(t.y/2),z:t.z-1}}updateTileStates(){const t=this.opts.refinementStrategy||p,e=new Array(this._cache.size);let i=0;for(const s of this._cache.values())e[i++]=s.isVisible,s.isSelected=!1,s.isVisible=!1;for(const s of this._selectedTiles)s.isSelected=!0,s.isVisible=!0;("function"==typeof t?t:g[t])(Array.from(this._cache.values())),i=0;for(const s of this._cache.values())if(e[i++]!==s.isVisible)return!0;return!1}_pruneRequests(){const{maxRequests:t=0}=this.opts,e=[];let i=0;for(const s of this._cache.values())s.isLoading&&(i++,s.isSelected||s.isVisible||e.push(s));for(;t>0&&i>t&&e.length>0;){e.shift().abort(),i--}}_rebuildTree(){const{_cache:t}=this;for(const e of t.values())e.parent=null,e.children&&(e.children.length=0);for(const e of t.values()){const t=this._getNearestAncestor(e);e.parent=t,null!=t&&t.children&&t.children.push(e)}}_resizeCache(){const{_cache:t,opts:e}=this,i=e.maxCacheSize||(e.maxCacheByteSize?1/0:5*this.selectedTiles.length),s=e.maxCacheByteSize||1/0;if(t.size>i||this._cacheByteSize>s){for(const[r,a]of t){var o,n;if(!a.isVisible&&!a.isSelected)this._cacheByteSize-=e.maxCacheByteSize?a.byteLength:0,t.delete(r),null===(o=(n=this.opts).onTileUnload)||void 0===o||o.call(n,a);if(t.size<=i&&this._cacheByteSize<=s)break}this._rebuildTree(),this._dirty=!0}this._dirty&&(this._tiles=Array.from(this._cache.values()).sort(((t,e)=>t.zoom-e.zoom)),this._dirty=!1)}_getTile(t,e){const i=this.getTileId(t);let s=this._cache.get(i),o=!1;return!s&&e?(s=new c(t),Object.assign(s,this.getTileMetadata(s.index)),Object.assign(s,{id:i,zoom:this.getTileZoom(s.index)}),o=!0,this._cache.set(i,s),this._dirty=!0):s&&s.needsReload&&(o=!0),s&&o&&s.loadData({getData:this.opts.getTileData,requestScheduler:this._requestScheduler,onLoad:this.onTileLoad,onError:this.opts.onTileError}),s}_getNearestAncestor(t){const{_minZoom:e=0}=this;let i=t.index;for(;this.getTileZoom(i)>e;){i=this.getParentIndex(i);const t=this._getTile(i);if(t)return t}return null}},data:{type:"data",value:[]},dataComparator:u.zc.equal,renderSubLayers:{type:"function",value:t=>new r.Z(t)},getTileData:{type:"function",optional:!0,value:null},onViewportLoad:{type:"function",optional:!0,value:null},onTileLoad:{type:"function",value:t=>{}},onTileUnload:{type:"function",value:t=>{}},onTileError:{type:"function",value:t=>v.error(t)},extent:{type:"array",optional:!0,value:null,compare:!0},tileSize:512,maxZoom:null,minZoom:0,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:p,zRange:null,maxRequests:6,zoomOffset:0};class M extends o.Z{initializeState(){this.state={tileset:null,isLoaded:!1}}finalizeState(){var t,e;null===(t=this.state)||void 0===t||null===(e=t.tileset)||void 0===e||e.finalize()}get isLoaded(){var t,e,i;return null===(t=this.state)||void 0===t||null===(e=t.tileset)||void 0===e||null===(i=e.selectedTiles)||void 0===i?void 0:i.every((t=>t.isLoaded&&t.layers&&t.layers.every((t=>t.isLoaded))))}shouldUpdateState({changeFlags:t}){return t.somethingChanged}updateState({changeFlags:t}){let{tileset:e}=this.state;const i=t.propsOrDataChanged||t.updateTriggersChanged,s=t.dataChanged||t.updateTriggersChanged&&(t.updateTriggersChanged.all||t.updateTriggersChanged.getTileData);e?i&&(e.setOptions(this._getTilesetOptions()),s?e.reloadAll():this.state.tileset.tiles.forEach((t=>{t.layers=null}))):(e=new this.props.TilesetClass(this._getTilesetOptions()),this.setState({tileset:e})),this._updateTileset()}_getTilesetOptions(){const{tileSize:t,maxCacheSize:e,maxCacheByteSize:i,refinementStrategy:s,extent:o,maxZoom:n,minZoom:r,maxRequests:a,zoomOffset:l}=this.props;return{maxCacheSize:e,maxCacheByteSize:i,maxZoom:n,minZoom:r,tileSize:t,refinementStrategy:s,extent:o,maxRequests:a,zoomOffset:l,getTileData:this.getTileData.bind(this),onTileLoad:this._onTileLoad.bind(this),onTileError:this._onTileError.bind(this),onTileUnload:this._onTileUnload.bind(this)}}_updateTileset(){const{tileset:t}=this.state,{zRange:e,modelMatrix:i}=this.props,s=t.update(this.context.viewport,{zRange:e,modelMatrix:i}),{isLoaded:o}=t,n=this.state.isLoaded!==o,r=this.state.frameNumber!==s;o&&(n||r)&&this._onViewportLoad(),r&&this.setState({frameNumber:s}),this.state.isLoaded=o}_onViewportLoad(){const{tileset:t}=this.state,{onViewportLoad:e}=this.props;e&&e(t.selectedTiles)}_onTileLoad(t){this.props.onTileLoad(t),t.layers=null,this.setNeedsUpdate()}_onTileError(t,e){this.props.onTileError(t),e.layers=null,this.setNeedsUpdate()}_onTileUnload(t){this.props.onTileUnload(t)}getTileData(t){const{data:e,getTileData:i,fetch:s}=this.props,{signal:o}=t;return t.url="string"==typeof e||Array.isArray(e)?(0,u.z0)(e,t):null,i?i(t):s&&t.url?s(t.url,{propName:"data",layer:this,signal:o}):null}renderSubLayers(t){return this.props.renderSubLayers(t)}getSubLayerPropsByTile(t){return null}getPickingInfo({info:t,sourceLayer:e}){const i=e.props.tile;return t.picked&&(t.tile=i),t.sourceTile=i,t}_updateAutoHighlight(t){const e=t.sourceTile;if(e&&e.layers)for(const i of e.layers)i.updateAutoHighlight(t)}renderLayers(){return this.state.tileset.tiles.map((t=>{const e=this.getSubLayerPropsByTile(t);if(t.isLoaded||t.content)if(t.layers)e&&t.layers[0]&&Object.keys(e).some((i=>t.layers[0].props[i]!==e[i]))&&(t.layers=t.layers.map((t=>t.clone(e))));else{const i=this.renderSubLayers({...this.props,...this.getSubLayerProps({id:t.id,updateTriggers:this.props.updateTriggers}),data:t.content,_offset:0,tile:t});t.layers=(0,n.x)(i,Boolean).map((i=>i.clone({tile:t,...e})))}else;return t.layers}))}filterSubLayer({layer:t,cullRect:e}){const{tile:i}=t.props;return this.state.tileset.isTileVisible(i,e)}}(0,s.Z)(M,"defaultProps",b),(0,s.Z)(M,"layerName","TileLayer")},10892:(t,e,i)=>{i.d(e,{XT:()=>R,rJ:()=>q,z0:()=>C,hG:()=>P,z_:()=>V,zc:()=>w});var s=i(81180),o=i(85451),n=i(7013),r=i(24088),a=i(77160),l=i(98333);const h=Math.PI/180,d=180/Math.PI,c=6370972,u=256;function m(){const t=u/c,e=Math.PI/180*u;return{unitsPerMeter:[t,t,t],unitsPerMeter2:[0,0,0],metersPerUnit:[1/t,1/t,1/t],unitsPerDegree:[e,e,t],unitsPerDegree2:[0,0,0],degreesPerUnit:[1/e,1/e,1/t]}}class f extends n.Z{constructor(t={}){const{latitude:e=0,longitude:i=0,zoom:n=0,nearZMultiplier:r=.1,farZMultiplier:a=2,resolution:l=10}=t;let{height:d,altitude:c=1.5}=t;d=d||1,c=Math.max(.75,c);const f=(new o.Z).lookAt({eye:[0,-c,0],up:[0,0,1]}),p=Math.pow(2,n);f.rotateX(e*h),f.rotateZ(-i*h),f.scale(p/d);const g=Math.atan(.5/c),_=2*u*p/d;super({...t,height:d,viewMatrix:f,longitude:i,latitude:e,zoom:n,distanceScales:m(),fovyRadians:2*g,focalDistance:c,near:r,far:Math.min(2,1/_+1)*c*a}),(0,s.Z)(this,"longitude",void 0),(0,s.Z)(this,"latitude",void 0),(0,s.Z)(this,"resolution",void 0),this.latitude=e,this.longitude=i,this.resolution=l}get projectionMode(){return r.zG.GLOBE}getDistanceScales(){return this.distanceScales}getBounds(t={}){const e={targetZ:t.z||0},i=this.unproject([0,this.height/2],e),s=this.unproject([this.width/2,0],e),o=this.unproject([this.width,this.height/2],e),n=this.unproject([this.width/2,this.height],e);return o[0]<this.longitude&&(o[0]+=360),i[0]>this.longitude&&(i[0]-=360),[Math.min(i[0],o[0],s[0],n[0]),Math.min(i[1],o[1],s[1],n[1]),Math.max(i[0],o[0],s[0],n[0]),Math.max(i[1],o[1],s[1],n[1])]}unproject(t,{topLeft:e=!0,targetZ:i}={}){const[s,o,n]=t,r=e?o:this.height-o,{pixelUnprojectionMatrix:l}=this;let h;if(Number.isFinite(n))h=p(l,[s,r,n,1]);else{const t=p(l,[s,r,-1,1]),e=p(l,[s,r,1,1]),o=((i||0)/c+1)*u,n=a.x9(a.lu([],t,e)),d=a.x9(t),m=a.x9(e),f=4*((4*d*m-(n-d-m)**2)/16)/n,g=(Math.sqrt(d-f)-Math.sqrt(Math.max(0,o*o-f)))/Math.sqrt(n);h=a.t7([],t,e,g)}const[d,m,f]=this.unprojectPosition(h);return Number.isFinite(n)?[d,m,f]:Number.isFinite(i)?[d,m,i]:[d,m]}projectPosition(t){const[e,i,s=0]=t,o=e*h,n=i*h,r=Math.cos(n),a=(s/c+1)*u;return[Math.sin(o)*r*a,-Math.cos(o)*r*a,Math.sin(n)*a]}unprojectPosition(t){const[e,i,s]=t,o=a.Zh(t),n=Math.asin(s/o);return[Math.atan2(e,-i)*d,n*d,(o/u-1)*c]}projectFlat(t){return t}unprojectFlat(t){return t}panByPosition(t,e){const i=this.unproject(e);return{longitude:t[0]-i[0]+this.longitude,latitude:t[1]-i[1]+this.latitude}}}function p(t,e){const i=l.fF([],e,t);return l.bA(i,i,1/i[3]),i}var g=i(96935),_=i(36625),x=i(78866);const y=512,v=3,b=[[.5,.5],[0,0],[0,1],[1,0],[1,1]],M=b.concat([[0,.5],[.5,0],[1,.5],[.5,1]]),z=M.concat([[.25,.5],[.75,.5]]);class Z{constructor(t,e,i){(0,s.Z)(this,"x",void 0),(0,s.Z)(this,"y",void 0),(0,s.Z)(this,"z",void 0),(0,s.Z)(this,"childVisible",void 0),(0,s.Z)(this,"selected",void 0),(0,s.Z)(this,"_children",void 0),this.x=t,this.y=e,this.z=i}get children(){if(!this._children){const t=2*this.x,e=2*this.y,i=this.z+1;this._children=[new Z(t,e,i),new Z(t,e+1,i),new Z(t+1,e,i),new Z(t+1,e+1,i)]}return this._children}update(t){const{viewport:e,cullingVolume:i,elevationBounds:s,minZ:o,maxZ:n,bounds:r,offset:a,project:l}=t,h=this.getBoundingVolume(s,a,l);if(r&&!this.insideBounds(r))return!1;if(i.computeVisibility(h)<0)return!1;if(!this.childVisible){let{z:t}=this;if(t<n&&t>=o){const i=h.distanceTo(e.cameraPosition)*e.scale/e.height;t+=Math.floor(Math.log2(i))}if(t>=n)return this.selected=!0,!0}this.selected=!1,this.childVisible=!0;for(const d of this.children)d.update(t);return!0}getSelected(t=[]){if(this.selected&&t.push(this),this._children)for(const e of this._children)e.getSelected(t);return t}insideBounds([t,e,i,s]){const o=Math.pow(2,this.z),n=y/o;return this.x*n<i&&this.y*n<s&&(this.x+1)*n>t&&(this.y+1)*n>e}getBoundingVolume(t,e,i){if(i){const e=this.z<1?z:this.z<2?M:b,s=[];for(const o of e){const e=P(this.x+o[0],this.y+o[1],this.z);e[2]=t[0],s.push(i(e)),t[0]!==t[1]&&(e[2]=t[1],s.push(i(e)))}return(0,_.du)(s)}const s=Math.pow(2,this.z),o=y/s,n=this.x*o+e*y,r=y-(this.y+1)*o;return new _.Xx([n,r,t[0]],[n+o,r+o,t[1]])}}const T=512,S=[-1/0,-1/0,1/0,1/0],w={type:"object",value:null,validate:(t,e)=>e.optional&&null===t||"string"==typeof t||Array.isArray(t)&&t.every((t=>"string"==typeof t)),equal:(t,e)=>{if(t===e)return!0;if(!Array.isArray(t)||!Array.isArray(e))return!1;const i=t.length;if(i!==e.length)return!1;for(let s=0;s<i;s++)if(t[s]!==e[s])return!1;return!0}};function L(t,e){const i=[e.transformAsPoint([t[0],t[1]]),e.transformAsPoint([t[2],t[1]]),e.transformAsPoint([t[0],t[3]]),e.transformAsPoint([t[2],t[3]])];return[Math.min(...i.map((t=>t[0]))),Math.min(...i.map((t=>t[1]))),Math.max(...i.map((t=>t[0]))),Math.max(...i.map((t=>t[1])))]}function C(t,e){if(!t||!t.length)return null;const{index:i,id:s}=e;if(Array.isArray(t)){t=t[(o=s,Math.abs(o.split("").reduce(((t,e)=>(t<<5)-t+e.charCodeAt(0)|0),0))%t.length)]}var o;let n=t;for(const r of Object.keys(i)){const t=new RegExp("{".concat(r,"}"),"g");n=n.replace(t,String(i[r]))}return Number.isInteger(i.y)&&Number.isInteger(i.z)&&(n=n.replace(/\{-y\}/g,String(Math.pow(2,i.z)-i.y-1))),n}function R({viewport:t,z:e=0,cullRect:i}){return(t.subViewports||[t]).map((t=>B(t,e,i)))}function B(t,e,i){if(!Array.isArray(e)){const s=i.x-t.x,o=i.y-t.y,{width:n,height:r}=i,a={targetZ:e},l=t.unproject([s,o],a),h=t.unproject([s+n,o],a),d=t.unproject([s,o+r],a),c=t.unproject([s+n,o+r],a);return[Math.min(l[0],h[0],d[0],c[0]),Math.min(l[1],h[1],d[1],c[1]),Math.max(l[0],h[0],d[0],c[0]),Math.max(l[1],h[1],d[1],c[1])]}const s=B(t,e[0],i),o=B(t,e[1],i);return[Math.min(s[0],o[0]),Math.min(s[1],o[1]),Math.max(s[2],o[2]),Math.max(s[3],o[3])]}function A(t,e){return Math.pow(2,t)*T/e}function P(t,e,i){const s=A(i,T),o=t/s*360-180,n=Math.PI-2*Math.PI*e/s;return[o,180/Math.PI*Math.atan(.5*(Math.exp(n)-Math.exp(-n)))]}function j(t,e,i,s){const o=A(i,s);return[t/o*T,e/o*T]}function V(t,e,i,s,o=T){if(t.isGeospatial){const[t,o]=P(e,i,s),[n,r]=P(e+1,i+1,s);return{west:t,north:o,east:n,south:r}}const[n,r]=j(e,i,s,o),[a,l]=j(e+1,i+1,s,o);return{left:n,top:r,right:a,bottom:l}}function I(t,e,i,s,o){const n=function(t,e,i){let s;if(e&&2===e.length){const[i,o]=e,n=t.getBounds({z:i}),r=t.getBounds({z:o});s=[Math.min(n[0],r[0]),Math.min(n[1],r[1]),Math.max(n[2],r[2]),Math.max(n[3],r[3])]}else s=t.getBounds();return t.isGeospatial?[Math.max(s[0],i[0]),Math.max(s[1],i[1]),Math.min(s[2],i[2]),Math.min(s[3],i[3])]:[Math.max(Math.min(s[0],i[2]),i[0]),Math.max(Math.min(s[1],i[3]),i[1]),Math.min(Math.max(s[2],i[0]),i[2]),Math.min(Math.max(s[3],i[1]),i[3])]}(t,null,s),r=A(e,i),[a,l,h,d]=function(t,e,i){if(i)return L(t,i).map((t=>t*e/T));return t.map((t=>t*e/T))}(n,r,o),c=[];for(let u=Math.floor(a);u<h;u++)for(let t=Math.floor(l);t<d;t++)c.push({x:u,y:t,z:e});return c}function q({viewport:t,maxZoom:e,minZoom:i,zRange:s,extent:o,tileSize:n=T,modelMatrix:r,modelMatrixInverse:a,zoomOffset:l=0}){let h=t.isGeospatial?Math.round(t.zoom+Math.log2(T/n))+l:Math.ceil(t.zoom)+l;if("number"==typeof i&&Number.isFinite(i)&&h<i){if(!o)return[];h=i}"number"==typeof e&&Number.isFinite(e)&&h>e&&(h=e);let d=o;return r&&a&&o&&!t.isGeospatial&&(d=L(o,r)),t.isGeospatial?function(t,e,i,s){const o=t instanceof f&&t.resolution?t.projectPosition:null,n=Object.values(t.getFrustumPlanes()).map((({normal:t,distance:e})=>new _.JO(t.clone().negate(),e))),r=new _.Mh(n),a=t.distanceScales.unitsPerMeter[2],l=i&&i[0]*a||0,h=i&&i[1]*a||0,d=t instanceof g.Z&&t.pitch<=60?e:0;if(s){const[t,e,i,o]=s,n=(0,x.w5)([t,o]),r=(0,x.w5)([i,e]);s=[n[0],y-n[1],r[0],y-r[1]]}const c=new Z(0,0,0),u={viewport:t,project:o,cullingVolume:r,elevationBounds:[l,h],minZ:d,maxZ:e,bounds:s,offset:0};if(c.update(u),t instanceof g.Z&&t.subViewports&&t.subViewports.length>1){for(u.offset=-1;c.update(u)&&!(--u.offset<-v););for(u.offset=1;c.update(u)&&!(++u.offset>v););}return c.getSelected()}(t,h,s,o):I(t,h,n,d||S,a)}}}]);