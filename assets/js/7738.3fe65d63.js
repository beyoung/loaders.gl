/*! For license information please see 7738.3fe65d63.js.LICENSE.txt */
(self.webpackChunkproject_website=self.webpackChunkproject_website||[]).push([[7738],{80645:(t,e)=>{e.read=function(t,e,i,n,r){var s,o,a=8*r-n-1,l=(1<<a)-1,h=l>>1,u=-7,c=i?r-1:0,d=i?-1:1,f=t[e+c];for(c+=d,s=f&(1<<-u)-1,f>>=-u,u+=a;u>0;s=256*s+t[e+c],c+=d,u-=8);for(o=s&(1<<-u)-1,s>>=-u,u+=n;u>0;o=256*o+t[e+c],c+=d,u-=8);if(0===s)s=1-h;else{if(s===l)return o?NaN:1/0*(f?-1:1);o+=Math.pow(2,n),s-=h}return(f?-1:1)*o*Math.pow(2,s-n)},e.write=function(t,e,i,n,r,s){var o,a,l,h=8*s-r-1,u=(1<<h)-1,c=u>>1,d=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:s-1,p=n?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=u):(o=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-o))<1&&(o--,l*=2),(e+=o+c>=1?d/l:d*Math.pow(2,1-c))*l>=2&&(o++,l/=2),o+c>=u?(a=0,o=u):o+c>=1?(a=(e*l-1)*Math.pow(2,r),o+=c):(a=e*Math.pow(2,c-1)*Math.pow(2,r),o=0));r>=8;t[i+f]=255&a,f+=p,a/=256,r-=8);for(o=o<<r|a,h+=r;h>0;t[i+f]=255&o,f+=p,o/=256,h-=8);t[i+f-p]|=128*g}},3614:(t,e,i)=>{"use strict";t.exports=r;var n=i(80645);function r(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}r.Varint=0,r.Fixed64=1,r.Bytes=2,r.Fixed32=5;var s=4294967296,o=1/s,a="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function l(t){return t.type===r.Bytes?t.readVarint()+t.pos:t.pos+1}function h(t,e,i){return i?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function u(t,e,i){var n=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));i.realloc(n);for(var r=i.pos-1;r>=t;r--)i.buf[r+n]=i.buf[r]}function c(t,e){for(var i=0;i<t.length;i++)e.writeVarint(t[i])}function d(t,e){for(var i=0;i<t.length;i++)e.writeSVarint(t[i])}function f(t,e){for(var i=0;i<t.length;i++)e.writeFloat(t[i])}function p(t,e){for(var i=0;i<t.length;i++)e.writeDouble(t[i])}function g(t,e){for(var i=0;i<t.length;i++)e.writeBoolean(t[i])}function m(t,e){for(var i=0;i<t.length;i++)e.writeFixed32(t[i])}function y(t,e){for(var i=0;i<t.length;i++)e.writeSFixed32(t[i])}function v(t,e){for(var i=0;i<t.length;i++)e.writeFixed64(t[i])}function b(t,e){for(var i=0;i<t.length;i++)e.writeSFixed64(t[i])}function w(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function x(t,e,i){t[i]=e,t[i+1]=e>>>8,t[i+2]=e>>>16,t[i+3]=e>>>24}function _(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}r.prototype={destroy:function(){this.buf=null},readFields:function(t,e,i){for(i=i||this.length;this.pos<i;){var n=this.readVarint(),r=n>>3,s=this.pos;this.type=7&n,t(r,e,this),this.pos===s&&this.skip(n)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=w(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=_(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=w(this.buf,this.pos)+w(this.buf,this.pos+4)*s;return this.pos+=8,t},readSFixed64:function(){var t=w(this.buf,this.pos)+_(this.buf,this.pos+4)*s;return this.pos+=8,t},readFloat:function(){var t=n.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=n.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,i,n=this.buf;return e=127&(i=n[this.pos++]),i<128?e:(e|=(127&(i=n[this.pos++]))<<7,i<128?e:(e|=(127&(i=n[this.pos++]))<<14,i<128?e:(e|=(127&(i=n[this.pos++]))<<21,i<128?e:function(t,e,i){var n,r,s=i.buf;if(r=s[i.pos++],n=(112&r)>>4,r<128)return h(t,n,e);if(r=s[i.pos++],n|=(127&r)<<3,r<128)return h(t,n,e);if(r=s[i.pos++],n|=(127&r)<<10,r<128)return h(t,n,e);if(r=s[i.pos++],n|=(127&r)<<17,r<128)return h(t,n,e);if(r=s[i.pos++],n|=(127&r)<<24,r<128)return h(t,n,e);if(r=s[i.pos++],n|=(1&r)<<31,r<128)return h(t,n,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(i=n[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&a?function(t,e,i){return a.decode(t.subarray(e,i))}(this.buf,e,t):function(t,e,i){var n="",r=e;for(;r<i;){var s,o,a,l=t[r],h=null,u=l>239?4:l>223?3:l>191?2:1;if(r+u>i)break;1===u?l<128&&(h=l):2===u?128==(192&(s=t[r+1]))&&(h=(31&l)<<6|63&s)<=127&&(h=null):3===u?(s=t[r+1],o=t[r+2],128==(192&s)&&128==(192&o)&&((h=(15&l)<<12|(63&s)<<6|63&o)<=2047||h>=55296&&h<=57343)&&(h=null)):4===u&&(s=t[r+1],o=t[r+2],a=t[r+3],128==(192&s)&&128==(192&o)&&128==(192&a)&&((h=(15&l)<<18|(63&s)<<12|(63&o)<<6|63&a)<=65535||h>=1114112)&&(h=null)),null===h?(h=65533,u=1):h>65535&&(h-=65536,n+=String.fromCharCode(h>>>10&1023|55296),h=56320|1023&h),n+=String.fromCharCode(h),r+=u}return n}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==r.Bytes)return t.push(this.readVarint(e));var i=l(this);for(t=t||[];this.pos<i;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==r.Bytes)return t.push(this.readSVarint());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==r.Bytes)return t.push(this.readBoolean());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==r.Bytes)return t.push(this.readFloat());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==r.Bytes)return t.push(this.readDouble());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==r.Bytes)return t.push(this.readFixed32());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==r.Bytes)return t.push(this.readSFixed32());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==r.Bytes)return t.push(this.readFixed64());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==r.Bytes)return t.push(this.readSFixed64());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===r.Varint)for(;this.buf[this.pos++]>127;);else if(e===r.Bytes)this.pos=this.readVarint()+this.pos;else if(e===r.Fixed32)this.pos+=4;else{if(e!==r.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var i=new Uint8Array(e);i.set(this.buf),this.buf=i,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),x(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),x(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),x(this.buf,-1&t,this.pos),x(this.buf,Math.floor(t*o),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),x(this.buf,-1&t,this.pos),x(this.buf,Math.floor(t*o),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var i,n;t>=0?(i=t%4294967296|0,n=t/4294967296|0):(n=~(-t/4294967296),4294967295^(i=~(-t%4294967296))?i=i+1|0:(i=0,n=n+1|0));if(t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,i){i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos]=127&t}(i,0,e),function(t,e){var i=(7&t)<<4;if(e.buf[e.pos++]|=i|((t>>>=3)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;e.buf[e.pos++]=127&t}(n,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,i){for(var n,r,s=0;s<e.length;s++){if((n=e.charCodeAt(s))>55295&&n<57344){if(!r){n>56319||s+1===e.length?(t[i++]=239,t[i++]=191,t[i++]=189):r=n;continue}if(n<56320){t[i++]=239,t[i++]=191,t[i++]=189,r=n;continue}n=r-55296<<10|n-56320|65536,r=null}else r&&(t[i++]=239,t[i++]=191,t[i++]=189,r=null);n<128?t[i++]=n:(n<2048?t[i++]=n>>6|192:(n<65536?t[i++]=n>>12|224:(t[i++]=n>>18|240,t[i++]=n>>12&63|128),t[i++]=n>>6&63|128),t[i++]=63&n|128)}return i}(this.buf,t,this.pos);var i=this.pos-e;i>=128&&u(e,i,this),this.pos=e-1,this.writeVarint(i),this.pos+=i},writeFloat:function(t){this.realloc(4),n.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),n.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var i=0;i<e;i++)this.buf[this.pos++]=t[i]},writeRawMessage:function(t,e){this.pos++;var i=this.pos;t(e,this);var n=this.pos-i;n>=128&&u(i,n,this),this.pos=i-1,this.writeVarint(n),this.pos+=n},writeMessage:function(t,e,i){this.writeTag(t,r.Bytes),this.writeRawMessage(e,i)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,c,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,d,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,g,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,f,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,p,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,m,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,y,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,v,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,b,e)},writeBytesField:function(t,e){this.writeTag(t,r.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,r.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,r.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,r.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,r.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,r.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,r.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,r.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,r.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,r.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}}},43475:(t,e,i)=>{"use strict";i.d(e,{PMTiles:()=>ut,TileType:()=>et});var n=i(25108),r=Math.pow,s=(t,e,i)=>new Promise(((n,r)=>{var s=t=>{try{a(i.next(t))}catch(e){r(e)}},o=t=>{try{a(i.throw(t))}catch(e){r(e)}},a=t=>t.done?n(t.value):Promise.resolve(t.value).then(s,o);a((i=i.apply(t,e)).next())})),o=Uint8Array,a=Uint16Array,l=Int32Array,h=new o([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),u=new o([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),c=new o([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),d=function(t,e){for(var i=new a(31),n=0;n<31;++n)i[n]=e+=1<<t[n-1];var r=new l(i[30]);for(n=1;n<30;++n)for(var s=i[n];s<i[n+1];++s)r[s]=s-i[n]<<5|n;return{b:i,r:r}},f=d(h,2),p=f.b,g=f.r;p[28]=258,g[258]=28;var m,y=d(u,0),v=y.b,b=(y.r,new a(32768));for(_=0;_<32768;++_)m=(61680&(m=(52428&(m=(43690&_)>>1|(21845&_)<<1))>>2|(13107&m)<<2))>>4|(3855&m)<<4,b[_]=((65280&m)>>8|(255&m)<<8)>>1;var w=function(t,e,i){for(var n=t.length,r=0,s=new a(e);r<n;++r)t[r]&&++s[t[r]-1];var o,l=new a(e);for(r=1;r<e;++r)l[r]=l[r-1]+s[r-1]<<1;if(i){o=new a(1<<e);var h=15-e;for(r=0;r<n;++r)if(t[r])for(var u=r<<4|t[r],c=e-t[r],d=l[t[r]-1]++<<c,f=d|(1<<c)-1;d<=f;++d)o[b[d]>>h]=u}else for(o=new a(n),r=0;r<n;++r)t[r]&&(o[r]=b[l[t[r]-1]++]>>15-t[r]);return o},x=new o(288);for(_=0;_<144;++_)x[_]=8;for(_=144;_<256;++_)x[_]=9;for(_=256;_<280;++_)x[_]=7;for(_=280;_<288;++_)x[_]=8;var _,M=new o(32);for(_=0;_<32;++_)M[_]=5;var T=w(x,9,1),C=w(M,5,1),S=function(t){for(var e=t[0],i=1;i<t.length;++i)t[i]>e&&(e=t[i]);return e},z=function(t,e,i){var n=e/8|0;return(t[n]|t[n+1]<<8)>>(7&e)&i},L=function(t,e){var i=e/8|0;return(t[i]|t[i+1]<<8|t[i+2]<<16)>>(7&e)},F=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],P=function(t,e,i){var n=new Error(e||F[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,P),!i)throw n;return n},A=function(t,e,i,n){var r=t.length,s=n?n.length:0;if(!r||e.f&&!e.l)return i||new o(0);var a=!i||2!=e.i,l=e.i;i||(i=new o(3*r));var d=function(t){var e=i.length;if(t>e){var n=new o(Math.max(2*e,t));n.set(i),i=n}},f=e.f||0,g=e.p||0,m=e.b||0,y=e.l,b=e.d,x=e.m,_=e.n,M=8*r;do{if(!y){f=z(t,g,1);var F=z(t,g+1,3);if(g+=3,!F){var A=t[(N=4+((g+7)/8|0))-4]|t[N-3]<<8,D=N+A;if(D>r){l&&P(0);break}a&&d(m+A),i.set(t.subarray(N,D),m),e.b=m+=A,e.p=g=8*D,e.f=f;continue}if(1==F)y=T,b=C,x=9,_=5;else if(2==F){var B=z(t,g,31)+257,V=z(t,g+10,15)+4,U=B+z(t,g+5,31)+1;g+=14;for(var R=new o(U),E=new o(19),Z=0;Z<V;++Z)E[c[Z]]=z(t,g+3*Z,7);g+=3*V;var k=S(E),I=(1<<k)-1,O=w(E,k,1);for(Z=0;Z<U;){var N,j=O[z(t,g,I)];if(g+=15&j,(N=j>>4)<16)R[Z++]=N;else{var q=0,H=0;for(16==N?(H=3+z(t,g,3),g+=2,q=R[Z-1]):17==N?(H=3+z(t,g,7),g+=3):18==N&&(H=11+z(t,g,127),g+=7);H--;)R[Z++]=q}}var $=R.subarray(0,B),G=R.subarray(B);x=S($),_=S(G),y=w($,x,1),b=w(G,_,1)}else P(1);if(g>M){l&&P(0);break}}a&&d(m+131072);for(var W=(1<<x)-1,K=(1<<_)-1,J=g;;J=g){var X=(q=y[L(t,g)&W])>>4;if((g+=15&q)>M){l&&P(0);break}if(q||P(2),X<256)i[m++]=X;else{if(256==X){J=g,y=null;break}var Y=X-254;if(X>264){var Q=h[Z=X-257];Y=z(t,g,(1<<Q)-1)+p[Z],g+=Q}var tt=b[L(t,g)&K],et=tt>>4;tt||P(3),g+=15&tt;G=v[et];if(et>3){Q=u[et];G+=L(t,g)&(1<<Q)-1,g+=Q}if(g>M){l&&P(0);break}a&&d(m+131072);var it=m+Y;if(m<G){var nt=s-G,rt=Math.min(G,it);for(nt+m<0&&P(3);m<rt;++m)i[m]=n[nt+m]}for(;m<it;m+=4)i[m]=i[m-G],i[m+1]=i[m+1-G],i[m+2]=i[m+2-G],i[m+3]=i[m+3-G];m=it}}e.l=y,e.p=J,e.b=m,e.f=f,y&&(f=1,e.m=x,e.d=b,e.n=_)}while(!f);return m==i.length?i:function(t,e,i){(null==e||e<0)&&(e=0),(null==i||i>t.length)&&(i=t.length);var n=new o(i-e);return n.set(t.subarray(e,i)),n}(i,0,m)},D=new o(0),B=function(t){31==t[0]&&139==t[1]&&8==t[2]||P(6,"invalid gzip data");var e=t[3],i=10;4&e&&(i+=2+(t[10]|t[11]<<8));for(var n=(e>>3&1)+(e>>4&1);n>0;n-=!t[i++]);return i+(2&e)},V=function(t){var e=t.length;return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0},U=function(t,e){return(8!=(15&t[0])||t[0]>>4>7||(t[0]<<8|t[1])%31)&&P(6,"invalid zlib data"),(t[1]>>5&1)==+!e&&P(6,"invalid zlib data: "+(32&t[1]?"need":"unexpected")+" dictionary"),2+(t[1]>>3&4)};function R(t,e){return 31==t[0]&&139==t[1]&&8==t[2]?function(t,e){var i=B(t);return i+8>t.length&&P(6,"invalid gzip data"),A(t.subarray(i,-8),{i:2},e&&e.out||new o(V(t)),e&&e.dictionary)}(t,e):8!=(15&t[0])||t[0]>>4>7||(t[0]<<8|t[1])%31?function(t,e){return A(t,{i:2},e&&e.out,e&&e.dictionary)}(t,e):function(t,e){return A(t.subarray(U(t,e&&e.dictionary),-4),{i:2},e&&e.out,e&&e.dictionary)}(t,e)}var E="undefined"!=typeof TextDecoder&&new TextDecoder;try{E.decode(D,{stream:!0}),1}catch(ct){}var Z=(t,e)=>t*r(2,e),k=(t,e)=>Math.floor(t/r(2,e)),I=(t,e)=>Z(t.getUint16(e+1,!0),8)+t.getUint8(e),O=(t,e)=>Z(t.getUint32(e+2,!0),16)+t.getUint16(e,!0),N=(t,e,i,n,r)=>{if(t!==n.getUint8(r))return t-n.getUint8(r);const s=I(n,r+1);if(e!==s)return e-s;const o=I(n,r+4);return i!==o?i-o:0},j=(t,e,i,n)=>{const r=q(t,e,i,n);return r?{z:e,x:i,y:n,offset:r[0],length:r[1],isDir:!1}:null},q=(t,e,i,n)=>{let r=0,s=t.byteLength/17-1;for(;r<=s;){const o=s+r>>1,a=N(e,i,n,t,17*o);if(a>0)r=o+1;else{if(!(a<0))return[O(t,17*o+7),t.getUint32(17*o+13,!0)];s=o-1}}return null},H=(t,e)=>t.isDir&&!e.isDir?1:!t.isDir&&e.isDir?-1:t.z!==e.z?t.z-e.z:t.x!==e.x?t.x-e.x:t.y-e.y,$=(t,e)=>{const i=t.getUint8(17*e);return{z:127&i,x:I(t,17*e+1),y:I(t,17*e+4),offset:O(t,17*e+7),length:t.getUint32(17*e+13,!0),isDir:i>>7==1}},G=t=>{const e=[],i=new DataView(t);for(let n=0;n<i.byteLength/17;n++)e.push($(i,n));return W(e)},W=t=>{t.sort(H);const e=new ArrayBuffer(17*t.length),i=new Uint8Array(e);for(let n=0;n<t.length;n++){const e=t[n];let r=e.z;e.isDir&&(r|=128),i[17*n]=r,i[17*n+1]=255&e.x,i[17*n+2]=e.x>>8&255,i[17*n+3]=e.x>>16&255,i[17*n+4]=255&e.y,i[17*n+5]=e.y>>8&255,i[17*n+6]=e.y>>16&255,i[17*n+7]=255&e.offset,i[17*n+8]=255&k(e.offset,8),i[17*n+9]=255&k(e.offset,16),i[17*n+10]=255&k(e.offset,24),i[17*n+11]=255&k(e.offset,32),i[17*n+12]=255&k(e.offset,48),i[17*n+13]=255&e.length,i[17*n+14]=e.length>>8&255,i[17*n+15]=e.length>>16&255,i[17*n+16]=e.length>>24&255}return e};var K={getHeader:function(t){return s(this,null,(function*(){const e=yield t.getBytes(0,512e3),i=new DataView(e.data),n=i.getUint32(4,!0),r=i.getUint16(8,!0),s=new TextDecoder("utf-8"),o=JSON.parse(s.decode(new DataView(e.data,10,n)));let a=0;"gzip"===o.compression&&(a=2);let l=0;"minzoom"in o&&(l=+o.minzoom);let h=0;"maxzoom"in o&&(h=+o.maxzoom);let u=0,c=0,d=0,f=-180,p=-85,g=180,m=85;if(o.bounds){const t=o.bounds.split(",");f=+t[0],p=+t[1],g=+t[2],m=+t[3]}if(o.center){const t=o.center.split(",");u=+t[0],c=+t[1],d=+t[2]}return{specVersion:i.getUint16(2,!0),rootDirectoryOffset:10+n,rootDirectoryLength:17*r,jsonMetadataOffset:10,jsonMetadataLength:n,leafDirectoryOffset:0,leafDirectoryLength:void 0,tileDataOffset:0,tileDataLength:void 0,numAddressedTiles:0,numTileEntries:0,numTileContents:0,clustered:!1,internalCompression:1,tileCompression:a,tileType:1,minZoom:l,maxZoom:h,minLon:f,minLat:p,maxLon:g,maxLat:m,centerZoom:d,centerLon:u,centerLat:c,etag:e.etag}}))},getZxy:function(t,e,i,n,r,o,a){return s(this,null,(function*(){let s=yield i.getArrayBuffer(e,t.rootDirectoryOffset,t.rootDirectoryLength,t);1===t.specVersion&&(s=G(s));const l=j(new DataView(s),n,r,o);if(l){let t=(yield e.getBytes(l.offset,l.length,a)).data;const i=new DataView(t);return 31===i.getUint8(0)&&139===i.getUint8(1)&&(t=R(new Uint8Array(t))),{data:t}}const h=((t,e)=>{if(t.byteLength<17)return null;const i=t.byteLength/17,n=$(t,i-1);if(n.isDir){const t=n.z,i=e.z-t;return{z:t,x:Math.trunc(e.x/(1<<i)),y:Math.trunc(e.y/(1<<i))}}return null})(new DataView(s),{z:n,x:r,y:o});if(h){const l=((t,e,i,n)=>{const r=q(t,128|e,i,n);return r?{z:e,x:i,y:n,offset:r[0],length:r[1],isDir:!0}:null})(new DataView(s),h.z,h.x,h.y);if(l){let s=yield i.getArrayBuffer(e,l.offset,l.length,t);1===t.specVersion&&(s=G(s));const h=j(new DataView(s),n,r,o);if(h){let t=(yield e.getBytes(h.offset,h.length,a)).data;const i=new DataView(t);return 31===i.getUint8(0)&&139===i.getUint8(1)&&(t=R(new Uint8Array(t))),{data:t}}}}}))}};function J(t,e){return 4294967296*(e>>>0)+(t>>>0)}function X(t){const e=t.buf;let i=e[t.pos++],n=127&i;return i<128?n:(i=e[t.pos++],n|=(127&i)<<7,i<128?n:(i=e[t.pos++],n|=(127&i)<<14,i<128?n:(i=e[t.pos++],n|=(127&i)<<21,i<128?n:(i=e[t.pos],n|=(15&i)<<28,function(t,e){const i=e.buf;let n=i[e.pos++],r=(112&n)>>4;if(n<128)return J(t,r);if(n=i[e.pos++],r|=(127&n)<<3,n<128)return J(t,r);if(n=i[e.pos++],r|=(127&n)<<10,n<128)return J(t,r);if(n=i[e.pos++],r|=(127&n)<<17,n<128)return J(t,r);if(n=i[e.pos++],r|=(127&n)<<24,n<128)return J(t,r);if(n=i[e.pos++],r|=(1&n)<<31,n<128)return J(t,r);throw new Error("Expected varint not more than 10 bytes")}(n,t)))))}function Y(t,e,i,n){if(0===n){1===i&&(e[0]=t-1-e[0],e[1]=t-1-e[1]);const n=e[0];e[0]=e[1],e[1]=n}}var Q=[0,1,5,21,85,341,1365,5461,21845,87381,349525,1398101,5592405,22369621,89478485,357913941,1431655765,5726623061,22906492245,91625968981,366503875925,1466015503701,5864062014805,23456248059221,93824992236885,375299968947541,0x5555555555555];function tt(t,e){return s(this,null,(function*(){if(1===e||0===e)return t;if(2===e){if(void 0===globalThis.DecompressionStream)return R(new Uint8Array(t));const e=new Response(t).body;if(!e)throw Error("Failed to read response stream");const i=e.pipeThrough(new globalThis.DecompressionStream("gzip"));return new Response(i).arrayBuffer()}throw Error("Compression method not supported")}))}var et=(t=>(t[t.Unknown=0]="Unknown",t[t.Mvt=1]="Mvt",t[t.Png=2]="Png",t[t.Jpeg=3]="Jpeg",t[t.Webp=4]="Webp",t[t.Avif=5]="Avif",t))(et||{});function it(t,e){let i=0,n=t.length-1;for(;i<=n;){const r=n+i>>1,s=e-t[r].tileId;if(s>0)i=r+1;else{if(!(s<0))return t[r];n=r-1}}if(n>=0){if(0===t[n].runLength)return t[n];if(e-t[n].tileId<t[n].runLength)return t[n]}return null}var nt=class{constructor(t,e=new Headers){this.url=t,this.customHeaders=e,this.mustReload=!1}getKey(){return this.url}setHeaders(t){this.customHeaders=t}getBytes(t,e,i,n){return s(this,null,(function*(){let r,s;i?s=i:(r=new AbortController,s=r.signal);const o=new Headers(this.customHeaders);let a;o.set("range",`bytes=${t}-${t+e-1}`),this.mustReload&&(a="reload");let l=yield fetch(this.url,{signal:s,cache:a,headers:o});if(0===t&&416===l.status){const t=l.headers.get("Content-Range");if(!t||!t.startsWith("bytes */"))throw Error("Missing content-length on 416 response");const e=+t.substr(8);l=yield fetch(this.url,{signal:s,cache:"reload",headers:{range:"bytes=0-"+(e-1)}})}let h=l.headers.get("Etag");if((null==h?void 0:h.startsWith("W/"))&&(h=null),416===l.status||n&&h&&h!==n)throw this.mustReload=!0,new ot(n);if(l.status>=300)throw Error(`Bad response code: ${l.status}`);const u=l.headers.get("Content-Length");if(200===l.status&&(!u||+u>e))throw r&&r.abort(),Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield l.arrayBuffer(),etag:h||void 0,cacheControl:l.headers.get("Cache-Control")||void 0,expires:l.headers.get("Expires")||void 0}}))}};function rt(t,e){const i=t.getUint32(e+4,!0),n=t.getUint32(e+0,!0);return i*r(2,32)+n}function st(t){const e={buf:new Uint8Array(t),pos:0},i=X(e),n=[];let r=0;for(let s=0;s<i;s++){const t=X(e);n.push({tileId:r+t,offset:0,length:0,runLength:1}),r+=t}for(let s=0;s<i;s++)n[s].runLength=X(e);for(let s=0;s<i;s++)n[s].length=X(e);for(let s=0;s<i;s++){const t=X(e);n[s].offset=0===t&&s>0?n[s-1].offset+n[s-1].length:t-1}return n}var ot=class extends Error{};function at(t,e){return s(this,null,(function*(){const i=yield t.getBytes(0,16384);if(19792!==new DataView(i.data).getUint16(0,!0))throw new Error("Wrong magic number for PMTiles archive");if(function(t){const e=new DataView(t);return 2===e.getUint16(2,!0)?(n.warn("PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),2):1===e.getUint16(2,!0)?(n.warn("PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),1):3}(i.data)<3)return[yield K.getHeader(t)];const r=function(t,e){const i=new DataView(t),n=i.getUint8(7);if(n>3)throw Error(`Archive is spec version ${n} but this library supports up to spec version 3`);return{specVersion:n,rootDirectoryOffset:rt(i,8),rootDirectoryLength:rt(i,16),jsonMetadataOffset:rt(i,24),jsonMetadataLength:rt(i,32),leafDirectoryOffset:rt(i,40),leafDirectoryLength:rt(i,48),tileDataOffset:rt(i,56),tileDataLength:rt(i,64),numAddressedTiles:rt(i,72),numTileEntries:rt(i,80),numTileContents:rt(i,88),clustered:1===i.getUint8(96),internalCompression:i.getUint8(97),tileCompression:i.getUint8(98),tileType:i.getUint8(99),minZoom:i.getUint8(100),maxZoom:i.getUint8(101),minLon:i.getInt32(102,!0)/1e7,minLat:i.getInt32(106,!0)/1e7,maxLon:i.getInt32(110,!0)/1e7,maxLat:i.getInt32(114,!0)/1e7,centerZoom:i.getUint8(118),centerLon:i.getInt32(119,!0)/1e7,centerLat:i.getInt32(123,!0)/1e7,etag:e}}(i.data.slice(0,127),i.etag),s=i.data.slice(r.rootDirectoryOffset,r.rootDirectoryOffset+r.rootDirectoryLength),o=`${t.getKey()}|${r.etag||""}|${r.rootDirectoryOffset}|${r.rootDirectoryLength}`,a=st(yield e(s,r.internalCompression));return[r,[o,a.length,a]]}))}function lt(t,e,i,n,r){return s(this,null,(function*(){const s=yield t.getBytes(i,n,void 0,r.etag),o=st(yield e(s.data,r.internalCompression));if(0===o.length)throw new Error("Empty directory is invalid");return o}))}var ht=class{constructor(t=100,e=!0,i=tt){this.cache=new Map,this.invalidations=new Map,this.maxCacheEntries=t,this.counter=1,this.decompress=i}getHeader(t){return s(this,null,(function*(){const e=t.getKey(),i=this.cache.get(e);if(i){i.lastUsed=this.counter++;return yield i.data}const n=new Promise(((e,i)=>{at(t,this.decompress).then((t=>{t[1]&&this.cache.set(t[1][0],{lastUsed:this.counter++,data:Promise.resolve(t[1][2])}),e(t[0]),this.prune()})).catch((t=>{i(t)}))}));return this.cache.set(e,{lastUsed:this.counter++,data:n}),n}))}getDirectory(t,e,i,n){return s(this,null,(function*(){const r=`${t.getKey()}|${n.etag||""}|${e}|${i}`,s=this.cache.get(r);if(s){s.lastUsed=this.counter++;return yield s.data}const o=new Promise(((r,s)=>{lt(t,this.decompress,e,i,n).then((t=>{r(t),this.prune()})).catch((t=>{s(t)}))}));return this.cache.set(r,{lastUsed:this.counter++,data:o}),o}))}getArrayBuffer(t,e,i,n){return s(this,null,(function*(){const r=`${t.getKey()}|${n.etag||""}|${e}|${i}`,s=this.cache.get(r);if(s){s.lastUsed=this.counter++;return yield s.data}const o=new Promise(((s,o)=>{t.getBytes(e,i,void 0,n.etag).then((t=>{s(t.data),this.cache.has(r),this.prune()})).catch((t=>{o(t)}))}));return this.cache.set(r,{lastUsed:this.counter++,data:o}),o}))}prune(){if(this.cache.size>=this.maxCacheEntries){let t,e=1/0;this.cache.forEach(((i,n)=>{i.lastUsed<e&&(e=i.lastUsed,t=n)})),t&&this.cache.delete(t)}}invalidate(t){return s(this,null,(function*(){const e=t.getKey();if(this.invalidations.get(e))return yield this.invalidations.get(e);this.cache.delete(t.getKey());const i=new Promise(((i,n)=>{this.getHeader(t).then((t=>{i(),this.invalidations.delete(e)})).catch((t=>{n(t)}))}));this.invalidations.set(e,i)}))}},ut=class{constructor(t,e,i){this.source="string"==typeof t?new nt(t):t,this.decompress=i||tt,this.cache=e||new ht}getHeader(){return s(this,null,(function*(){return yield this.cache.getHeader(this.source)}))}getZxyAttempt(t,e,i,n){return s(this,null,(function*(){const s=function(t,e,i){if(t>26)throw Error("Tile zoom level exceeds max safe number limit (26)");if(e>r(2,t)-1||i>r(2,t)-1)throw Error("tile x/y outside zoom level bounds");const n=Q[t];let s=0,o=0,a=0;const l=[e,i];let h=r(2,t)/2;for(;h>0;)s=(l[0]&h)>0?1:0,o=(l[1]&h)>0?1:0,a+=h*h*(3*s^o),Y(h,l,s,o),h/=2;return n+a}(t,e,i),o=yield this.cache.getHeader(this.source);if(o.specVersion<3)return K.getZxy(o,this.source,this.cache,t,e,i,n);if(t<o.minZoom||t>o.maxZoom)return;let a=o.rootDirectoryOffset,l=o.rootDirectoryLength;for(let t=0;t<=3;t++){const t=it(yield this.cache.getDirectory(this.source,a,l,o),s);if(!t)return;if(t.runLength>0){const e=yield this.source.getBytes(o.tileDataOffset+t.offset,t.length,n,o.etag);return{data:yield this.decompress(e.data,o.tileCompression),cacheControl:e.cacheControl,expires:e.expires}}a=o.leafDirectoryOffset+t.offset,l=t.length}throw Error("Maximum directory depth exceeded")}))}getZxy(t,e,i,n){return s(this,null,(function*(){try{return yield this.getZxyAttempt(t,e,i,n)}catch(ct){if(ct instanceof ot)return this.cache.invalidate(this.source),yield this.getZxyAttempt(t,e,i,n);throw ct}}))}getMetadataAttempt(){return s(this,null,(function*(){const t=yield this.cache.getHeader(this.source),e=yield this.source.getBytes(t.jsonMetadataOffset,t.jsonMetadataLength,void 0,t.etag),i=yield this.decompress(e.data,t.internalCompression),n=new TextDecoder("utf-8");return JSON.parse(n.decode(i))}))}getMetadata(){return s(this,null,(function*(){try{return yield this.getMetadataAttempt()}catch(ct){if(ct instanceof ot)return this.cache.invalidate(this.source),yield this.getMetadataAttempt();throw ct}}))}}},7809:(t,e,i)=>{"use strict";i.d(e,{Z:()=>Q});var n=i(79185),r=i(10048),s=i(6905),o=i(17663),a=i(93234),l=i(52025),h=i(25108);class u{constructor(t){this.index=t,this.isVisible=!1,this.isSelected=!1,this.parent=null,this.children=[],this.content=null,this._loader=void 0,this._abortController=null,this._loaderId=0,this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1}get bbox(){return this._bbox}set bbox(t){this._bbox||(this._bbox=t,this.boundingBox="west"in t?[[t.west,t.south],[t.east,t.north]]:[[t.left,t.top],[t.right,t.bottom]])}get data(){return this.isLoading&&this._loader?this._loader.then((()=>this.data)):this.content}get isLoaded(){return this._isLoaded&&!this._needsReload}get isLoading(){return Boolean(this._loader)&&!this._isCancelled}get needsReload(){return this._needsReload||this._isCancelled}get byteLength(){const t=this.content?this.content.byteLength:0;return Number.isFinite(t)||h.error("byteLength not defined in tile data"),t}async _loadData({getData:t,requestScheduler:e,onLoad:i,onError:n}){const{index:r,id:s,bbox:o,userData:a,zoom:l}=this,h=this._loaderId;this._abortController=new AbortController;const{signal:u}=this._abortController,c=await e.scheduleRequest(this,(t=>t.isSelected?1:-1));if(!c)return void(this._isCancelled=!0);if(this._isCancelled)return void c.done();let d,f=null;try{f=await t({index:r,id:s,bbox:o,userData:a,zoom:l,signal:u})}catch(p){d=p||!0}finally{c.done()}h===this._loaderId&&(this._loader=void 0,this.content=f,!this._isCancelled||f?(this._isLoaded=!0,this._isCancelled=!1,d?n(d,this):i(this)):this._isLoaded=!1)}loadData(t){return this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1,this._loaderId++,this._loader=this._loadData(t),this._loader}setNeedsReload(){this.isLoading&&(this.abort(),this._loader=void 0),this._needsReload=!0}abort(){this.isLoaded||(this._isCancelled=!0,this._abortController?.abort())}}var c=i(62157),d=i(69180),f=i(91220),p=i(18691);const g=Math.PI/180,m=180/Math.PI,y=6370972,v=256;function b(){const t=4018225162502676e-20,e=Math.PI/180*v;return{unitsPerMeter:[t,t,t],unitsPerMeter2:[0,0,0],metersPerUnit:[24886.609375,24886.609375,24886.609375],unitsPerDegree:[e,e,t],unitsPerDegree2:[0,0,0],degreesPerUnit:[1/e,1/e,24886.609375]}}class w extends c.Z{constructor(t={}){const{latitude:e=0,longitude:i=0,zoom:n=0,nearZMultiplier:r=.1,farZMultiplier:s=2,resolution:o=10}=t;let{height:l,altitude:h=1.5}=t;l=l||1,h=Math.max(.75,h);const u=(new a.y).lookAt({eye:[0,-h,0],up:[0,0,1]}),c=Math.pow(2,n);u.rotateX(e*g),u.rotateZ(-i*g),u.scale(c/l);const d=Math.atan(.5/h),f=512*c/l;super({...t,height:l,viewMatrix:u,longitude:i,latitude:e,zoom:n,distanceScales:b(),fovyRadians:2*d,focalDistance:h,near:r,far:Math.min(2,1/f+1)*h*s}),this.latitude=e,this.longitude=i,this.resolution=o}get projectionMode(){return d.zG.GLOBE}getDistanceScales(){return this.distanceScales}getBounds(t={}){const e={targetZ:t.z||0},i=this.unproject([0,this.height/2],e),n=this.unproject([this.width/2,0],e),r=this.unproject([this.width,this.height/2],e),s=this.unproject([this.width/2,this.height],e);return r[0]<this.longitude&&(r[0]+=360),i[0]>this.longitude&&(i[0]-=360),[Math.min(i[0],r[0],n[0],s[0]),Math.min(i[1],r[1],n[1],s[1]),Math.max(i[0],r[0],n[0],s[0]),Math.max(i[1],r[1],n[1],s[1])]}unproject(t,{topLeft:e=!0,targetZ:i}={}){const[n,r,s]=t,o=e?r:this.height-r,{pixelUnprojectionMatrix:a}=this;let l;if(Number.isFinite(s))l=x(a,[n,o,s,1]);else{const t=x(a,[n,o,-1,1]),e=x(a,[n,o,1,1]),r=((i||0)/y+1)*v,s=f.x9(f.lu([],t,e)),h=f.x9(t),u=f.x9(e),c=4*((4*h*u-(s-h-u)**2)/16)/s,d=(Math.sqrt(h-c)-Math.sqrt(Math.max(0,r*r-c)))/Math.sqrt(s);l=f.t7([],t,e,d)}const[h,u,c]=this.unprojectPosition(l);return Number.isFinite(s)?[h,u,c]:Number.isFinite(i)?[h,u,i]:[h,u]}projectPosition(t){const[e,i,n=0]=t,r=e*g,s=i*g,o=Math.cos(s),a=(n/y+1)*v;return[Math.sin(r)*o*a,-Math.cos(r)*o*a,Math.sin(s)*a]}unprojectPosition(t){const[e,i,n]=t,r=f.Zh(t),s=Math.asin(n/r);return[Math.atan2(e,-i)*m,s*m,(r/v-1)*y]}projectFlat(t){return t}unprojectFlat(t){return t}panByPosition(t,e){const i=this.unproject(e);return{longitude:t[0]-i[0]+this.longitude,latitude:t[1]-i[1]+this.latitude}}}function x(t,e){const i=p.fF([],e,t);return p.bA(i,i,1/i[3]),i}var _=i(76418),M=i(82618),T=i(67147);const C=512,S=3,z=[[.5,.5],[0,0],[0,1],[1,0],[1,1]],L=z.concat([[0,.5],[.5,0],[1,.5],[.5,1]]),F=L.concat([[.25,.5],[.75,.5]]);class P{constructor(t,e,i){this.x=t,this.y=e,this.z=i}get children(){if(!this._children){const t=2*this.x,e=2*this.y,i=this.z+1;this._children=[new P(t,e,i),new P(t,e+1,i),new P(t+1,e,i),new P(t+1,e+1,i)]}return this._children}update(t){const{viewport:e,cullingVolume:i,elevationBounds:n,minZ:r,maxZ:s,bounds:o,offset:a,project:l}=t,h=this.getBoundingVolume(n,a,l);if(o&&!this.insideBounds(o))return!1;if(i.computeVisibility(h)<0)return!1;if(!this.childVisible){let{z:t}=this;if(t<s&&t>=r){const i=h.distanceTo(e.cameraPosition)*e.scale/e.height;t+=Math.floor(Math.log2(i))}if(t>=s)return this.selected=!0,!0}this.selected=!1,this.childVisible=!0;for(const u of this.children)u.update(t);return!0}getSelected(t=[]){if(this.selected&&t.push(this),this._children)for(const e of this._children)e.getSelected(t);return t}insideBounds([t,e,i,n]){const r=Math.pow(2,this.z),s=C/r;return this.x*s<i&&this.y*s<n&&(this.x+1)*s>t&&(this.y+1)*s>e}getBoundingVolume(t,e,i){if(i){const e=this.z<1?F:this.z<2?L:z,n=[];for(const r of e){const e=k(this.x+r[0],this.y+r[1],this.z);e[2]=t[0],n.push(i(e)),t[0]!==t[1]&&(e[2]=t[1],n.push(i(e)))}return(0,M.du)(n)}const n=Math.pow(2,this.z),r=C/n,s=this.x*r+e*C,o=C-(this.y+1)*r;return new M.Xx([s,o,t[0]],[s+r,o+r,t[1]])}}const A=512,D=[-1/0,-1/0,1/0,1/0],B={type:"object",value:null,validate:(t,e)=>e.optional&&null===t||"string"==typeof t||Array.isArray(t)&&t.every((t=>"string"==typeof t)),equal:(t,e)=>{if(t===e)return!0;if(!Array.isArray(t)||!Array.isArray(e))return!1;const i=t.length;if(i!==e.length)return!1;for(let n=0;n<i;n++)if(t[n]!==e[n])return!1;return!0}};function V(t,e){const i=[e.transformAsPoint([t[0],t[1]]),e.transformAsPoint([t[2],t[1]]),e.transformAsPoint([t[0],t[3]]),e.transformAsPoint([t[2],t[3]])];return[Math.min(...i.map((t=>t[0]))),Math.min(...i.map((t=>t[1]))),Math.max(...i.map((t=>t[0]))),Math.max(...i.map((t=>t[1])))]}function U(t,e){if(!t||!t.length)return null;const{index:i,id:n}=e;if(Array.isArray(t)){t=t[(r=n,Math.abs(r.split("").reduce(((t,e)=>(t<<5)-t+e.charCodeAt(0)|0),0))%t.length)]}var r;let s=t;for(const o of Object.keys(i)){const t=new RegExp(`{${o}}`,"g");s=s.replace(t,String(i[o]))}return Number.isInteger(i.y)&&Number.isInteger(i.z)&&(s=s.replace(/\{-y\}/g,String(Math.pow(2,i.z)-i.y-1))),s}function R({viewport:t,z:e,cullRect:i}){return(t.subViewports||[t]).map((t=>E(t,e||0,i)))}function E(t,e,i){if(!Array.isArray(e)){const n=i.x-t.x,r=i.y-t.y,{width:s,height:o}=i,a={targetZ:e},l=t.unproject([n,r],a),h=t.unproject([n+s,r],a),u=t.unproject([n,r+o],a),c=t.unproject([n+s,r+o],a);return[Math.min(l[0],h[0],u[0],c[0]),Math.min(l[1],h[1],u[1],c[1]),Math.max(l[0],h[0],u[0],c[0]),Math.max(l[1],h[1],u[1],c[1])]}const n=E(t,e[0],i),r=E(t,e[1],i);return[Math.min(n[0],r[0]),Math.min(n[1],r[1]),Math.max(n[2],r[2]),Math.max(n[3],r[3])]}function Z(t,e){return Math.pow(2,t)*A/e}function k(t,e,i){const n=Z(i,A),r=t/n*360-180,s=Math.PI-2*Math.PI*e/n;return[r,180/Math.PI*Math.atan(.5*(Math.exp(s)-Math.exp(-s)))]}function I(t,e,i,n){const r=Z(i,n);return[t/r*A,e/r*A]}function O(t,e,i,n,r=A){if(t.isGeospatial){const[t,r]=k(e,i,n),[s,o]=k(e+1,i+1,n);return{west:t,north:r,east:s,south:o}}const[s,o]=I(e,i,n,r),[a,l]=I(e+1,i+1,n,r);return{left:s,top:o,right:a,bottom:l}}function N(t,e,i,n,r){const s=function(t,e,i){let n;if(e&&2===e.length){const[i,r]=e,s=t.getBounds({z:i}),o=t.getBounds({z:r});n=[Math.min(s[0],o[0]),Math.min(s[1],o[1]),Math.max(s[2],o[2]),Math.max(s[3],o[3])]}else n=t.getBounds();return t.isGeospatial?[Math.max(n[0],i[0]),Math.max(n[1],i[1]),Math.min(n[2],i[2]),Math.min(n[3],i[3])]:[Math.max(Math.min(n[0],i[2]),i[0]),Math.max(Math.min(n[1],i[3]),i[1]),Math.min(Math.max(n[2],i[0]),i[2]),Math.min(Math.max(n[3],i[1]),i[3])]}(t,null,n),o=Z(e,i),[a,l,h,u]=function(t,e,i){if(i)return V(t,i).map((t=>t*e/A));return t.map((t=>t*e/A))}(s,o,r),c=[];for(let d=Math.floor(a);d<h;d++)for(let t=Math.floor(l);t<u;t++)c.push({x:d,y:t,z:e});return c}function j({viewport:t,maxZoom:e,minZoom:i,zRange:n,extent:r,tileSize:s=A,modelMatrix:o,modelMatrixInverse:a,zoomOffset:l=0}){let h=t.isGeospatial?Math.round(t.zoom+Math.log2(A/s))+l:Math.ceil(t.zoom)+l;if("number"==typeof i&&Number.isFinite(i)&&h<i){if(!r)return[];h=i}"number"==typeof e&&Number.isFinite(e)&&h>e&&(h=e);let u=r;return o&&a&&r&&!t.isGeospatial&&(u=V(r,o)),t.isGeospatial?function(t,e,i,n){const r=t instanceof w&&t.resolution?t.projectPosition:null,s=Object.values(t.getFrustumPlanes()).map((({normal:t,distance:e})=>new M.JO(t.clone().negate(),e))),o=new M.Mh(s),a=t.distanceScales.unitsPerMeter[2],l=i&&i[0]*a||0,h=i&&i[1]*a||0,u=t instanceof _.Z&&t.pitch<=60?e:0;if(n){const[t,e,i,r]=n,s=(0,T.w5)([t,r]),o=(0,T.w5)([i,e]);n=[s[0],C-s[1],o[0],C-o[1]]}const c=new P(0,0,0),d={viewport:t,project:r,cullingVolume:o,elevationBounds:[l,h],minZ:u,maxZ:e,bounds:n,offset:0};if(c.update(d),t instanceof _.Z&&t.subViewports&&t.subViewports.length>1){for(d.offset=-1;c.update(d)&&!(--d.offset<-S););for(d.offset=1;c.update(d)&&!(++d.offset>S););}return c.getSelected()}(t,h,n,r):N(t,h,s,u||D,a)}function q(t,e){if(t===e)return!0;if(Array.isArray(t)){const i=t.length;if(!e||e.length!==i)return!1;for(let n=0;n<i;n++)if(t[n]!==e[n])return!1;return!0}return!1}const H=2,$="best-available",G={[$]:function(t){for(const e of t)e.state=0;for(const e of t)e.isSelected&&!K(e)&&J(e);for(const e of t)e.isVisible=Boolean(e.state&H)},"no-overlap":function(t){for(const i of t)i.state=0;for(const i of t)i.isSelected&&K(i);const e=Array.from(t).sort(((t,e)=>t.zoom-e.zoom));for(const i of e)if(i.isVisible=Boolean(i.state&H),i.children&&(i.isVisible||1&i.state))for(const t of i.children)t.state=1;else i.isSelected&&J(i)},never:()=>{}},W={extent:null,tileSize:512,maxZoom:null,minZoom:null,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:"best-available",zRange:null,maxRequests:6,debounceTime:0,zoomOffset:0,onTileLoad:()=>{},onTileUnload:()=>{},onTileError:()=>{}};function K(t){let e=t;for(;e;){if(e.isLoaded||e.content)return e.state|=H,!0;e=e.parent}return!1}function J(t){for(const e of t.children)e.isLoaded||e.content?e.state|=H:J(e)}var X=i(25108);const Y={TilesetClass:class{constructor(t){this._getCullBounds=function(t){let e,i={};return n=>{for(const r in n)if(!q(n[r],i[r])){e=t(n),i=n;break}return e}}(R),this.opts={...W,...t},this.setOptions(this.opts),this.onTileLoad=t=>{this.opts.onTileLoad?.(t),this.opts.maxCacheByteSize&&(this._cacheByteSize+=t.byteLength,this._resizeCache())},this._requestScheduler=new o.Z({throttleRequests:this.opts.maxRequests>0||this.opts.debounceTime>0,maxRequests:this.opts.maxRequests,debounceTime:this.opts.debounceTime}),this._cache=new Map,this._tiles=[],this._dirty=!1,this._cacheByteSize=0,this._viewport=null,this._zRange=null,this._selectedTiles=null,this._frameNumber=0,this._modelMatrix=new a.y,this._modelMatrixInverse=new a.y}get tiles(){return this._tiles}get selectedTiles(){return this._selectedTiles}get isLoaded(){return null!==this._selectedTiles&&this._selectedTiles.every((t=>t.isLoaded))}get needsReload(){return null!==this._selectedTiles&&this._selectedTiles.some((t=>t.needsReload))}setOptions(t){Object.assign(this.opts,t),Number.isFinite(t.maxZoom)&&(this._maxZoom=Math.floor(t.maxZoom)),Number.isFinite(t.minZoom)&&(this._minZoom=Math.ceil(t.minZoom))}finalize(){for(const t of this._cache.values())t.isLoading&&t.abort();this._cache.clear(),this._tiles=[],this._selectedTiles=null}reloadAll(){for(const t of this._cache.keys()){const e=this._cache.get(t);this._selectedTiles&&this._selectedTiles.includes(e)?e.setNeedsReload():this._cache.delete(t)}}update(t,{zRange:e,modelMatrix:i}={zRange:null,modelMatrix:null}){const n=i?new a.y(i):new a.y,r=!n.equals(this._modelMatrix);if(this._viewport&&t.equals(this._viewport)&&(0,l.fS)(this._zRange,e)&&!r)this.needsReload&&(this._selectedTiles=this._selectedTiles.map((t=>this._getTile(t.index,!0))));else{r&&(this._modelMatrixInverse=n.clone().invert(),this._modelMatrix=n),this._viewport=t,this._zRange=e;const i=this.getTileIndices({viewport:t,maxZoom:this._maxZoom,minZoom:this._minZoom,zRange:e,modelMatrix:this._modelMatrix,modelMatrixInverse:this._modelMatrixInverse});this._selectedTiles=i.map((t=>this._getTile(t,!0))),this._dirty&&this._rebuildTree()}const s=this.updateTileStates();return this._pruneRequests(),this._dirty&&this._resizeCache(),s&&this._frameNumber++,this._frameNumber}isTileVisible(t,e){if(!t.isVisible)return!1;if(e&&this._viewport){const i=this._getCullBounds({viewport:this._viewport,z:this._zRange,cullRect:e}),{bbox:n}=t;for(const[t,e,r,s]of i){let i;if("west"in n)i=n.west<r&&n.east>t&&n.south<s&&n.north>e;else{const o=Math.min(n.top,n.bottom),a=Math.max(n.top,n.bottom);i=n.left<r&&n.right>t&&o<s&&a>e}if(i)return!0}return!1}return!0}getTileIndices({viewport:t,maxZoom:e,minZoom:i,zRange:n,modelMatrix:r,modelMatrixInverse:s}){const{tileSize:o,extent:a,zoomOffset:l}=this.opts;return j({viewport:t,maxZoom:e,minZoom:i,zRange:n,tileSize:o,extent:a,modelMatrix:r,modelMatrixInverse:s,zoomOffset:l})}getTileId(t){return`${t.x}-${t.y}-${t.z}`}getTileZoom(t){return t.z}getTileMetadata(t){const{tileSize:e}=this.opts;return{bbox:O(this._viewport,t.x,t.y,t.z,e)}}getParentIndex(t){return{x:Math.floor(t.x/2),y:Math.floor(t.y/2),z:t.z-1}}updateTileStates(){const t=this.opts.refinementStrategy||$,e=new Array(this._cache.size);let i=0;for(const n of this._cache.values())e[i++]=n.isVisible,n.isSelected=!1,n.isVisible=!1;for(const n of this._selectedTiles)n.isSelected=!0,n.isVisible=!0;("function"==typeof t?t:G[t])(Array.from(this._cache.values())),i=0;for(const n of this._cache.values())if(e[i++]!==n.isVisible)return!0;return!1}_pruneRequests(){const{maxRequests:t=0}=this.opts,e=[];let i=0;for(const n of this._cache.values())n.isLoading&&(i++,n.isSelected||n.isVisible||e.push(n));for(;t>0&&i>t&&e.length>0;){e.shift().abort(),i--}}_rebuildTree(){const{_cache:t}=this;for(const e of t.values())e.parent=null,e.children&&(e.children.length=0);for(const e of t.values()){const t=this._getNearestAncestor(e);e.parent=t,t?.children&&t.children.push(e)}}_resizeCache(){const{_cache:t,opts:e}=this,i=e.maxCacheSize||(e.maxCacheByteSize?1/0:5*this.selectedTiles.length),n=e.maxCacheByteSize||1/0;if(t.size>i||this._cacheByteSize>n){for(const[r,s]of t)if(s.isVisible||s.isSelected||(this._cacheByteSize-=e.maxCacheByteSize?s.byteLength:0,t.delete(r),this.opts.onTileUnload?.(s)),t.size<=i&&this._cacheByteSize<=n)break;this._rebuildTree(),this._dirty=!0}this._dirty&&(this._tiles=Array.from(this._cache.values()).sort(((t,e)=>t.zoom-e.zoom)),this._dirty=!1)}_getTile(t,e){const i=this.getTileId(t);let n=this._cache.get(i),r=!1;return!n&&e?(n=new u(t),Object.assign(n,this.getTileMetadata(n.index)),Object.assign(n,{id:i,zoom:this.getTileZoom(n.index)}),r=!0,this._cache.set(i,n),this._dirty=!0):n&&n.needsReload&&(r=!0),n&&r&&n.loadData({getData:this.opts.getTileData,requestScheduler:this._requestScheduler,onLoad:this.onTileLoad,onError:this.opts.onTileError}),n}_getNearestAncestor(t){const{_minZoom:e=0}=this;let i=t.index;for(;this.getTileZoom(i)>e;){i=this.getParentIndex(i);const t=this._getTile(i);if(t)return t}return null}},data:{type:"data",value:[]},dataComparator:B.equal,renderSubLayers:{type:"function",value:t=>new s.Z(t)},getTileData:{type:"function",optional:!0,value:null},onViewportLoad:{type:"function",optional:!0,value:null},onTileLoad:{type:"function",value:t=>{}},onTileUnload:{type:"function",value:t=>{}},onTileError:{type:"function",value:t=>X.error(t)},extent:{type:"array",optional:!0,value:null,compare:!0},tileSize:512,maxZoom:null,minZoom:0,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:$,zRange:null,maxRequests:6,debounceTime:0,zoomOffset:0};class Q extends n.Z{static{this.defaultProps=Y}static{this.layerName="TileLayer"}initializeState(){this.state={tileset:null,isLoaded:!1}}finalizeState(){this.state?.tileset?.finalize()}get isLoaded(){return Boolean(this.state?.tileset?.selectedTiles?.every((t=>t.isLoaded&&t.layers&&t.layers.every((t=>t.isLoaded)))))}shouldUpdateState({changeFlags:t}){return t.somethingChanged}updateState({changeFlags:t}){let{tileset:e}=this.state;const i=t.propsOrDataChanged||t.updateTriggersChanged,n=t.dataChanged||t.updateTriggersChanged&&(t.updateTriggersChanged.all||t.updateTriggersChanged.getTileData);e?i&&(e.setOptions(this._getTilesetOptions()),n?e.reloadAll():e.tiles.forEach((t=>{t.layers=null}))):(e=new this.props.TilesetClass(this._getTilesetOptions()),this.setState({tileset:e})),this._updateTileset()}_getTilesetOptions(){const{tileSize:t,maxCacheSize:e,maxCacheByteSize:i,refinementStrategy:n,extent:r,maxZoom:s,minZoom:o,maxRequests:a,debounceTime:l,zoomOffset:h}=this.props;return{maxCacheSize:e,maxCacheByteSize:i,maxZoom:s,minZoom:o,tileSize:t,refinementStrategy:n,extent:r,maxRequests:a,debounceTime:l,zoomOffset:h,getTileData:this.getTileData.bind(this),onTileLoad:this._onTileLoad.bind(this),onTileError:this._onTileError.bind(this),onTileUnload:this._onTileUnload.bind(this)}}_updateTileset(){const t=this.state.tileset,{zRange:e,modelMatrix:i}=this.props,n=t.update(this.context.viewport,{zRange:e,modelMatrix:i}),{isLoaded:r}=t,s=this.state.isLoaded!==r,o=this.state.frameNumber!==n;r&&(s||o)&&this._onViewportLoad(),o&&this.setState({frameNumber:n}),this.state.isLoaded=r}_onViewportLoad(){const{tileset:t}=this.state,{onViewportLoad:e}=this.props;e&&e(t.selectedTiles)}_onTileLoad(t){this.props.onTileLoad(t),t.layers=null,this.setNeedsUpdate()}_onTileError(t,e){this.props.onTileError(t),e.layers=null,this.setNeedsUpdate()}_onTileUnload(t){this.props.onTileUnload(t)}getTileData(t){const{data:e,getTileData:i,fetch:n}=this.props,{signal:r}=t;return t.url="string"==typeof e||Array.isArray(e)?U(e,t):null,i?i(t):n&&t.url?n(t.url,{propName:"data",layer:this,signal:r}):null}renderSubLayers(t){return this.props.renderSubLayers(t)}getSubLayerPropsByTile(t){return null}getPickingInfo(t){const e=t.sourceLayer.props.tile,i=t.info;return i.picked&&(i.tile=e),i.sourceTile=e,i}_updateAutoHighlight(t){const e=t.sourceTile;if(e&&e.layers)for(const i of e.layers)i.updateAutoHighlight(t)}renderLayers(){return this.state.tileset.tiles.map((t=>{const e=this.getSubLayerPropsByTile(t);if(t.isLoaded||t.content)if(t.layers)e&&t.layers[0]&&Object.keys(e).some((i=>t.layers[0].props[i]!==e[i]))&&(t.layers=t.layers.map((t=>t.clone(e))));else{const i=this.renderSubLayers({...this.props,...this.getSubLayerProps({id:t.id,updateTriggers:this.props.updateTriggers}),data:t.content,_offset:0,tile:t});t.layers=(0,r.x)(i,Boolean).map((i=>i.clone({tile:t,...e})))}else;return t.layers}))}filterSubLayer({layer:t,cullRect:e}){const{tile:i}=t.props;return this.state.tileset.isTileVisible(i,e)}}},60432:(t,e,i)=>{"use strict";i.d(e,{Z:()=>g});var n=i(69180),r=i(69199),s=i(81014),o=i(76166),a=i(47594),l=i(67147),h=i(52025);const u=new Uint32Array([0,2,1,0,3,2]),c=new Float32Array([0,1,0,0,1,0,1,1]);function d(t,e){if(!e)return function(t){const e=new Float64Array(12);for(let i=0;i<t.length;i++)e[3*i+0]=t[i][0],e[3*i+1]=t[i][1],e[3*i+2]=t[i][2]||0;return{vertexCount:6,positions:e,indices:u,texCoords:c}}(t);const i=Math.max(Math.abs(t[0][0]-t[3][0]),Math.abs(t[1][0]-t[2][0])),n=Math.max(Math.abs(t[1][1]-t[0][1]),Math.abs(t[2][1]-t[3][1])),r=Math.ceil(i/e)+1,s=Math.ceil(n/e)+1,o=(r-1)*(s-1)*6,a=new Uint32Array(o),l=new Float32Array(r*s*2),h=new Float64Array(r*s*3);let d=0,p=0;for(let u=0;u<r;u++){const e=u/(r-1);for(let i=0;i<s;i++){const n=i/(s-1),r=f(t,e,n);h[3*d+0]=r[0],h[3*d+1]=r[1],h[3*d+2]=r[2]||0,l[2*d+0]=e,l[2*d+1]=1-n,u>0&&i>0&&(a[p++]=d-s,a[p++]=d-s-1,a[p++]=d-1,a[p++]=d-s,a[p++]=d-1,a[p++]=d),d++}}return{vertexCount:o,positions:h,indices:a,texCoords:l}}function f(t,e,i){return(0,h.t7)((0,h.t7)(t[0],t[1],i),(0,h.t7)(t[3],t[2],i),e)}const p={image:{type:"image",value:null,async:!0},bounds:{type:"array",value:[1,0,0,1],compare:!0},_imageCoordinateSystem:n.COORDINATE_SYSTEM.DEFAULT,desaturate:{type:"number",min:0,max:1,value:0},transparentColor:{type:"color",value:[0,0,0,0]},tintColor:{type:"color",value:[255,255,255]},textureParameters:{type:"object",ignore:!0,value:null}};class g extends r.Z{static{this.layerName="BitmapLayer"}static{this.defaultProps=p}getShaders(){return super.getShaders({vs:"#version 300 es\n#define SHADER_NAME bitmap-layer-vertex-shader\n\nin vec2 texCoords;\nin vec3 positions;\nin vec3 positions64Low;\n\nout vec2 vTexCoord;\nout vec2 vTexPos;\n\nuniform float coordinateConversion;\n\nconst vec3 pickingColor = vec3(1.0, 0.0, 0.0);\n\nvoid main(void) {\n  geometry.worldPosition = positions;\n  geometry.uv = texCoords;\n  geometry.pickingColor = pickingColor;\n\n  gl_Position = project_position_to_clipspace(positions, positions64Low, vec3(0.0), geometry.position);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  vTexCoord = texCoords;\n\n  if (coordinateConversion < -0.5) {\n    vTexPos = geometry.position.xy + project_uCommonOrigin.xy;\n  } else if (coordinateConversion > 0.5) {\n    vTexPos = geometry.worldPosition.xy;\n  }\n\n  vec4 color = vec4(0.0);\n  DECKGL_FILTER_COLOR(color, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME bitmap-layer-fragment-shader\n\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D bitmapTexture;\n\nin vec2 vTexCoord;\nin vec2 vTexPos;\n\nout vec4 fragColor;\n\nuniform float desaturate;\nuniform vec4 transparentColor;\nuniform vec3 tintColor;\nuniform float opacity;\n\nuniform float coordinateConversion;\nuniform vec4 bounds;\n\n/* projection utils */\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / PI / 2.0;\n\n// from degrees to Web Mercator\nvec2 lnglat_to_mercator(vec2 lnglat) {\n  float x = lnglat.x;\n  float y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2(\n    radians(x) + PI,\n    PI + log(tan(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\n// from Web Mercator to degrees\nvec2 mercator_to_lnglat(vec2 xy) {\n  xy /= WORLD_SCALE;\n  return degrees(vec2(\n    xy.x - PI,\n    atan(exp(xy.y - PI)) * 2.0 - PI * 0.5\n  ));\n}\n/* End projection utils */\n\n// apply desaturation\nvec3 color_desaturate(vec3 color) {\n  float luminance = (color.r + color.g + color.b) * 0.333333333;\n  return mix(color, vec3(luminance), desaturate);\n}\n\n// apply tint\nvec3 color_tint(vec3 color) {\n  return color * tintColor;\n}\n\n// blend with background color\nvec4 apply_opacity(vec3 color, float alpha) {\n  if (transparentColor.a == 0.0) {\n    return vec4(color, alpha);\n  }\n  float blendedAlpha = alpha + transparentColor.a * (1.0 - alpha);\n  float highLightRatio = alpha / blendedAlpha;\n  vec3 blendedRGB = mix(transparentColor.rgb, color, highLightRatio);\n  return vec4(blendedRGB, blendedAlpha);\n}\n\nvec2 getUV(vec2 pos) {\n  return vec2(\n    (pos.x - bounds[0]) / (bounds[2] - bounds[0]),\n    (pos.y - bounds[3]) / (bounds[1] - bounds[3])\n  );\n}\n\n\nvec3 packUVsIntoRGB(vec2 uv) {\n  // Extract the top 8 bits. We want values to be truncated down so we can add a fraction\n  vec2 uv8bit = floor(uv * 256.);\n\n  // Calculate the normalized remainders of u and v parts that do not fit into 8 bits\n  // Scale and clamp to 0-1 range\n  vec2 uvFraction = fract(uv * 256.);\n  vec2 uvFraction4bit = floor(uvFraction * 16.);\n\n  // Remainder can be encoded in blue channel, encode as 4 bits for pixel coordinates\n  float fractions = uvFraction4bit.x + uvFraction4bit.y * 16.;\n\n  return vec3(uv8bit, fractions) / 255.;\n}\n\n\nvoid main(void) {\n  vec2 uv = vTexCoord;\n  if (coordinateConversion < -0.5) {\n    vec2 lnglat = mercator_to_lnglat(vTexPos);\n    uv = getUV(lnglat);\n  } else if (coordinateConversion > 0.5) {\n    vec2 commonPos = lnglat_to_mercator(vTexPos);\n    uv = getUV(commonPos);\n  }\n  vec4 bitmapColor = texture(bitmapTexture, uv);\n\n  fragColor = apply_opacity(color_tint(color_desaturate(bitmapColor.rgb)), bitmapColor.a * opacity);\n\n  geometry.uv = uv;\n  DECKGL_FILTER_COLOR(fragColor, geometry);\n\n  if (bool(picking.isActive) && !bool(picking.isAttribute)) {\n    // Since instance information is not used, we can use picking color for pixel index\n    fragColor.rgb = packUVsIntoRGB(uv);\n  }\n}\n",modules:[s.Z,o.Z]})}initializeState(){const t=this.getAttributeManager();t.remove(["instancePickingColors"]);const e=!0;t.add({indices:{size:1,isIndexed:!0,update:t=>t.value=this.state.mesh.indices,noAlloc:e},positions:{size:3,type:"float64",fp64:this.use64bitPositions(),update:t=>t.value=this.state.mesh.positions,noAlloc:e},texCoords:{size:2,update:t=>t.value=this.state.mesh.texCoords,noAlloc:e}})}updateState({props:t,oldProps:e,changeFlags:i}){const n=this.getAttributeManager();if(i.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),n.invalidateAll()),t.bounds!==e.bounds){const t=this.state.mesh,e=this._createMesh();this.state.model.setVertexCount(e.vertexCount);for(const i in e)t&&t[i]!==e[i]&&n.invalidate(i);this.setState({mesh:e,...this._getCoordinateUniforms()})}else t._imageCoordinateSystem!==e._imageCoordinateSystem&&this.setState(this._getCoordinateUniforms())}getPickingInfo(t){const{image:e}=this.props,i=t.info;if(!i.color||!e)return i.bitmap=null,i;const{width:n,height:r}=e;i.index=0;const s=function(t){const[e,i,n]=t;return[(e+(15&n)/16)/256,(i+(240&n)/256)/256]}(i.color);return i.bitmap={size:{width:n,height:r},uv:s,pixel:[Math.floor(s[0]*n),Math.floor(s[1]*r)]},i}disablePickingIndex(){this.setState({disablePicking:!0})}restorePickingColors(){this.setState({disablePicking:!1})}_updateAutoHighlight(t){super._updateAutoHighlight({...t,color:this.encodePickingColor(0)})}_createMesh(){const{bounds:t}=this.props;let e=t;return m(t)&&(e=[[t[0],t[1]],[t[0],t[3]],[t[2],t[3]],[t[2],t[1]]]),d(e,this.context.viewport.resolution)}_getModel(){return new a.H(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),topology:"triangle-list",isInstanced:!1})}draw(t){const{uniforms:e,moduleParameters:i}=t,{model:n,coordinateConversion:r,bounds:s,disablePicking:o}=this.state,{image:a,desaturate:l,transparentColor:h,tintColor:u}=this.props;i.picking.isActive&&o||a&&n&&(n.setUniforms(e),n.setBindings({bitmapTexture:a}),n.setUniforms({desaturate:l,transparentColor:h.map((t=>t/255)),tintColor:u.slice(0,3).map((t=>t/255)),coordinateConversion:r,bounds:s}),n.draw(this.context.renderPass))}_getCoordinateUniforms(){const{LNGLAT:t,CARTESIAN:e,DEFAULT:i}=n.COORDINATE_SYSTEM;let{_imageCoordinateSystem:r}=this.props;if(r!==i){const{bounds:i}=this.props;if(!m(i))throw new Error("_imageCoordinateSystem only supports rectangular bounds");const n=this.context.viewport.resolution?t:e;if(r=r===t?t:e,r===t&&n===e)return{coordinateConversion:-1,bounds:i};if(r===e&&n===t){const t=(0,l.w5)([i[0],i[1]]),e=(0,l.w5)([i[2],i[3]]);return{coordinateConversion:1,bounds:[t[0],t[1],e[0],e[1]]}}}return{coordinateConversion:0,bounds:[0,0,0,0]}}}function m(t){return Number.isFinite(t[0])}}}]);