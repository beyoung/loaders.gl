"use strict";(self.webpackChunkproject_website=self.webpackChunkproject_website||[]).push([[1163],{3905:(e,a,t)=>{t.d(a,{Zo:()=>p,kt:()=>u});var n=t(67294);function r(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function i(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,n)}return t}function o(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?i(Object(t),!0).forEach((function(a){r(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function l(e,a){if(null==e)return{};var t,n,r=function(e,a){if(null==e)return{};var t,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)t=i[n],a.indexOf(t)>=0||(r[t]=e[t]);return r}(e,a);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)t=i[n],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var d=n.createContext({}),m=function(e){var a=n.useContext(d),t=a;return e&&(t="function"==typeof e?e(a):o(o({},a),e)),t},p=function(e){var a=m(e.components);return n.createElement(d.Provider,{value:a},e.children)},s="mdxType",g={inlineCode:"code",wrapper:function(e){var a=e.children;return n.createElement(n.Fragment,{},a)}},c=n.forwardRef((function(e,a){var t=e.components,r=e.mdxType,i=e.originalType,d=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),s=m(t),c=r,u=s["".concat(d,".").concat(c)]||s[c]||g[c]||i;return t?n.createElement(u,o(o({ref:a},p),{},{components:t})):n.createElement(u,o({ref:a},p))}));function u(e,a){var t=arguments,r=a&&a.mdxType;if("string"==typeof e||r){var i=t.length,o=new Array(i);o[0]=c;var l={};for(var d in a)hasOwnProperty.call(a,d)&&(l[d]=a[d]);l.originalType=e,l[s]="string"==typeof e?e:r,o[1]=l;for(var m=2;m<i;m++)o[m]=t[m];return n.createElement.apply(null,o)}return n.createElement.apply(null,t)}c.displayName="MDXCreateElement"},31581:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>d,contentTitle:()=>o,default:()=>g,frontMatter:()=>i,metadata:()=>l,toc:()=>m});var n=t(83117),r=(t(67294),t(3905));const i={},o="Image Loaders",l={unversionedId:"specifications/category-image",id:"specifications/category-image",title:"Image Loaders",description:"The image loader category documents a common data format, options, conventions and utilities for loader and writers for images that follow loaders.gl conventions.",source:"@site/../docs/specifications/category-image.md",sourceDirName:"specifications",slug:"/specifications/category-image",permalink:"/docs/specifications/category-image",draft:!1,editUrl:"https://github.com/uber-web/loaders.gl/tree/master/website/../docs/specifications/category-image.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Table Loaders",permalink:"/docs/specifications/category-table"},next:{title:"Geospatial Loaders",permalink:"/docs/specifications/category-gis"}},d={},m=[{value:"Image Category Loaders",id:"image-category-loaders",level:2},{value:"Usage",id:"usage",level:2},{value:"Image Types",id:"image-types",level:2},{value:"Image Data",id:"image-data",level:2},{value:"Image Formats",id:"image-formats",level:3},{value:"Compressed Images",id:"compressed-images",level:2},{value:"Options",id:"options",level:2},{value:"Notes",id:"notes",level:2},{value:"About worker loading",id:"about-worker-loading",level:3},{value:"Image API",id:"image-api",level:2},{value:"Remarks",id:"remarks",level:2},{value:"ImageData",id:"imagedata",level:3}],p={toc:m},s="wrapper";function g(e){let{components:a,...t}=e;return(0,r.kt)(s,(0,n.Z)({},p,t,{components:a,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"image-loaders"},"Image Loaders"),(0,r.kt)("p",null,"The image loader category documents a common data format, options, conventions and utilities for loader and writers for images that follow loaders.gl conventions."),(0,r.kt)("h2",{id:"image-category-loaders"},"Image Category Loaders"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Loader"),(0,r.kt)("th",{parentName:"tr",align:null},"Notes"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"modules/images/docs/api-reference/image-loader"},(0,r.kt)("inlineCode",{parentName:"a"},"ImageLoader"))),(0,r.kt)("td",{parentName:"tr",align:null},"Loads compressed images (PNG, JPG, etc)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"modules/basis/docs/api-reference/compressed-texture-loader"},(0,r.kt)("inlineCode",{parentName:"a"},"CompressedTextureLoader"))),(0,r.kt)("td",{parentName:"tr",align:null},"Parses compressed textures to image data mipmap array")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"modules/basis/docs/api-reference/basis-loader"},(0,r.kt)("inlineCode",{parentName:"a"},"BasisLoader"))),(0,r.kt)("td",{parentName:"tr",align:null},"Transpiles into supported compressed texture format")))),(0,r.kt)("p",null,"Core image category support is provided by the ",(0,r.kt)("inlineCode",{parentName:"p"},"@loaders.gl/images")," module:"),(0,r.kt)("h2",{id:"usage"},"Usage"),(0,r.kt)("p",null,"Individual loaders for specific image formats can be imported for ",(0,r.kt)("inlineCode",{parentName:"p"},"@loaders.gl/images"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"import '@loaders.gl/polyfills'; // Only required if loading images under Node.js\nimport {ImageLoader} from '@loaders.gl/images';\nimport {registerLoaders, load} from '@loaders.gl/core';\nregisterLoaders(ImageLoader);\nconst image = await load('image.jpeg');\n")),(0,r.kt)("p",null,"However since each image loader is quite small (in terms of code size and bundle size impact), most applications will just install all image loaders in one go:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"import '@loaders.gl/polyfills'; // Only required if loading images under Node.js\nimport {ImageLoaders} from '@loaders.gl/images';\nimport {registerLoader, load} from '@loaders.gl/core';\nregisterLoaders(ImageLoader);\nconst image = await load('image.jpeg');\n")),(0,r.kt)("h2",{id:"image-types"},"Image Types"),(0,r.kt)("p",null,"Images can be loaded as image data or as opaque image objects (",(0,r.kt)("inlineCode",{parentName:"p"},"Image")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"ImageBitmap"),"), and the image ",(0,r.kt)("em",{parentName:"p"},"type")," option can be used to control the type of image object produced by the ",(0,r.kt)("inlineCode",{parentName:"p"},"ImageLoader"),"."),(0,r.kt)("p",null,"A loaded image can always be returned as an ",(0,r.kt)("em",{parentName:"p"},"image data")," object (an object containing a ",(0,r.kt)("inlineCode",{parentName:"p"},"Uint8Array")," with the pixel data, and metadata like ",(0,r.kt)("inlineCode",{parentName:"p"},"width")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"height"),", and in Node.js images are always loaded as image data objects)."),(0,r.kt)("p",null,"In the browser, the ",(0,r.kt)("inlineCode",{parentName:"p"},"ImageLoader")," uses the browser's native image loading functionality, and if direct access to the image data is not required, it is more efficient to load data into an opaque image object. The ",(0,r.kt)("inlineCode",{parentName:"p"},"ImageLoader")," prefers ",(0,r.kt)("inlineCode",{parentName:"p"},"ImageBitmap")," when supported, falling back to ",(0,r.kt)("inlineCode",{parentName:"p"},"Image")," (aka ",(0,r.kt)("inlineCode",{parentName:"p"},"HTMLImageElement"),") on older browsers."),(0,r.kt)("p",null,"Note that ",(0,r.kt)("em",{parentName:"p"},"type")," is independent of the ",(0,r.kt)("em",{parentName:"p"},"format")," of the image (see below)."),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Image Type"),(0,r.kt)("th",{parentName:"tr",align:null},"Class"),(0,r.kt)("th",{parentName:"tr",align:null},"Availability"),(0,r.kt)("th",{parentName:"tr",align:null},"Workers"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"data")),(0,r.kt)("td",{parentName:"tr",align:null},"Object with ",(0,r.kt)("inlineCode",{parentName:"td"},"{width: Number, height: Number, data: Uint8Array, ...}")),(0,r.kt)("td",{parentName:"tr",align:null},"Node.js and browsers"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Compatible with headless gl.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"imagebitmap")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"ImageBitmap")),(0,r.kt)("td",{parentName:"tr",align:null},"Chrome/Firefox"),(0,r.kt)("td",{parentName:"tr",align:null},"Yes: ",(0,r.kt)("strong",{parentName:"td"},"transferrable")),(0,r.kt)("td",{parentName:"tr",align:null},"A newer JavaScript class designed for efficient loading of images, optimized for use in worker threads and with WebGL")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"image")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"Image")," (aka ",(0,r.kt)("inlineCode",{parentName:"td"},"HTMLImageElement"),")"),(0,r.kt)("td",{parentName:"tr",align:null},"All browsers"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"The traditional HTML/JavaScript class used for image loading into DOM trees. WebGL compatible.")))),(0,r.kt)("h2",{id:"image-data"},"Image Data"),(0,r.kt)("p",null,"Image data objects are images loaded as data, represented by an object that contains a typed array with the pixel data, size, and possibly additional metadata ",(0,r.kt)("inlineCode",{parentName:"p"},"{width: Number, height: Number, data: Uint8Array, ...}")),(0,r.kt)("p",null,"To get an image data object from a loaded ",(0,r.kt)("inlineCode",{parentName:"p"},"Image")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"ImageBitmap"),", call ",(0,r.kt)("inlineCode",{parentName:"p"},"getImageData(image)"),". To load an image data object directly, set the ",(0,r.kt)("inlineCode",{parentName:"p"},"image.type: 'data'")," option when loading the image."),(0,r.kt)("h3",{id:"image-formats"},"Image Formats"),(0,r.kt)("p",null,"The ",(0,r.kt)("em",{parentName:"p"},"format")," of the image describes how the memory is laid out. It is mainly important when working with ",(0,r.kt)("inlineCode",{parentName:"p"},"data")," ",(0,r.kt)("em",{parentName:"p"},"type")," images. The default format / memory layout for image data is ",(0,r.kt)("inlineCode",{parentName:"p"},"RGBA")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"UNSIGNED_BYTE")," i.e. four components per pixel, each a byte."),(0,r.kt)("p",null,"Some loaders may add additional fields to the image data structure to describe the data format. Currently the image category does not provide any documentation for how to describe alternate formats/memory layouts, however a preliminary recommendation is to follow OpenGL/WebGL conventions."),(0,r.kt)("h2",{id:"compressed-images"},"Compressed Images"),(0,r.kt)("p",null,"Compressed images are always returned as image data objects. They will have an additional field, ",(0,r.kt)("inlineCode",{parentName:"p"},"compressed: true"),", indicating that the typed array in the ",(0,r.kt)("inlineCode",{parentName:"p"},"data")," field contains compressed pixels and is not directly indexable."),(0,r.kt)("p",null,"Applications that use e.g. the ",(0,r.kt)("inlineCode",{parentName:"p"},"CompressedTextureLoader")," and/or the ",(0,r.kt)("inlineCode",{parentName:"p"},"BasisLoader")," together with the ",(0,r.kt)("inlineCode",{parentName:"p"},"ImageLoader")," can check this flag before attempting to access the image data."),(0,r.kt)("h2",{id:"options"},"Options"),(0,r.kt)("p",null,"The image category support some generic options (specified using ",(0,r.kt)("inlineCode",{parentName:"p"},"options.image.<option-name>"),"), that are applicable to all (or most) image loaders."),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Option"),(0,r.kt)("th",{parentName:"tr",align:null},"Default"),(0,r.kt)("th",{parentName:"tr",align:null},"Type"),(0,r.kt)("th",{parentName:"tr",align:null},"Availability"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"options.image.type")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"'auto'")),(0,r.kt)("td",{parentName:"tr",align:null},"string"),(0,r.kt)("td",{parentName:"tr",align:null},"See table"),(0,r.kt)("td",{parentName:"tr",align:null},"One of ",(0,r.kt)("inlineCode",{parentName:"td"},"auto"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"data"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"imagebitmap"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"image"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"options.image.decode")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"true")),(0,r.kt)("td",{parentName:"tr",align:null},"boolean"),(0,r.kt)("td",{parentName:"tr",align:null},"No: Edge, IE11"),(0,r.kt)("td",{parentName:"tr",align:null},"Wait for HTMLImages to be fully decoded.")))),(0,r.kt)("h2",{id:"notes"},"Notes"),(0,r.kt)("h3",{id:"about-worker-loading"},"About worker loading"),(0,r.kt)("p",null,"Worker loading is only supported for the ",(0,r.kt)("inlineCode",{parentName:"p"},"data")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"imagebitmap")," formats. Since image worker loading is only available on some browsers (Chrome and Firefox), the ",(0,r.kt)("inlineCode",{parentName:"p"},"ImageLoader")," dynamically determines if worker loading is available. Use ",(0,r.kt)("inlineCode",{parentName:"p"},"options.worker: false")," to disable worker loading of images."),(0,r.kt)("h2",{id:"image-api"},"Image API"),(0,r.kt)("p",null,"The image category also provides a few utilities:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},'Detecting ("sniffing") mime type and size of image files before parsing them'),(0,r.kt)("li",{parentName:"ul"},"Getting image data (arrays of pixels) from an image without knowing which type was loaded (TBA)")),(0,r.kt)("h2",{id:"remarks"},"Remarks"),(0,r.kt)("h3",{id:"imagedata"},"ImageData"),(0,r.kt)("p",null,"Image data objects return by image category loaders have the same fields (",(0,r.kt)("inlineCode",{parentName:"p"},"width"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"height"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"data"),") as the browser's built-in ",(0,r.kt)("inlineCode",{parentName:"p"},"ImageData")," class, but are not actual instances of ",(0,r.kt)("inlineCode",{parentName:"p"},"ImageData"),". However, should you need it, it is easy to create an ",(0,r.kt)("inlineCode",{parentName:"p"},"ImageData")," instance from an image data object:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"const data = load(url, ImageLoader, {image: {type: 'data'}});\nconst imageData = new ImageData(data.data, data.width, data.height);\n")))}g.isMDXComponent=!0}}]);