(self.webpackChunkproject_website=self.webpackChunkproject_website||[]).push([[9393],{1090:(e,t,r)=>{"use strict";r.r(t),r.d(t,{assets:()=>R,contentTitle:()=>_,default:()=>C,frontMatter:()=>A,metadata:()=>T,toc:()=>M});var n=r(87462),o=r(67294),s=r(3905),i=(r(20745),r(8977)),a=r(24009),u=r(29221),c=r(13863),l=r(21970);class f extends l.o{}class d extends f{constructor(e){super(e),this.getTileData=this.getTileData.bind(this)}}var h=r(87951),p=r(7725);async function g(e,t){return{metadata:t,format:"pmtiles",version:e.specVersion,tileType:e.tileType,minZoom:e.minZoom,maxZoom:e.maxZoom,minLon:e.minLon,minLat:e.minLat,maxLon:e.maxLon,maxLat:e.maxLat,centerZoom:e.centerZoom,centerLon:e.centerLon,centerLat:e.centerLat,etag:e.etag,formatHeader:e}}const y={latitude:47.65,longitude:7,zoom:4.5,maxZoom:20,maxPitch:89,bearing:0},m={position:"absolute",right:0,bottom:0,backgroundColor:"hsla(0,0%,100%,.5)",padding:"0 5px",font:"12px/20px Helvetica Neue,Arial,Helvetica,sans-serif"},w={textDecoration:"none",color:"rgba(0,0,0,.75)",cursor:"grab"},b="undefined"!=typeof window&&window.devicePixelRatio||1;function v(e){let{tile:t}=e;if(t){const{x:e,y:r,z:n}=t.index;return"tile: x: "+e+", y: "+r+", z: "+n}return null}const k=new class extends d{constructor(e){super(e),this.pmtiles=new p.JJ(e.url)}async getMetadata(){return g(await this.pmtiles.getHeader(),await this.pmtiles.getMetadata())}async getTile(e){const{x:t,y:r,zoom:n}=e,o=await this.pmtiles.getZxy(n,t,r),s=null==o?void 0:o.data;return s?h.S.parse(s,this.loadOptions):null}async getTileData(e){const{x:t,y:r,z:n}=e.index;return await this.getTile({x:t,y:r,zoom:n,layers:[]})}}({url:"https://r2-public.protomaps.com/protomaps-sample-datasets/terrarium_z9.pmtiles"});function x(e){let{showBorder:t=!1,onTilesLoad:r=null}=e;const n=new u.Z({data:["https://a.tile.openstreetmap.org/{z}/{x}/{y}.png","https://b.tile.openstreetmap.org/{z}/{x}/{y}.png","https://c.tile.openstreetmap.org/{z}/{x}/{y}.png"],getTileData:k.getTileData,maxRequests:20,pickable:!0,onViewportLoad:r,autoHighlight:t,highlightColor:[60,60,60,40],minZoom:0,maxZoom:19,tileSize:256,zoomOffset:1===b?-1:0,renderSubLayers:e=>{const{bbox:{west:t,south:r,east:n,north:o}}=e.tile;return[new c.Z(e,{data:null,image:e.data,bounds:[t,r,n,o]})]}});return o.createElement(i.Z,{layers:[n],views:new a.Z({repeat:!0}),initialViewState:y,controller:!0,getTooltip:v},o.createElement("div",{style:m},"\xa9 ",o.createElement("a",{style:w,href:"http://www.openstreetmap.org/copyright",target:"blank"},"OpenStreetMap contributors")))}const A={},_="PMTiles",T={unversionedId:"pmtiles",id:"pmtiles",title:"PMTiles",description:"",source:"@site/src/examples/pmtiles.mdx",sourceDirName:".",slug:"/pmtiles",permalink:"/examples/pmtiles",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"examplesSidebar",previous:{title:"Geospatial",permalink:"/examples/geospatial"},next:{title:"WMS",permalink:"/examples/wms"}},R={},M=[],L={toc:M},E="wrapper";function C(e){let{components:t,...r}=e;return(0,s.kt)(E,(0,n.Z)({},L,r,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("h1",{id:"pmtiles"},"PMTiles"),(0,s.kt)("div",{style:{height:"100vh"}},(0,s.kt)(x,{mdxType:"Demo"})))}C.isMDXComponent=!0},54361:(e,t,r)=>{"use strict";r.d(t,{D0:()=>u,Ew:()=>c,Kn:()=>s,Lj:()=>l,Os:()=>d,Ss:()=>i,TW:()=>a,zH:()=>f});const n=e=>"boolean"==typeof e,o=e=>"function"==typeof e,s=e=>null!==e&&"object"==typeof e,i=e=>s(e)&&e.constructor==={}.constructor,a=e=>Boolean(e)&&"function"==typeof e[Symbol.iterator],u=e=>e&&"function"==typeof e[Symbol.asyncIterator],c=e=>"undefined"!=typeof Response&&e instanceof Response||e&&e.arrayBuffer&&e.text&&e.json,l=e=>"undefined"!=typeof Blob&&e instanceof Blob,f=e=>e&&"object"==typeof e&&e.isBuffer,d=e=>(e=>"undefined"!=typeof ReadableStream&&e instanceof ReadableStream||s(e)&&o(e.tee)&&o(e.cancel)&&o(e.getReader))(e)||(e=>s(e)&&o(e.read)&&o(e.pipe)&&n(e.readable))(e)},35889:(e,t,r)=>{"use strict";r.d(t,{z:()=>a});var n=r(54361),o=r(7386),s=r(61727),i=r(52291);async function a(e,t,r,a){let u,c;Array.isArray(t)||(0,o.C)(t)?(u=t,c=r):(u=[],c=t);const l=(0,s.b)(c);let f=e;return"string"==typeof e&&(f=await l(e)),(0,n.Lj)(e)&&(f=await l(e)),Array.isArray(u),await(0,i.Q)(f,u,c)}},52291:(e,t,r)=>{"use strict";r.d(t,{Q:()=>I});var n=r(56369);class o{terminate(){}}var s=r(67625);const i=new Map;function a(e){(0,s.h)(e.source&&!e.url||!e.source&&e.url);let t=i.get(e.source||e.url);return t||(e.url&&(t=function(e){if(!e.startsWith("http"))return e;return u((t=e,"try {\n  importScripts('"+t+"');\n} catch (error) {\n  console.error(error);\n  throw error;\n}"));var t}(e.url),i.set(e.url,t)),e.source&&(t=u(e.source),i.set(e.source,t))),(0,s.h)(t),t}function u(e){const t=new Blob([e],{type:"application/javascript"});return URL.createObjectURL(t)}function c(e,t,r){void 0===t&&(t=!0);const n=r||new Set;if(e){if(l(e))n.add(e);else if(l(e.buffer))n.add(e.buffer);else if(ArrayBuffer.isView(e));else if(t&&"object"==typeof e)for(const o in e)c(e[o],t,n)}else;return void 0===r?Array.from(n):[]}function l(e){return!!e&&(e instanceof ArrayBuffer||("undefined"!=typeof MessagePort&&e instanceof MessagePort||("undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas)))}const f=()=>{};class d{static isSupported(){return"undefined"!=typeof Worker&&n.jU||void 0!==o&&!n.jU}constructor(e){this.terminated=!1,this._loadableURL="";const{name:t,source:r,url:o}=e;(0,s.h)(r||o),this.name=t,this.source=r,this.url=o,this.onMessage=f,this.onError=e=>console.log(e),this.worker=n.jU?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=f,this.onError=f,this.worker.terminate(),this.terminated=!0}get isRunning(){return Boolean(this.onMessage)}postMessage(e,t){t=t||c(e),this.worker.postMessage(e,t)}_getErrorFromErrorEvent(e){let t="Failed to load ";return t+="worker "+this.name+" from "+this.url+". ",e.message&&(t+=e.message+" in "),e.lineno&&(t+=":"+e.lineno+":"+e.colno),new Error(t)}_createBrowserWorker(){this._loadableURL=a({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=e=>{e.data?this.onMessage(e.data):this.onError(new Error("No data received"))},e.onerror=e=>{this.onError(this._getErrorFromErrorEvent(e)),this.terminated=!0},e.onmessageerror=e=>console.error(e),e}_createNodeWorker(){let e;if(this.url){const t=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./"+this.url;e=new o(t,{eval:!1})}else{if(!this.source)throw new Error("no worker");e=new o(this.source,{eval:!0})}return e.on("message",(e=>{this.onMessage(e)})),e.on("error",(e=>{this.onError(e)})),e.on("exit",(e=>{})),e}}class h{constructor(e,t){this.isRunning=!0,this._resolve=()=>{},this._reject=()=>{},this.name=e,this.workerThread=t,this.result=new Promise(((e,t)=>{this._resolve=e,this._reject=t}))}postMessage(e,t){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:t})}done(e){(0,s.h)(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){(0,s.h)(this.isRunning),this.isRunning=!1,this._reject(e)}}class p{static isSupported(){return d.isSupported()}constructor(e){this.name="unnamed",this.maxConcurrency=1,this.maxMobileConcurrency=1,this.onDebug=()=>{},this.reuseWorkers=!0,this.props={},this.jobQueue=[],this.idleQueue=[],this.count=0,this.isDestroyed=!1,this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach((e=>e.destroy())),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},void 0!==e.name&&(this.name=e.name),void 0!==e.maxConcurrency&&(this.maxConcurrency=e.maxConcurrency),void 0!==e.maxMobileConcurrency&&(this.maxMobileConcurrency=e.maxMobileConcurrency),void 0!==e.reuseWorkers&&(this.reuseWorkers=e.reuseWorkers),void 0!==e.onDebug&&(this.onDebug=e.onDebug)}async startJob(e,t,r){void 0===t&&(t=(e,t,r)=>e.done(r)),void 0===r&&(r=(e,t)=>e.error(t));const n=new Promise((n=>(this.jobQueue.push({name:e,onMessage:t,onError:r,onStart:n}),this)));return this._startQueuedJob(),await n}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const t=this.jobQueue.shift();if(t){this.onDebug({message:"Starting job",name:t.name,workerThread:e,backlog:this.jobQueue.length});const r=new h(t.name,e);e.onMessage=e=>t.onMessage(r,e.type,e.payload),e.onError=e=>t.onError(r,e),t.onStart(r);try{await r.result}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){!n.jU||this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e=this.name.toLowerCase()+" (#"+this.count+" of "+this.maxConcurrency+")";return new d({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return n.tq?this.maxMobileConcurrency:this.maxConcurrency}}const g={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class y{static isSupported(){return d.isSupported()}static getWorkerFarm(e){return void 0===e&&(e={}),y._workerFarm=y._workerFarm||new y({}),y._workerFarm.setProps(e),y._workerFarm}constructor(e){this.workerPools=new Map,this.props={...g},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const t of this.workerPools.values())t.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:t,source:r,url:n}=e;let o=this.workerPools.get(t);return o||(o=new p({name:t,source:r,url:n}),o.setProps(this._getWorkerPoolProps()),this.workerPools.set(t,o)),o}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}var m=r(34329);async function w(e,t,r,o,i){const a=e.id,u=function(e,t){void 0===t&&(t={});const r=t[e.id]||{},o=n.jU?e.id+"-worker.js":e.id+"-worker-node.js";let i=r.workerUrl;if(i||"compression"!==e.id||(i=t.workerUrl),"test"===t._workerType&&(i="modules/"+e.module+"/dist/"+o),!i){let t=e.version;"latest"===t&&(t=m.e);const r=t?"@"+t:"";i="https://unpkg.com/@loaders.gl/"+e.module+r+"/dist/"+o}return(0,s.h)(i),i}(e,r),c=y.getWorkerFarm(r).getWorkerPool({name:a,url:u});r=JSON.parse(JSON.stringify(r)),o=JSON.parse(JSON.stringify(o||{}));const l=await c.startJob("process-on-worker",b.bind(null,i));l.postMessage("process",{input:t,options:r,context:o});const f=await l.result;return await f.result}async function b(e,t,r,n){switch(r){case"done":t.done(n);break;case"error":t.error(new Error(n.error));break;case"process":const{id:s,input:i,options:a}=n;try{const r=await e(i,a);t.postMessage("done",{id:s,result:r})}catch(o){const e=o instanceof Error?o.message:"unknown error";t.postMessage("error",{id:s,error:e})}break;default:console.warn("parse-with-worker unknown message "+r)}}var v=r(7386),k=r(54361),x=r(488),A=r(56525),_=r(78346);const T=262144;const R=262144;const M=1048576;var L=r(82282),E=r(7598);function C(e,t){return L.jU?async function*(e,t){const r=e.getReader();let n;try{for(;;){const e=n||r.read();null!=t&&t._streamReadAhead&&(n=r.read());const{done:o,value:s}=await e;if(o)return;yield(0,E.rJ)(s)}}catch(o){r.releaseLock()}}(e,t):async function*(e,t){for await(const r of e)yield(0,E.rJ)(r)}(e)}function U(e,t){if("string"==typeof e)return function*(e,t){const r=(null==t?void 0:t.chunkSize)||T;let n=0;const o=new TextEncoder;for(;n<e.length;){const t=Math.min(e.length-n,r),s=e.slice(n,n+t);n+=t,yield o.encode(s)}}(e,t);if(e instanceof ArrayBuffer)return function(e,t){return void 0===t&&(t={}),function*(){const{chunkSize:r=R}=t;let n=0;for(;n<e.byteLength;){const t=Math.min(e.byteLength-n,r),o=new ArrayBuffer(t),s=new Uint8Array(e,n,t);new Uint8Array(o).set(s),n+=t,yield o}}()}(e,t);if((0,k.Lj)(e))return async function*(e,t){const r=(null==t?void 0:t.chunkSize)||M;let n=0;for(;n<e.size;){const t=n+r,o=await e.slice(n,t).arrayBuffer();n=t,yield o}}(e,t);if((0,k.Os)(e))return C(e,t);if((0,k.Ew)(e)){return C(e.body,t)}throw new Error("makeIterator")}var j=r(46832);const S="Cannot convert supplied data type";async function B(e,t,r){const n=e instanceof ArrayBuffer||ArrayBuffer.isView(e);if("string"==typeof e||n)return function(e,t,r){if(t.text&&"string"==typeof e)return e;if((0,k.zH)(e)&&(e=e.buffer),e instanceof ArrayBuffer){const r=e;return t.text&&!t.binary?new TextDecoder("utf8").decode(r):r}if(ArrayBuffer.isView(e)){if(t.text&&!t.binary)return new TextDecoder("utf8").decode(e);let r=e.buffer;const n=e.byteLength||e.length;return 0===e.byteOffset&&n===r.byteLength||(r=r.slice(e.byteOffset,e.byteOffset+n)),r}throw new Error(S)}(e,t);if((0,k.Lj)(e)&&(e=await(0,j.L1)(e)),(0,k.Ew)(e)){const r=e;return await(0,j.mm)(r),t.binary?await r.arrayBuffer():await r.text()}if((0,k.Os)(e)&&(e=U(e,r)),(0,k.TW)(e)||(0,k.D0)(e))return(0,_.GZ)(e);throw new Error(S)}var O=r(61727),q=r(27346),D=r(80072);var P=r(86865),W=r(25939);async function I(e,t,r,o){!t||Array.isArray(t)||(0,v.C)(t)||(o=void 0,r=t,t=void 0),e=await e,r=r||{};const i=(0,P.vM)(e),a=function(e,t){if(e&&!Array.isArray(e))return e;let r;if(e&&(r=Array.isArray(e)?e:[e]),t&&t.loaders){const e=Array.isArray(t.loaders)?t.loaders:[t.loaders];r=r?[...r,...e]:e}return r&&r.length?r:void 0}(t,o),u=await(0,W.A)(e,a,r);return u?(o=function(e,t,r){if(r)return r;const n={fetch:(0,O.b)(t,e),...e};if(n.url){const e=(0,q.k)(n.url);n.baseUrl=e,n.queryString=(0,q.S)(n.url),n.filename=D.vB(e),n.baseUrl=D.XX(e)}return Array.isArray(n.loaders)||(n.loaders=null),n}({url:i,_parse:I,loaders:a},r=(0,x.GR)(r,u,a,i),o||null),await async function(e,t,r,o){if(function(e,t){void 0===t&&(t=m.q),(0,s.h)(e,"no worker provided");const r=e.version}(e),r=(0,A.N)(e.options,r),(0,k.Ew)(t)){const e=t,{ok:r,redirected:n,status:s,statusText:i,type:a,url:u}=e,c=Object.fromEntries(e.headers.entries());o.response={headers:c,ok:r,redirected:n,status:s,statusText:i,type:a,url:u}}t=await B(t,e,r);const i=e;if(i.parseTextSync&&"string"==typeof t)return i.parseTextSync(t,r,o);if(function(e,t){return!!y.isSupported()&&!!(n.jU||null!=t&&t._nodeWorkers)&&e.worker&&(null==t?void 0:t.worker)}(e,r))return await w(e,t,r,o,I);if(i.parseText&&"string"==typeof t)return await i.parseText(t,r,o);if(i.parse)return await i.parse(t,r,o);throw(0,s.h)(!i.parseSync),new Error(e.id+" loader - no parser found and worker is disabled")}(u,e,r,o)):null}},92859:(e,t,r)=>{"use strict";r.d(t,{fh:()=>i,kO:()=>a});var n=r(7386),o=r(488);const s=()=>{const e=(0,o.rx)();return e.loaderRegistry=e.loaderRegistry||[],e.loaderRegistry};function i(e){const t=s();e=Array.isArray(e)?e:[e];for(const r of e){const e=(0,n.T)(r);t.find((t=>e===t))||t.unshift(e)}}function a(){return s()}},25939:(e,t,r)=>{"use strict";r.d(t,{A:()=>d});var n=r(80072),o=r(28490),s=r(7386);const i=new(r(18686).Z)({id:"loaders.gl"});var a=r(86865),u=r(92859),c=r(54361),l=r(27346);const f=/\.([^.]+)$/;async function d(e,t,r,n){if(void 0===t&&(t=[]),!p(e))return null;let o=h(e,t,{...r,nothrow:!0},n);if(o)return o;if((0,c.Lj)(e)&&(o=h(e=await e.slice(0,10).arrayBuffer(),t,r,n)),!(o||null!=r&&r.nothrow))throw new Error(g(e));return o}function h(e,t,r,n){if(void 0===t&&(t=[]),!p(e))return null;if(t&&!Array.isArray(t))return(0,s.T)(t);let o=[];t&&(o=o.concat(t)),null!=r&&r.ignoreRegisteredLoaders||o.push(...(0,u.kO)()),function(e){for(const t of e)(0,s.T)(t)}(o);const c=function(e,t,r,n){const o=(0,a.vM)(e),s=(0,a.Ry)(e),u=(0,l.k)(o)||(null==n?void 0:n.url);let c=null,d="";null!=r&&r.mimeType&&(c=y(t,null==r?void 0:r.mimeType),d="match forced by supplied MIME type "+(null==r?void 0:r.mimeType));c=c||function(e,t){const r=t&&f.exec(t),n=r&&r[1];return n?function(e,t){t=t.toLowerCase();for(const r of e)for(const e of r.extensions)if(e.toLowerCase()===t)return r;return null}(e,n):null}(t,u),d=d||(c?"matched url "+u:""),c=c||y(t,s),d=d||(c?"matched MIME type "+s:""),c=c||function(e,t){if(!t)return null;for(const r of e)if("string"==typeof t){if(m(t,r))return r}else if(ArrayBuffer.isView(t)){if(w(t.buffer,t.byteOffset,r))return r}else if(t instanceof ArrayBuffer){if(w(t,0,r))return r}return null}(t,e),d=d||(c?"matched initial data "+b(e):""),null!=r&&r.fallbackMimeType&&(c=c||y(t,null==r?void 0:r.fallbackMimeType),d=d||(c?"matched fallback MIME type "+s:""));var h;d&&i.log(1,"selectLoader selected "+(null==(h=c)?void 0:h.name)+": "+d+".");return c}(e,o,r,n);if(!(c||null!=r&&r.nothrow))throw new Error(g(e));return c}function p(e){return!(e instanceof Response&&204===e.status)}function g(e){const t=(0,a.vM)(e),r=(0,a.Ry)(e);let o="No valid loader found (";o+=t?n.vB(t)+", ":"no url provided, ",o+="MIME type: "+(r?'"'+r+'"':"not provided")+", ";const s=e?b(e):"";return o+=s?' first bytes: "'+s+'"':"first bytes: not available",o+=")",o}function y(e,t){for(const r of e){if(r.mimeTypes&&r.mimeTypes.includes(t))return r;if(t==="application/x."+r.id)return r}return null}function m(e,t){if(t.testText)return t.testText(e);return(Array.isArray(t.tests)?t.tests:[t.tests]).some((t=>e.startsWith(t)))}function w(e,t,r){return(Array.isArray(r.tests)?r.tests:[r.tests]).some((r=>function(e,t,r,n){if(n instanceof ArrayBuffer)return(0,o.Xq)(n,e,n.byteLength);switch(typeof n){case"function":return n(e);case"string":return n===v(e,t,n.length);default:return!1}}(e,t,0,r)))}function b(e,t){if(void 0===t&&(t=5),"string"==typeof e)return e.slice(0,t);if(ArrayBuffer.isView(e))return v(e.buffer,e.byteOffset,t);if(e instanceof ArrayBuffer){return v(e,0,t)}return""}function v(e,t,r){if(e.byteLength<t+r)return"";const n=new DataView(e);let o="";for(let s=0;s<r;s++)o+=String.fromCharCode(n.getUint8(t+s));return o}},97737:(e,t,r)=>{"use strict";r.d(t,{dc:()=>i});var n=r(92730),o=r(46832),s=r(53829);async function i(e,t){if("string"==typeof e){const r=(0,n.i3)(e);return function(e){return!function(e){return e.startsWith("http:")||e.startsWith("https:")}(e)&&!function(e){return e.startsWith("data:")}(e)}(r)&&null!=s&&s.fetchFileNode?s.fetchFileNode(r,t):await fetch(r,t)}return await(0,o.L1)(e)}},61727:(e,t,r)=>{"use strict";r.d(t,{b:()=>i});var n=r(54361),o=r(97737),s=r(488);function i(e,t){const r=(0,s.pm)(),i=e||r;return"function"==typeof i.fetch?i.fetch:(0,n.Kn)(i.fetch)?e=>(0,o.dc)(e,i.fetch):null!=t&&t.fetch?null==t?void 0:t.fetch:o.dc}},7386:(e,t,r)=>{"use strict";r.d(t,{C:()=>o,T:()=>s});var n=r(61573);function o(e){var t;if(!e)return!1;Array.isArray(e)&&(e=e[0]);return Array.isArray(null==(t=e)?void 0:t.extensions)}function s(e){var t,r;let s;return(0,n.h)(e,"null loader"),(0,n.h)(o(e),"invalid loader"),Array.isArray(e)&&(s=e[1],e=e[0],e={...e,options:{...e.options,...s}}),(null!=(t=e)&&t.parseTextSync||null!=(r=e)&&r.parseText)&&(e.text=!0),e.text||(e.binary=!0),e}},488:(e,t,r)=>{"use strict";r.d(t,{pm:()=>l,rx:()=>c,GR:()=>f});var n=r(54361);const o=new(r(18686).Z)({id:"loaders.gl"});class s{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}var i=r(82282);const a={fetch:null,mimeType:void 0,nothrow:!1,log:new class{constructor(){this.console=console}log(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.console.log.bind(this.console,...t)}info(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.console.info.bind(this.console,...t)}warn(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.console.warn.bind(this.console,...t)}error(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.console.error.bind(this.console,...t)}},useLocalLibraries:!1,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:i.jU,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},u={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function c(){globalThis.loaders=globalThis.loaders||{};const{loaders:e}=globalThis;return e._state=e._state||{},e._state}function l(){const e=c();return e.globalOptions=e.globalOptions||{...a},e.globalOptions}function f(e,t,r,n){return r=r||[],function(e,t){d(e,null,a,u,t);for(const r of t){const n=e&&e[r.id]||{},o=r.options&&r.options[r.id]||{},s=r.deprecatedOptions&&r.deprecatedOptions[r.id]||{};d(n,r.id,o,s,t)}}(e,r=Array.isArray(r)?r:[r]),p(t,e,n)}function d(e,t,r,s,i){const a=t||"Top level",u=t?t+".":"";for(const c in e){const l=!t&&(0,n.Kn)(e[c]);if(!(c in r)&&!("baseUri"===c&&!t)&&!("workerUrl"===c&&t))if(c in s)o.warn(a+" loader option '"+u+c+"' no longer supported, use '"+s[c]+"'")();else if(!l){const e=h(c,i);o.warn(a+" loader option '"+u+c+"' not recognized. "+e)()}}}function h(e,t){const r=e.toLowerCase();let n="";for(const o of t)for(const t in o.options){if(e===t)return"Did you mean '"+o.id+"."+t+"'?";const s=t.toLowerCase();(r.startsWith(s)||s.startsWith(r))&&(n=n||"Did you mean '"+o.id+"."+t+"'?")}return n}function p(e,t,r){const n={...e.options||{}};return function(e,t){t&&!("baseUri"in e)&&(e.baseUri=t)}(n,r),null===n.log&&(n.log=new s),g(n,l()),g(n,t),n}function g(e,t){for(const r in t)if(r in t){const o=t[r];(0,n.Ss)(o)&&(0,n.Ss)(e[r])?e[r]={...e[r],...t[r]}:e[r]=t[r]}}},86865:(e,t,r)=>{"use strict";r.d(t,{Cu:()=>l,Ry:()=>c,vM:()=>u});var n=r(54361);const o=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,s=/^([-\w.]+\/[-\w.+]+)/;function i(e){const t=o.exec(e);return t?t[1]:""}var a=r(27346);function u(e){if((0,n.Ew)(e)){return e.url}if((0,n.Lj)(e)){return e.name||""}return"string"==typeof e?e:""}function c(e){if((0,n.Ew)(e)){const t=e,r=t.headers.get("content-type")||"",n=(0,a.k)(t.url);return function(e){const t=s.exec(e);return t?t[1]:e}(r)||i(n)}if((0,n.Lj)(e)){return e.type||""}return"string"==typeof e?i(e):""}function l(e){if((0,n.Ew)(e)){return e.headers["content-length"]||-1}if((0,n.Lj)(e)){return e.size}return"string"==typeof e?e.length:e instanceof ArrayBuffer||ArrayBuffer.isView(e)?e.byteLength:-1}},46832:(e,t,r)=>{"use strict";r.d(t,{L1:()=>s,mm:()=>i});var n=r(54361),o=r(86865);async function s(e){if((0,n.Ew)(e))return e;const t={},r=(0,o.Cu)(e);r>=0&&(t["content-length"]=String(r));const s=(0,o.vM)(e),i=(0,o.Ry)(e);i&&(t["content-type"]=i);const a=await async function(e){const t=5;if("string"==typeof e)return"data:,"+e.slice(0,t);if(e instanceof Blob){const t=e.slice(0,5);return await new Promise((e=>{const r=new FileReader;r.onload=t=>{var r;return e(null==t||null==(r=t.target)?void 0:r.result)},r.readAsDataURL(t)}))}if(e instanceof ArrayBuffer){return"data:base64,"+function(e){let t="";const r=new Uint8Array(e);for(let n=0;n<r.byteLength;n++)t+=String.fromCharCode(r[n]);return btoa(t)}(e.slice(0,t))}return null}(e);a&&(t["x-first-bytes"]=a),"string"==typeof e&&(e=(new TextEncoder).encode(e));const u=new Response(e,{headers:t});return Object.defineProperty(u,"url",{value:s}),u}async function i(e){if(!e.ok){const t=await async function(e){let t="Failed to fetch resource "+e.url+" ("+e.status+"): ";try{const r=e.headers.get("Content-Type");let n=e.statusText;r.includes("application/json")&&(n+=" "+await e.text()),t+=n,t=t.length>60?t.slice(0,60)+"...":t}catch(r){}return t}(e);throw new Error(t)}}},27346:(e,t,r)=>{"use strict";r.d(t,{S:()=>o,k:()=>s});const n=/\?.*/;function o(e){const t=e.match(n);return t&&t[0]}function s(e){return e.replace(n,"")}},87951:(e,t,r)=>{"use strict";r.d(t,{S:()=>i});const n="undefined"!=typeof __VERSION__?__VERSION__:"latest";var o=r(55100),s=r(98746);const i={id:"image",module:"images",name:"Images",version:n,mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],parse:o.e,tests:[e=>Boolean((0,s.I)(new DataView(e)))],options:{image:{type:"auto",decode:!0}}}},98746:(e,t,r)=>{"use strict";function n(e){return function(e,t,r){void 0===r&&(r=0);const n=(o=t,[...o].map((e=>e.charCodeAt(0))));var o;for(let s=0;s<n.length;++s)if(n[s]!==e[s+r])return!1;return!0}(e,"ftyp",4)?0==(96&e[8])?null:function(e){switch((t=e,r=8,n=12,String.fromCharCode(...t.slice(r,n))).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}var t,r,n}(e):null}r.d(t,{I:()=>i});const o=!1,s=!0;function i(e){const t=a(e);return function(e){const t=a(e),r=t.byteLength>=24&&2303741511===t.getUint32(0,o);if(!r)return null;return{mimeType:"image/png",width:t.getUint32(16,o),height:t.getUint32(20,o)}}(t)||function(e){const t=a(e),r=t.byteLength>=3&&65496===t.getUint16(0,o)&&255===t.getUint8(2);if(!r)return null;const{tableMarkers:n,sofMarkers:s}=function(){const e=new Set([65499,65476,65484,65501,65534]);for(let r=65504;r<65520;++r)e.add(r);const t=new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502]);return{tableMarkers:e,sofMarkers:t}}();let i=2;for(;i+9<t.byteLength;){const e=t.getUint16(i,o);if(s.has(e))return{mimeType:"image/jpeg",height:t.getUint16(i+5,o),width:t.getUint16(i+7,o)};if(!n.has(e))return null;i+=2,i+=t.getUint16(i,o)}return null}(t)||function(e){const t=a(e),r=t.byteLength>=10&&1195984440===t.getUint32(0,o);if(!r)return null;return{mimeType:"image/gif",width:t.getUint16(6,s),height:t.getUint16(8,s)}}(t)||function(e){const t=a(e),r=t.byteLength>=14&&16973===t.getUint16(0,o)&&t.getUint32(2,s)===t.byteLength;if(!r)return null;return{mimeType:"image/bmp",width:t.getUint32(18,s),height:t.getUint32(22,s)}}(t)||function(e){const t=new Uint8Array(e instanceof DataView?e.buffer:e),r=n(t);if(!r)return null;return{mimeType:r.mimeType,width:0,height:0}}(t)}function a(e){if(e instanceof DataView)return e;if(ArrayBuffer.isView(e))return new DataView(e.buffer);if(e instanceof ArrayBuffer)return new DataView(e);throw new Error("toDataView")}},74885:(e,t,r)=>{"use strict";function n(e){const t=i(e);if(!t)throw new Error("Not an image");return t}function o(e){return s(e)}function s(e){switch(n(e)){case"data":return e;case"image":case"imagebitmap":const t=document.createElement("canvas"),r=t.getContext("2d");if(!r)throw new Error("getImageData");return t.width=e.width,t.height=e.height,r.drawImage(e,0,0),r.getImageData(0,0,e.width,e.height);default:throw new Error("getImageData")}}function i(e){return"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?"imagebitmap":"undefined"!=typeof Image&&e instanceof Image?"image":e&&"object"==typeof e&&e.data&&e.width&&e.height?"data":null}r.d(t,{Ad:()=>o,n$:()=>s})},55100:(e,t,r)=>{"use strict";r.d(t,{e:()=>v});var n=r(61573),o=r(82282);const{_parseImageNode:s}=globalThis,i="undefined"!=typeof Image,a="undefined"!=typeof ImageBitmap,u=Boolean(s),c=!!o.jU||u;var l=r(74885);const f=/^data:image\/svg\+xml/,d=/\.svg((\?|#).*)?$/;function h(e){return e&&(f.test(e)||d.test(e))}function p(e,t){if(h(t))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(e)])}async function g(e,t,r){const n=function(e,t){if(h(t)){let t=(new TextDecoder).decode(e);try{"function"==typeof unescape&&"function"==typeof encodeURIComponent&&(t=unescape(encodeURIComponent(t)))}catch(r){throw new Error(r.message)}return"data:image/svg+xml;base64,"+btoa(t)}return p(e,t)}(e,r),o=self.URL||self.webkitURL,s="string"!=typeof n&&o.createObjectURL(n);try{return await async function(e,t){const r=new Image;if(r.src=e,t.image&&t.image.decode&&r.decode)return await r.decode(),r;return await new Promise(((t,n)=>{try{r.onload=()=>t(r),r.onerror=t=>n(new Error("Could not load image "+e+": "+t))}catch(o){n(o)}}))}(s||n,t)}finally{s&&o.revokeObjectURL(s)}}const y={};let m=!0;async function w(e,t,r){let n;if(h(r)){n=await g(e,t,r)}else n=p(e,r);const o=t&&t.imagebitmap;return await async function(e,t){void 0===t&&(t=null);!function(e){for(const t in e||y)return!1;return!0}(t)&&m||(t=null);if(t)try{return await createImageBitmap(e,t)}catch(r){console.warn(r),m=!1}return await createImageBitmap(e)}(n,o)}var b=r(98746);async function v(e,t,r){const o=((t=t||{}).image||{}).type||"auto",{url:s}=r||{};let u;switch(function(e){switch(e){case"auto":case"data":return function(){if(a)return"imagebitmap";if(i)return"image";if(c)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}();default:return function(e){switch(e){case"auto":return a||i||c;case"imagebitmap":return a;case"image":return i;case"data":return c;default:throw new Error("@loaders.gl/images: image "+e+" not supported in this environment")}}(e),e}}(o)){case"imagebitmap":u=await w(e,t,s);break;case"image":u=await g(e,t,s);break;case"data":u=await async function(e,t){const{mimeType:r}=(0,b.I)(e)||{},o=globalThis._parseImageNode;return(0,n.h)(o),await o(e,r)}(e);break;default:(0,n.h)(!1)}return"data"===o&&(u=(0,l.n$)(u)),u}},28490:(e,t,r)=>{"use strict";function n(e,t,r){if(r=r||e.byteLength,e.byteLength<r||t.byteLength<r)return!1;const n=new Uint8Array(e),o=new Uint8Array(t);for(let s=0;s<n.length;++s)if(n[s]!==o[s])return!1;return!0}function o(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const n=t.map((e=>e instanceof ArrayBuffer?new Uint8Array(e):e)),o=n.reduce(((e,t)=>e+t.byteLength),0),s=new Uint8Array(o);let i=0;for(const a of n)s.set(a,i),i+=a.byteLength;return s.buffer}function s(e,t,r){const n=void 0!==r?new Uint8Array(e).subarray(t,t+r):new Uint8Array(e).subarray(t);return new Uint8Array(n).buffer}r.d(t,{JY:()=>o,Xq:()=>n,qv:()=>s})},7598:(e,t,r)=>{"use strict";function n(e){if((t=e)&&"object"==typeof t&&t.isBuffer)return e;var t;if(e instanceof ArrayBuffer)return e;if(ArrayBuffer.isView(e))return 0===e.byteOffset&&e.byteLength===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);if("string"==typeof e){const t=e;return(new TextEncoder).encode(t).buffer}if(e&&"object"==typeof e&&e._toArrayBuffer)return e._toArrayBuffer();throw new Error("toArrayBuffer")}r.d(t,{rJ:()=>n})},61573:(e,t,r)=>{"use strict";function n(e,t){if(!e)throw new Error(t||"loader assertion failed.")}r.d(t,{h:()=>n})},82282:(e,t,r)=>{"use strict";r.d(t,{jU:()=>n});"undefined"!=typeof self&&self,"undefined"!=typeof window&&window,void 0!==r.g&&r.g,"undefined"!=typeof document&&document;const n=Boolean("object"!=typeof process||"[object process]"!==String(process)||process.browser),o="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version);o&&parseFloat(o[1])},78346:(e,t,r)=>{"use strict";r.d(t,{Ed:()=>o,GZ:()=>s});var n=r(28490);async function o(e,t){for(;;){const{done:r,value:n}=await e.next();if(r)return void e.return();if(t(n))return}}async function s(e){const t=[];for await(const r of e)t.push(r);return(0,n.JY)(...t)}},56525:(e,t,r)=>{"use strict";function n(e,t){return o(e||{},t)}function o(e,t){const r={...e};for(const[n,s]of Object.entries(t))s&&"object"==typeof s&&!Array.isArray(s)?r[n]=o(r[n]||{},t[n]):r[n]=t[n];return r}r.d(t,{N:()=>n})},92730:(e,t,r)=>{"use strict";r.d(t,{i3:()=>s});let n="";const o={};function s(e){for(const t in o)if(e.startsWith(t)){const r=o[t];e=e.replace(t,r)}return e.startsWith("http://")||e.startsWith("https://")||(e=""+n+e),e}},80072:(e,t,r)=>{"use strict";function n(){var e;if("undefined"!=typeof process&&void 0!==process.cwd)return process.cwd();const t=null==(e=window.location)?void 0:e.pathname;return(null==t?void 0:t.slice(0,t.lastIndexOf("/")+1))||""}function o(e){const t=e?e.lastIndexOf("/"):-1;return t>=0?e.substr(t+1):""}function s(e){const t=e?e.lastIndexOf("/"):-1;return t>=0?e.substr(0,t):""}function i(){const e=[];for(let n=0;n<arguments.length;n++)e[n]=n<0||arguments.length<=n?void 0:arguments[n];let t,r="",o=!1;for(let s=e.length-1;s>=-1&&!o;s--){let i;s>=0?i=e[s]:(void 0===t&&(t=n()),i=t),0!==i.length&&(r=i+"/"+r,o=i.charCodeAt(0)===a)}return r=function(e,t){let r,n="",o=-1,s=0,i=!1;for(let c=0;c<=e.length;++c){if(c<e.length)r=e.charCodeAt(c);else{if(r===a)break;r=a}if(r===a){if(o===c-1||1===s);else if(o!==c-1&&2===s){if(n.length<2||!i||n.charCodeAt(n.length-1)!==u||n.charCodeAt(n.length-2)!==u)if(n.length>2){const e=n.length-1;let t=e;for(;t>=0&&n.charCodeAt(t)!==a;--t);if(t!==e){n=-1===t?"":n.slice(0,t),o=c,s=0,i=!1;continue}}else if(2===n.length||1===n.length){n="",o=c,s=0,i=!1;continue}t&&(n.length>0?n+="/..":n="..",i=!0)}else{const t=e.slice(o+1,c);n.length>0?n+="/"+t:n=t,i=!1}o=c,s=0}else r===u&&-1!==s?++s:s=-1}return n}(r,!o),o?"/"+r:r.length>0?r:"."}r.d(t,{XX:()=>s,vB:()=>o,DB:()=>i});const a=47,u=46},41868:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var n=r(95328);const o={id:"request-scheduler",throttleRequests:!0,maxRequests:6};class s{constructor(e){void 0===e&&(e={}),this.activeRequestCount=0,this.requestQueue=[],this.requestMap=new Map,this.deferredUpdate=null,this.props={...o,...e},this.stats=new n.Z({id:this.props.id}),this.stats.get("Queued Requests"),this.stats.get("Active Requests"),this.stats.get("Cancelled Requests"),this.stats.get("Queued Requests Ever"),this.stats.get("Active Requests Ever")}scheduleRequest(e,t){if(void 0===t&&(t=()=>0),!this.props.throttleRequests)return Promise.resolve({done:()=>{}});if(this.requestMap.has(e))return this.requestMap.get(e);const r={handle:e,priority:0,getPriority:t},n=new Promise((e=>(r.resolve=e,r)));return this.requestQueue.push(r),this.requestMap.set(e,n),this._issueNewRequests(),n}_issueRequest(e){const{handle:t,resolve:r}=e;let n=!1;const o=()=>{n||(n=!0,this.requestMap.delete(t),this.activeRequestCount--,this._issueNewRequests())};return this.activeRequestCount++,r?r({done:o}):Promise.resolve({done:o})}_issueNewRequests(){this.deferredUpdate||(this.deferredUpdate=setTimeout((()=>this._issueNewRequestsAsync()),0))}_issueNewRequestsAsync(){this.deferredUpdate=null;const e=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(0!==e){this._updateAllRequests();for(let t=0;t<e;++t){const e=this.requestQueue.shift();e&&this._issueRequest(e)}}}_updateAllRequests(){const e=this.requestQueue;for(let t=0;t<e.length;++t){const r=e[t];this._updateRequest(r)||(e.splice(t,1),this.requestMap.delete(r.handle),t--)}e.sort(((e,t)=>e.priority-t.priority))}_updateRequest(e){return e.priority=e.getPriority(e.handle),!(e.priority<0)||(e.resolve(null),!1)}}},21970:(e,t,r)=>{"use strict";r.d(t,{o:()=>n});class n{constructor(e){this._needsRefresh=!0,this.props={...e},this.loadOptions={...e.loadOptions},this.fetch=function(e){const t=null==e?void 0:e.fetch;if(t&&"function"==typeof t)return(e,r)=>t(e,r);const r=null==e?void 0:e.fetch;if(r&&"function"!=typeof r)return e=>fetch(e,r);return e=>fetch(e)}(this.loadOptions)}setProps(e){this.props=Object.assign(this.props,e),this.setNeedsRefresh()}setNeedsRefresh(){this._needsRefresh=!0}getNeedsRefresh(e){void 0===e&&(e=!0);const t=this._needsRefresh;return e&&(this._needsRefresh=!1),t}}},67625:(e,t,r)=>{"use strict";function n(e,t){if(!e)throw new Error(t||"loaders.gl assertion failed.")}r.d(t,{h:()=>n})},56369:(e,t,r)=>{"use strict";r.d(t,{CO:()=>o,hJ:()=>i,jU:()=>s,tq:()=>a});const n={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:void 0!==r.g&&r.g,document:"undefined"!=typeof document&&document},o=n.global||n.self||n.window||{},s="object"!=typeof process||"[object process]"!==String(process)||process.browser,i="function"==typeof importScripts,a="undefined"!=typeof window&&void 0!==window.orientation,u="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version);u&&parseFloat(u[1])},34329:(e,t,r)=>{"use strict";r.d(t,{e:()=>n,q:()=>o});const n="beta";const o=(null!=(s=globalThis._loadersgl_)&&s.version||(globalThis._loadersgl_=globalThis._loadersgl_||{},"undefined"==typeof __VERSION__?(console.error("loaders.gl: The __VERSION__ variable is not injected using babel plugin. Latest unstable workers would be fetched from the CDN."),globalThis._loadersgl_.version=n):globalThis._loadersgl_.version=__VERSION__),globalThis._loadersgl_.version);var s},53829:()=>{}}]);