/*! For license information please see 4378.b0ca12ac.js.LICENSE.txt */
(self.webpackChunkproject_website=self.webpackChunkproject_website||[]).push([[4378],{80645:(t,e)=>{e.read=function(t,e,r,i,n){var s,o,a=8*n-i-1,h=(1<<a)-1,u=h>>1,f=-7,c=r?n-1:0,l=r?-1:1,d=t[e+c];for(c+=l,s=d&(1<<-f)-1,d>>=-f,f+=a;f>0;s=256*s+t[e+c],c+=l,f-=8);for(o=s&(1<<-f)-1,s>>=-f,f+=i;f>0;o=256*o+t[e+c],c+=l,f-=8);if(0===s)s=1-u;else{if(s===h)return o?NaN:1/0*(d?-1:1);o+=Math.pow(2,i),s-=u}return(d?-1:1)*o*Math.pow(2,s-i)},e.write=function(t,e,r,i,n,s){var o,a,h,u=8*s-n-1,f=(1<<u)-1,c=f>>1,l=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,d=i?0:s-1,p=i?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=f):(o=Math.floor(Math.log(e)/Math.LN2),e*(h=Math.pow(2,-o))<1&&(o--,h*=2),(e+=o+c>=1?l/h:l*Math.pow(2,1-c))*h>=2&&(o++,h/=2),o+c>=f?(a=0,o=f):o+c>=1?(a=(e*h-1)*Math.pow(2,n),o+=c):(a=e*Math.pow(2,c-1)*Math.pow(2,n),o=0));n>=8;t[r+d]=255&a,d+=p,a/=256,n-=8);for(o=o<<n|a,u+=n;u>0;t[r+d]=255&o,d+=p,o/=256,u-=8);t[r+d-p]|=128*g}},3614:(t,e,r)=>{"use strict";t.exports=n;var i=r(80645);function n(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}n.Varint=0,n.Fixed64=1,n.Bytes=2,n.Fixed32=5;var s=4294967296,o=1/s,a="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function h(t){return t.type===n.Bytes?t.readVarint()+t.pos:t.pos+1}function u(t,e,r){return r?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function f(t,e,r){var i=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));r.realloc(i);for(var n=r.pos-1;n>=t;n--)r.buf[n+i]=r.buf[n]}function c(t,e){for(var r=0;r<t.length;r++)e.writeVarint(t[r])}function l(t,e){for(var r=0;r<t.length;r++)e.writeSVarint(t[r])}function d(t,e){for(var r=0;r<t.length;r++)e.writeFloat(t[r])}function p(t,e){for(var r=0;r<t.length;r++)e.writeDouble(t[r])}function g(t,e){for(var r=0;r<t.length;r++)e.writeBoolean(t[r])}function w(t,e){for(var r=0;r<t.length;r++)e.writeFixed32(t[r])}function y(t,e){for(var r=0;r<t.length;r++)e.writeSFixed32(t[r])}function v(t,e){for(var r=0;r<t.length;r++)e.writeFixed64(t[r])}function b(t,e){for(var r=0;r<t.length;r++)e.writeSFixed64(t[r])}function x(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function m(t,e,r){t[r]=e,t[r+1]=e>>>8,t[r+2]=e>>>16,t[r+3]=e>>>24}function F(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}n.prototype={destroy:function(){this.buf=null},readFields:function(t,e,r){for(r=r||this.length;this.pos<r;){var i=this.readVarint(),n=i>>3,s=this.pos;this.type=7&i,t(n,e,this),this.pos===s&&this.skip(i)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=x(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=F(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=x(this.buf,this.pos)+x(this.buf,this.pos+4)*s;return this.pos+=8,t},readSFixed64:function(){var t=x(this.buf,this.pos)+F(this.buf,this.pos+4)*s;return this.pos+=8,t},readFloat:function(){var t=i.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=i.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,r,i=this.buf;return e=127&(r=i[this.pos++]),r<128?e:(e|=(127&(r=i[this.pos++]))<<7,r<128?e:(e|=(127&(r=i[this.pos++]))<<14,r<128?e:(e|=(127&(r=i[this.pos++]))<<21,r<128?e:function(t,e,r){var i,n,s=r.buf;if(n=s[r.pos++],i=(112&n)>>4,n<128)return u(t,i,e);if(n=s[r.pos++],i|=(127&n)<<3,n<128)return u(t,i,e);if(n=s[r.pos++],i|=(127&n)<<10,n<128)return u(t,i,e);if(n=s[r.pos++],i|=(127&n)<<17,n<128)return u(t,i,e);if(n=s[r.pos++],i|=(127&n)<<24,n<128)return u(t,i,e);if(n=s[r.pos++],i|=(1&n)<<31,n<128)return u(t,i,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(r=i[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&a?function(t,e,r){return a.decode(t.subarray(e,r))}(this.buf,e,t):function(t,e,r){var i="",n=e;for(;n<r;){var s,o,a,h=t[n],u=null,f=h>239?4:h>223?3:h>191?2:1;if(n+f>r)break;1===f?h<128&&(u=h):2===f?128==(192&(s=t[n+1]))&&(u=(31&h)<<6|63&s)<=127&&(u=null):3===f?(s=t[n+1],o=t[n+2],128==(192&s)&&128==(192&o)&&((u=(15&h)<<12|(63&s)<<6|63&o)<=2047||u>=55296&&u<=57343)&&(u=null)):4===f&&(s=t[n+1],o=t[n+2],a=t[n+3],128==(192&s)&&128==(192&o)&&128==(192&a)&&((u=(15&h)<<18|(63&s)<<12|(63&o)<<6|63&a)<=65535||u>=1114112)&&(u=null)),null===u?(u=65533,f=1):u>65535&&(u-=65536,i+=String.fromCharCode(u>>>10&1023|55296),u=56320|1023&u),i+=String.fromCharCode(u),n+=f}return i}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==n.Bytes)return t.push(this.readVarint(e));var r=h(this);for(t=t||[];this.pos<r;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==n.Bytes)return t.push(this.readSVarint());var e=h(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==n.Bytes)return t.push(this.readBoolean());var e=h(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==n.Bytes)return t.push(this.readFloat());var e=h(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==n.Bytes)return t.push(this.readDouble());var e=h(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==n.Bytes)return t.push(this.readFixed32());var e=h(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==n.Bytes)return t.push(this.readSFixed32());var e=h(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==n.Bytes)return t.push(this.readFixed64());var e=h(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==n.Bytes)return t.push(this.readSFixed64());var e=h(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===n.Varint)for(;this.buf[this.pos++]>127;);else if(e===n.Bytes)this.pos=this.readVarint()+this.pos;else if(e===n.Fixed32)this.pos+=4;else{if(e!==n.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var r=new Uint8Array(e);r.set(this.buf),this.buf=r,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),m(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),m(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),m(this.buf,-1&t,this.pos),m(this.buf,Math.floor(t*o),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),m(this.buf,-1&t,this.pos),m(this.buf,Math.floor(t*o),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var r,i;t>=0?(r=t%4294967296|0,i=t/4294967296|0):(i=~(-t/4294967296),4294967295^(r=~(-t%4294967296))?r=r+1|0:(r=0,i=i+1|0));if(t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,r){r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos]=127&t}(r,0,e),function(t,e){var r=(7&t)<<4;if(e.buf[e.pos++]|=r|((t>>>=3)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;e.buf[e.pos++]=127&t}(i,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,r){for(var i,n,s=0;s<e.length;s++){if((i=e.charCodeAt(s))>55295&&i<57344){if(!n){i>56319||s+1===e.length?(t[r++]=239,t[r++]=191,t[r++]=189):n=i;continue}if(i<56320){t[r++]=239,t[r++]=191,t[r++]=189,n=i;continue}i=n-55296<<10|i-56320|65536,n=null}else n&&(t[r++]=239,t[r++]=191,t[r++]=189,n=null);i<128?t[r++]=i:(i<2048?t[r++]=i>>6|192:(i<65536?t[r++]=i>>12|224:(t[r++]=i>>18|240,t[r++]=i>>12&63|128),t[r++]=i>>6&63|128),t[r++]=63&i|128)}return r}(this.buf,t,this.pos);var r=this.pos-e;r>=128&&f(e,r,this),this.pos=e-1,this.writeVarint(r),this.pos+=r},writeFloat:function(t){this.realloc(4),i.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),i.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var r=0;r<e;r++)this.buf[this.pos++]=t[r]},writeRawMessage:function(t,e){this.pos++;var r=this.pos;t(e,this);var i=this.pos-r;i>=128&&f(r,i,this),this.pos=r-1,this.writeVarint(i),this.pos+=i},writeMessage:function(t,e,r){this.writeTag(t,n.Bytes),this.writeRawMessage(e,r)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,c,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,l,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,g,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,d,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,p,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,w,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,y,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,v,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,b,e)},writeBytesField:function(t,e){this.writeTag(t,n.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,n.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,n.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,n.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,n.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,n.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,n.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,n.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,n.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,n.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}}},7725:(t,e,r)=>{"use strict";r.d(e,{PMTiles:()=>at,TileType:()=>tt});var i=r(25108),n=(t,e,r)=>new Promise(((i,n)=>{var s=t=>{try{a(r.next(t))}catch(e){n(e)}},o=t=>{try{a(r.throw(t))}catch(e){n(e)}},a=t=>t.done?i(t.value):Promise.resolve(t.value).then(s,o);a((r=r.apply(t,e)).next())})),s=Uint8Array,o=Uint16Array,a=Int32Array,h=new s([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),u=new s([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),f=new s([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),c=function(t,e){for(var r=new o(31),i=0;i<31;++i)r[i]=e+=1<<t[i-1];var n=new a(r[30]);for(i=1;i<30;++i)for(var s=r[i];s<r[i+1];++s)n[s]=s-r[i]<<5|i;return{b:r,r:n}},l=c(h,2),d=l.b,p=l.r;d[28]=258,p[258]=28;var g,w=c(u,0),y=w.b,v=(w.r,new o(32768));for(m=0;m<32768;++m)g=(61680&(g=(52428&(g=(43690&m)>>1|(21845&m)<<1))>>2|(13107&g)<<2))>>4|(3855&g)<<4,v[m]=((65280&g)>>8|(255&g)<<8)>>1;var b=function(t,e,r){for(var i=t.length,n=0,s=new o(e);n<i;++n)t[n]&&++s[t[n]-1];var a,h=new o(e);for(n=1;n<e;++n)h[n]=h[n-1]+s[n-1]<<1;if(r){a=new o(1<<e);var u=15-e;for(n=0;n<i;++n)if(t[n])for(var f=n<<4|t[n],c=e-t[n],l=h[t[n]-1]++<<c,d=l|(1<<c)-1;l<=d;++l)a[v[l]>>u]=f}else for(a=new o(i),n=0;n<i;++n)t[n]&&(a[n]=v[h[t[n]-1]++]>>15-t[n]);return a},x=new s(288);for(m=0;m<144;++m)x[m]=8;for(m=144;m<256;++m)x[m]=9;for(m=256;m<280;++m)x[m]=7;for(m=280;m<288;++m)x[m]=8;var m,F=new s(32);for(m=0;m<32;++m)F[m]=5;var M=b(x,9,1),V=b(F,5,1),D=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},U=function(t,e,r){var i=e/8|0;return(t[i]|t[i+1]<<8)>>(7&e)&r},B=function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(7&e)},T=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],S=function(t,e,r){var i=new Error(e||T[t]);if(i.code=t,Error.captureStackTrace&&Error.captureStackTrace(i,S),!r)throw i;return i},k=function(t,e,r,i){var n=t.length,o=i?i.length:0;if(!n||e.f&&!e.l)return r||new s(0);var a=!r||2!=e.i,c=e.i;r||(r=new s(3*n));var l=function(t){var e=r.length;if(t>e){var i=new s(Math.max(2*e,t));i.set(r),r=i}},p=e.f||0,g=e.p||0,w=e.b||0,v=e.l,x=e.d,m=e.m,F=e.n,T=8*n;do{if(!v){p=U(t,g,1);var k=U(t,g+1,3);if(g+=3,!k){var L=t[(N=4+((g+7)/8|0))-4]|t[N-3]<<8,P=N+L;if(P>n){c&&S(0);break}a&&l(w+L),r.set(t.subarray(N,P),w),e.b=w+=L,e.p=g=8*P,e.f=p;continue}if(1==k)v=M,x=V,m=9,F=5;else if(2==k){var E=U(t,g,31)+257,A=U(t,g+10,15)+4,C=E+U(t,g+5,31)+1;g+=14;for(var z=new s(C),O=new s(19),Z=0;Z<A;++Z)O[f[Z]]=U(t,g+3*Z,7);g+=3*A;var _=D(O),H=(1<<_)-1,I=b(O,_,1);for(Z=0;Z<C;){var N,j=I[U(t,g,H)];if(g+=15&j,(N=j>>4)<16)z[Z++]=N;else{var K=0,R=0;for(16==N?(R=3+U(t,g,3),g+=2,K=z[Z-1]):17==N?(R=3+U(t,g,7),g+=3):18==N&&(R=11+U(t,g,127),g+=7);R--;)z[Z++]=K}}var J=z.subarray(0,E),W=z.subarray(E);m=D(J),F=D(W),v=b(J,m,1),x=b(W,F,1)}else S(1);if(g>T){c&&S(0);break}}a&&l(w+131072);for(var q=(1<<m)-1,G=(1<<F)-1,$=g;;$=g){var Q=(K=v[B(t,g)&q])>>4;if((g+=15&K)>T){c&&S(0);break}if(K||S(2),Q<256)r[w++]=Q;else{if(256==Q){$=g,v=null;break}var X=Q-254;if(Q>264){var Y=h[Z=Q-257];X=U(t,g,(1<<Y)-1)+d[Z],g+=Y}var tt=x[B(t,g)&G],et=tt>>4;tt||S(3),g+=15&tt;W=y[et];if(et>3){Y=u[et];W+=B(t,g)&(1<<Y)-1,g+=Y}if(g>T){c&&S(0);break}a&&l(w+131072);var rt=w+X;if(w<W){var it=o-W,nt=Math.min(W,rt);for(it+w<0&&S(3);w<nt;++w)r[w]=i[it+w]}for(;w<rt;w+=4)r[w]=r[w-W],r[w+1]=r[w+1-W],r[w+2]=r[w+2-W],r[w+3]=r[w+3-W];w=rt}}e.l=v,e.p=$,e.b=w,e.f=p,v&&(p=1,e.m=m,e.d=x,e.n=F)}while(!p);return w==r.length?r:function(t,e,r){(null==e||e<0)&&(e=0),(null==r||r>t.length)&&(r=t.length);var i=new s(r-e);return i.set(t.subarray(e,r)),i}(r,0,w)},L=new s(0),P=function(t){31==t[0]&&139==t[1]&&8==t[2]||S(6,"invalid gzip data");var e=t[3],r=10;4&e&&(r+=2+(t[10]|t[11]<<8));for(var i=(e>>3&1)+(e>>4&1);i>0;i-=!t[r++]);return r+(2&e)},E=function(t){var e=t.length;return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0},A=function(t,e){return(8!=(15&t[0])||t[0]>>4>7||(t[0]<<8|t[1])%31)&&S(6,"invalid zlib data"),(t[1]>>5&1)==+!e&&S(6,"invalid zlib data: "+(32&t[1]?"need":"unexpected")+" dictionary"),2+(t[1]>>3&4)};function C(t,e){return 31==t[0]&&139==t[1]&&8==t[2]?function(t,e){var r=P(t);return r+8>t.length&&S(6,"invalid gzip data"),k(t.subarray(r,-8),{i:2},e&&e.out||new s(E(t)),e&&e.dictionary)}(t,e):8!=(15&t[0])||t[0]>>4>7||(t[0]<<8|t[1])%31?function(t,e){return k(t,{i:2},e&&e.out,e&&e.dictionary)}(t,e):function(t,e){return k(t.subarray(A(t,e&&e.dictionary),-4),{i:2},e&&e.out,e&&e.dictionary)}(t,e)}var z="undefined"!=typeof TextDecoder&&new TextDecoder;try{z.decode(L,{stream:!0}),1}catch(ht){}var O=(t,e)=>t*Math.pow(2,e),Z=(t,e)=>Math.floor(t/Math.pow(2,e)),_=(t,e)=>O(t.getUint16(e+1,!0),8)+t.getUint8(e),H=(t,e)=>O(t.getUint32(e+2,!0),16)+t.getUint16(e,!0),I=(t,e,r,i,n)=>{if(t!=i.getUint8(n))return t-i.getUint8(n);const s=_(i,n+1);if(e!=s)return e-s;const o=_(i,n+4);return r!=o?r-o:0},N=(t,e,r,i)=>{const n=j(t,e,r,i);return n?{z:e,x:r,y:i,offset:n[0],length:n[1],is_dir:!1}:null},j=(t,e,r,i)=>{let n=0,s=t.byteLength/17-1;for(;n<=s;){const o=s+n>>1,a=I(e,r,i,t,17*o);if(a>0)n=o+1;else{if(!(a<0))return[H(t,17*o+7),t.getUint32(17*o+13,!0)];s=o-1}}return null},K=(t,e)=>t.is_dir&&!e.is_dir?1:!t.is_dir&&e.is_dir?-1:t.z!==e.z?t.z-e.z:t.x!==e.x?t.x-e.x:t.y-e.y,R=(t,e)=>{const r=t.getUint8(17*e);return{z:127&r,x:_(t,17*e+1),y:_(t,17*e+4),offset:H(t,17*e+7),length:t.getUint32(17*e+13,!0),is_dir:r>>7==1}},J=t=>{const e=[],r=new DataView(t);for(let i=0;i<r.byteLength/17;i++)e.push(R(r,i));return W(e)},W=t=>{t.sort(K);const e=new ArrayBuffer(17*t.length),r=new Uint8Array(e);for(let i=0;i<t.length;i++){const e=t[i];let n=e.z;e.is_dir&&(n|=128),r[17*i]=n,r[17*i+1]=255&e.x,r[17*i+2]=e.x>>8&255,r[17*i+3]=e.x>>16&255,r[17*i+4]=255&e.y,r[17*i+5]=e.y>>8&255,r[17*i+6]=e.y>>16&255,r[17*i+7]=255&e.offset,r[17*i+8]=255&Z(e.offset,8),r[17*i+9]=255&Z(e.offset,16),r[17*i+10]=255&Z(e.offset,24),r[17*i+11]=255&Z(e.offset,32),r[17*i+12]=255&Z(e.offset,48),r[17*i+13]=255&e.length,r[17*i+14]=e.length>>8&255,r[17*i+15]=e.length>>16&255,r[17*i+16]=e.length>>24&255}return e};var q={getHeader:function(t){return n(this,null,(function*(){const e=yield t.getBytes(0,512e3),r=new DataView(e.data),i=r.getUint32(4,!0),n=r.getUint16(8,!0),s=new TextDecoder("utf-8"),o=JSON.parse(s.decode(new DataView(e.data,10,i)));let a=0;"gzip"===o.compression&&(a=2);let h=0;"minzoom"in o&&(h=+o.minzoom);let u=0;"maxzoom"in o&&(u=+o.maxzoom);let f=0,c=0,l=0,d=-180,p=-85,g=180,w=85;if(o.bounds){const t=o.bounds.split(",");d=+t[0],p=+t[1],g=+t[2],w=+t[3]}if(o.center){const t=o.center.split(",");f=+t[0],c=+t[1],l=+t[2]}return{specVersion:r.getUint16(2,!0),rootDirectoryOffset:10+i,rootDirectoryLength:17*n,jsonMetadataOffset:10,jsonMetadataLength:i,leafDirectoryOffset:0,leafDirectoryLength:void 0,tileDataOffset:0,tileDataLength:void 0,numAddressedTiles:0,numTileEntries:0,numTileContents:0,clustered:!1,internalCompression:1,tileCompression:a,tileType:1,minZoom:h,maxZoom:u,minLon:d,minLat:p,maxLon:g,maxLat:w,centerZoom:l,centerLon:f,centerLat:c,etag:e.etag}}))},getZxy:function(t,e,r,i,s,o,a){return n(this,null,(function*(){let n=yield r.getArrayBuffer(e,t.rootDirectoryOffset,t.rootDirectoryLength,t);1===t.specVersion&&(n=J(n));const h=N(new DataView(n),i,s,o);if(h){let t=(yield e.getBytes(h.offset,h.length,a)).data;const r=new DataView(t);return 31==r.getUint8(0)&&139==r.getUint8(1)&&(t=C(new Uint8Array(t))),{data:t}}const u=((t,e)=>{if(t.byteLength<17)return null;const r=t.byteLength/17,i=R(t,r-1);if(i.is_dir){const t=i.z,r=e.z-t;return{z:t,x:Math.trunc(e.x/(1<<r)),y:Math.trunc(e.y/(1<<r))}}return null})(new DataView(n),{z:i,x:s,y:o});if(u){const h=((t,e,r,i)=>{const n=j(t,128|e,r,i);return n?{z:e,x:r,y:i,offset:n[0],length:n[1],is_dir:!0}:null})(new DataView(n),u.z,u.x,u.y);if(h){let n=yield r.getArrayBuffer(e,h.offset,h.length,t);1===t.specVersion&&(n=J(n));const u=N(new DataView(n),i,s,o);if(u){let t=(yield e.getBytes(u.offset,u.length,a)).data;const r=new DataView(t);return 31==r.getUint8(0)&&139==r.getUint8(1)&&(t=C(new Uint8Array(t))),{data:t}}}}}))}};function G(t,e){return 4294967296*(e>>>0)+(t>>>0)}function $(t){const e=t.buf;let r,i;return i=e[t.pos++],r=127&i,i<128?r:(i=e[t.pos++],r|=(127&i)<<7,i<128?r:(i=e[t.pos++],r|=(127&i)<<14,i<128?r:(i=e[t.pos++],r|=(127&i)<<21,i<128?r:(i=e[t.pos],r|=(15&i)<<28,function(t,e){const r=e.buf;let i,n;if(n=r[e.pos++],i=(112&n)>>4,n<128)return G(t,i);if(n=r[e.pos++],i|=(127&n)<<3,n<128)return G(t,i);if(n=r[e.pos++],i|=(127&n)<<10,n<128)return G(t,i);if(n=r[e.pos++],i|=(127&n)<<17,n<128)return G(t,i);if(n=r[e.pos++],i|=(127&n)<<24,n<128)return G(t,i);if(n=r[e.pos++],i|=(1&n)<<31,n<128)return G(t,i);throw new Error("Expected varint not more than 10 bytes")}(r,t)))))}function Q(t,e,r,i){if(0==i){1==r&&(e[0]=t-1-e[0],e[1]=t-1-e[1]);const i=e[0];e[0]=e[1],e[1]=i}}var X=[0,1,5,21,85,341,1365,5461,21845,87381,349525,1398101,5592405,22369621,89478485,357913941,1431655765,5726623061,22906492245,91625968981,366503875925,1466015503701,5864062014805,23456248059221,93824992236885,375299968947541,0x5555555555555];function Y(t,e){return n(this,null,(function*(){if(1===e||0===e)return t;if(2===e){if(void 0===globalThis.DecompressionStream)return C(new Uint8Array(t));{let e=new Response(t).body.pipeThrough(new globalThis.DecompressionStream("gzip"));return new Response(e).arrayBuffer()}}throw Error("Compression method not supported")}))}var tt=(t=>(t[t.Unknown=0]="Unknown",t[t.Mvt=1]="Mvt",t[t.Png=2]="Png",t[t.Jpeg=3]="Jpeg",t[t.Webp=4]="Webp",t[t.Avif=5]="Avif",t))(tt||{});function et(t,e){let r=0,i=t.length-1;for(;r<=i;){const n=i+r>>1,s=e-t[n].tileId;if(s>0)r=n+1;else{if(!(s<0))return t[n];i=n-1}}if(i>=0){if(0===t[i].runLength)return t[i];if(e-t[i].tileId<t[i].runLength)return t[i]}return null}function rt(t,e){const r=t.getUint32(e+4,!0),i=t.getUint32(e+0,!0);return r*Math.pow(2,32)+i}function it(t){const e={buf:new Uint8Array(t),pos:0},r=$(e),i=[];let n=0;for(let s=0;s<r;s++){const t=$(e);i.push({tileId:n+t,offset:0,length:0,runLength:1}),n+=t}for(let s=0;s<r;s++)i[s].runLength=$(e);for(let s=0;s<r;s++)i[s].length=$(e);for(let s=0;s<r;s++){const t=$(e);i[s].offset=0===t&&s>0?i[s-1].offset+i[s-1].length:t-1}return i}var nt=class extends Error{};function st(t,e,r,s){return n(this,null,(function*(){const n=yield t.getBytes(0,16384);if(19792!==new DataView(n.data).getUint16(0,!0))throw new Error("Wrong magic number for PMTiles archive");if(function(t){const e=new DataView(t);return 2===e.getUint16(2,!0)?(i.warn("PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),2):1===e.getUint16(2,!0)?(i.warn("PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),1):3}(n.data)<3)return[yield q.getHeader(t)];const o=n.data.slice(0,127);let a=n.etag;s&&n.etag!=s&&(i.warn("ETag conflict detected; your HTTP server might not support content-based ETag headers. ETags disabled for "+t.getKey()),a=void 0);const h=function(t,e){const r=new DataView(t),i=r.getUint8(7);if(i>3)throw Error(`Archive is spec version ${i} but this library supports up to spec version 3`);return{specVersion:i,rootDirectoryOffset:rt(r,8),rootDirectoryLength:rt(r,16),jsonMetadataOffset:rt(r,24),jsonMetadataLength:rt(r,32),leafDirectoryOffset:rt(r,40),leafDirectoryLength:rt(r,48),tileDataOffset:rt(r,56),tileDataLength:rt(r,64),numAddressedTiles:rt(r,72),numTileEntries:rt(r,80),numTileContents:rt(r,88),clustered:1===r.getUint8(96),internalCompression:r.getUint8(97),tileCompression:r.getUint8(98),tileType:r.getUint8(99),minZoom:r.getUint8(100),maxZoom:r.getUint8(101),minLon:r.getInt32(102,!0)/1e7,minLat:r.getInt32(106,!0)/1e7,maxLon:r.getInt32(110,!0)/1e7,maxLat:r.getInt32(114,!0)/1e7,centerZoom:r.getUint8(118),centerLon:r.getInt32(119,!0)/1e7,centerLat:r.getInt32(123,!0)/1e7,etag:e}}(o,a);if(r){const r=n.data.slice(h.rootDirectoryOffset,h.rootDirectoryOffset+h.rootDirectoryLength),i=t.getKey()+"|"+(h.etag||"")+"|"+h.rootDirectoryOffset+"|"+h.rootDirectoryLength,s=it(yield e(r,h.internalCompression));return[h,[i,s.length,s]]}return[h,void 0]}))}function ot(t,e,r,i,s){return n(this,null,(function*(){const n=yield t.getBytes(r,i);if(s.etag&&s.etag!==n.etag)throw new nt(n.etag);const o=it(yield e(n.data,s.internalCompression));if(0===o.length)throw new Error("Empty directory is invalid");return o}))}var at=class{constructor(t,e,r){this.source="string"==typeof t?new class{constructor(t){this.url=t}getKey(){return this.url}getBytes(t,e,r){return n(this,null,(function*(){let i;r||(i=new AbortController,r=i.signal);let n=yield fetch(this.url,{signal:r,headers:{Range:"bytes="+t+"-"+(t+e-1)}});if(416===n.status&&0===t){const t=n.headers.get("Content-Range");if(!t||!t.startsWith("bytes */"))throw Error("Missing content-length on 416 response");const e=+t.substr(8);n=yield fetch(this.url,{signal:r,headers:{Range:"bytes=0-"+(e-1)}})}if(n.status>=300)throw Error("Bad response code: "+n.status);const s=n.headers.get("Content-Length");if(200===n.status&&(!s||+s>e))throw i&&i.abort(),Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield n.arrayBuffer(),etag:n.headers.get("ETag")||void 0,cacheControl:n.headers.get("Cache-Control")||void 0,expires:n.headers.get("Expires")||void 0}}))}}(t):t,this.decompress=r||Y,this.cache=e||new class{constructor(t=100,e=!0,r=Y){this.cache=new Map,this.maxCacheEntries=t,this.counter=1,this.prefetch=e,this.decompress=r}getHeader(t,e){return n(this,null,(function*(){const r=t.getKey();if(this.cache.has(r))return this.cache.get(r).lastUsed=this.counter++,yield this.cache.get(r).data;const i=new Promise(((r,i)=>{st(t,this.decompress,this.prefetch,e).then((t=>{t[1]&&this.cache.set(t[1][0],{lastUsed:this.counter++,data:Promise.resolve(t[1][2])}),r(t[0]),this.prune()})).catch((t=>{i(t)}))}));return this.cache.set(r,{lastUsed:this.counter++,data:i}),i}))}getDirectory(t,e,r,i){return n(this,null,(function*(){const n=t.getKey()+"|"+(i.etag||"")+"|"+e+"|"+r;if(this.cache.has(n))return this.cache.get(n).lastUsed=this.counter++,yield this.cache.get(n).data;const s=new Promise(((n,s)=>{ot(t,this.decompress,e,r,i).then((t=>{n(t),this.prune()})).catch((t=>{s(t)}))}));return this.cache.set(n,{lastUsed:this.counter++,data:s}),s}))}getArrayBuffer(t,e,r,i){return n(this,null,(function*(){const n=t.getKey()+"|"+(i.etag||"")+"|"+e+"|"+r;if(this.cache.has(n))return this.cache.get(n).lastUsed=this.counter++,yield this.cache.get(n).data;const s=new Promise(((s,o)=>{t.getBytes(e,r).then((t=>{if(i.etag&&i.etag!==t.etag)throw new nt(t.etag);s(t.data),this.cache.has(n),this.prune()})).catch((t=>{o(t)}))}));return this.cache.set(n,{lastUsed:this.counter++,data:s}),s}))}prune(){if(this.cache.size>=this.maxCacheEntries){let t,e=1/0;this.cache.forEach(((r,i)=>{r.lastUsed<e&&(e=r.lastUsed,t=i)})),t&&this.cache.delete(t)}}invalidate(t,e){return n(this,null,(function*(){this.cache.delete(t.getKey()),yield this.getHeader(t,e)}))}}}getHeader(){return n(this,null,(function*(){return yield this.cache.getHeader(this.source)}))}getZxyAttempt(t,e,r,i){return n(this,null,(function*(){const n=function(t,e,r){if(t>26)throw Error("Tile zoom level exceeds max safe number limit (26)");if(e>Math.pow(2,t)-1||r>Math.pow(2,t)-1)throw Error("tile x/y outside zoom level bounds");const i=X[t];let n=0,s=0,o=0;const a=[e,r];let h=Math.pow(2,t)/2;for(;h>0;)n=(a[0]&h)>0?1:0,s=(a[1]&h)>0?1:0,o+=h*h*(3*n^s),Q(h,a,n,s),h/=2;return i+o}(t,e,r),s=yield this.cache.getHeader(this.source);if(s.specVersion<3)return q.getZxy(s,this.source,this.cache,t,e,r,i);if(t<s.minZoom||t>s.maxZoom)return;let o=s.rootDirectoryOffset,a=s.rootDirectoryLength;for(let t=0;t<=3;t++){const t=et(yield this.cache.getDirectory(this.source,o,a,s),n);if(!t)return;if(t.runLength>0){const e=yield this.source.getBytes(s.tileDataOffset+t.offset,t.length,i);if(s.etag&&s.etag!==e.etag)throw new nt(e.etag);return{data:yield this.decompress(e.data,s.tileCompression),cacheControl:e.cacheControl,expires:e.expires}}o=s.leafDirectoryOffset+t.offset,a=t.length}throw Error("Maximum directory depth exceeded")}))}getZxy(t,e,r,i){return n(this,null,(function*(){try{return yield this.getZxyAttempt(t,e,r,i)}catch(ht){if(ht instanceof nt)return this.cache.invalidate(this.source,ht.message),yield this.getZxyAttempt(t,e,r,i);throw ht}}))}getMetadataAttempt(){return n(this,null,(function*(){const t=yield this.cache.getHeader(this.source),e=yield this.source.getBytes(t.jsonMetadataOffset,t.jsonMetadataLength);if(t.etag&&t.etag!==e.etag)throw new nt(e.etag);const r=yield this.decompress(e.data,t.internalCompression),i=new TextDecoder("utf-8");return JSON.parse(i.decode(r))}))}getMetadata(){return n(this,null,(function*(){try{return yield this.getMetadataAttempt()}catch(ht){if(ht instanceof nt)return this.cache.invalidate(this.source,ht.message),yield this.getMetadataAttempt();throw ht}}))}}}}]);