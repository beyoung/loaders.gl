"use strict";(self.webpackChunkproject_website=self.webpackChunkproject_website||[]).push([[1747],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>f});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},d=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},c="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,d=o(e,["components","mdxType","originalType","parentName"]),c=p(n),m=r,f=c["".concat(s,".").concat(m)]||c[m]||u[m]||i;return n?a.createElement(f,l(l({ref:t},d),{},{components:n})):a.createElement(f,l({ref:t},d))}));function f(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,l=new Array(i);l[0]=m;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o[c]="string"==typeof e?e:r,l[1]=o;for(var p=2;p<i;p++)l[p]=n[p];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},7140:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>u,frontMatter:()=>i,metadata:()=>o,toc:()=>p});var a=n(87462),r=(n(67294),n(3905));const i={},l="fetchFile",o={unversionedId:"modules/core/api-reference/fetch-file",id:"modules/core/api-reference/fetch-file",title:"fetchFile",description:"The fetchFile() function is an alternative to the built-in",source:"@site/../docs/modules/core/api-reference/fetch-file.md",sourceDirName:"modules/core/api-reference",slug:"/modules/core/api-reference/fetch-file",permalink:"/docs/modules/core/api-reference/fetch-file",draft:!1,editUrl:"https://github.com/visgl/loaders.gl/tree/master/website/../docs/modules/core/api-reference/fetch-file.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"save",permalink:"/docs/modules/core/api-reference/save"},next:{title:"writeFile",permalink:"/docs/modules/core/api-reference/write-file"}},s={},p=[{value:"Node.js local file system support",id:"nodejs-local-file-system-support",level:2},{value:"Path prefix resolution",id:"path-prefix-resolution",level:2},{value:"Alias resolution",id:"alias-resolution",level:2},{value:"Usage",id:"usage",level:2},{value:"Functions",id:"functions",level:2},{value:"Remarks",id:"remarks",level:2}],d={toc:p},c="wrapper";function u(e){let{components:t,...n}=e;return(0,r.kt)(c,(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"fetchfile"},"fetchFile"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"fetchFile()")," function is an alternative to the built-in\n",(0,r.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/API/fetch"},(0,r.kt)("inlineCode",{parentName:"a"},"fetch"))," function.\n",(0,r.kt)("inlineCode",{parentName:"p"},"fetchFile")," provides additional functionality to support Node.js and testing use cases:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"load from local file system under Node.js"),(0,r.kt)("li",{parentName:"ul"},"path prefix resolution"),(0,r.kt)("li",{parentName:"ul"},"alias resolution")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"fetchFile(url: string | Blob, options?: RequestInit) : Promise<Response>\n")),(0,r.kt)("p",null,"A wrapper around the platform  function with some additions:"),(0,r.kt)("p",null,"Returns:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"A promise that resolves into a fetch ",(0,r.kt)("a",{parentName:"li",href:"https://developer.mozilla.org/en-US/docs/Web/API/Response"},(0,r.kt)("inlineCode",{parentName:"a"},"Response"))," object",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"headers"),": ",(0,r.kt)("inlineCode",{parentName:"li"},"Headers")," - A ",(0,r.kt)("a",{parentName:"li",href:"https://developer.mozilla.org/en-US/docs/Web/API/Headers"},(0,r.kt)("inlineCode",{parentName:"a"},"Headers"))," object."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"arrayBuffer()"),": Promise.ArrayBuffer",(0,r.kt)("inlineCode",{parentName:"li"},"- Loads the file as an"),"ArrayBuffer`."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"text()"),": Promise.String` - Loads the file and decodes it into text."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"json()"),": Promise.String` - Loads the file and decodes it into JSON."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"body")," : ReadableStream` - A stream that can be used to incrementally read the contents of the file.")))),(0,r.kt)("p",null,"::info\nUse of ",(0,r.kt)("inlineCode",{parentName:"p"},"fetchFile")," is optional. loaders.gl ",(0,r.kt)("inlineCode",{parentName:"p"},"parse()")," function can be used with data loaded via any mechanism the application prefers, e.g. directly using ",(0,r.kt)("inlineCode",{parentName:"p"},"fetch"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"XMLHttpRequest")," etc.\n::"),(0,r.kt)("h2",{id:"nodejs-local-file-system-support"},"Node.js local file system support"),(0,r.kt)("p",{class:"badges"},(0,r.kt)("img",{src:"https://img.shields.io/badge/From-v4.0-blue.svg?style=flat-square",alt:"From-v4.0"})),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"fetchFile()")," function supports fetching data from the local file system under Node.js."),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"fetchFile")," will delegate any url that starts with ",(0,r.kt)("inlineCode",{parentName:"p"},"http://")," ",(0,r.kt)("inlineCode",{parentName:"p"},"https://")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"data://"),"\nto the built-in ",(0,r.kt)("inlineCode",{parentName:"p"},"fetch")," function. Other URLs will be interpreted as local files."),(0,r.kt)("p",null,"::caution\nloaders.gl v4.0+ applications no longer need to install the ",(0,r.kt)("inlineCode",{parentName:"p"},"@loaders.gl/polyfills"),"\nmodule to get ",(0,r.kt)("inlineCode",{parentName:"p"},"fetch")," support under Node.js v18+.\n::"),(0,r.kt)("h2",{id:"path-prefix-resolution"},"Path prefix resolution"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"fetchFile()")," injects any prefix set by the ",(0,r.kt)("inlineCode",{parentName:"p"},"setPathPrefix()")," API.\nNote that the path prefix mechanism is mainly intended to help small example applications\nto load data from the right place. It is not intended to support general application use cases, so use sparingly."),(0,r.kt)("h2",{id:"alias-resolution"},"Alias resolution"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"fetchFile()")," also resolves any aliases set by the ",(0,r.kt)("inlineCode",{parentName:"p"},"_addAliases")," function. This internal\nfunctionality is mainly intended for and used by loaders.gl own test cases, to allow paths\nto test data file to be specified in terms of which loaders.gl module they are located in."),(0,r.kt)("h2",{id:"usage"},"Usage"),(0,r.kt)("p",null,"Use the ",(0,r.kt)("inlineCode",{parentName:"p"},"fetchFile")," function as follows:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"import {fetchFile} from '@loaders.gl/core';\n\nconst response = await fetchFile(url);\n// or supply any standard `RequestInit` options expected by `fetch`\nconst response = await fetchFile(url, {headers: {}});\n\n// Now use standard browser Response APIs\n\n// Note: headers are case-insensitive\nconst contentLength = response.headers.get('content-length');\nconst mimeType = response.headers.get('content-type');\n\nconst arrayBuffer = await response.arrayBuffer();\n")),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"Response")," object from ",(0,r.kt)("inlineCode",{parentName:"p"},"fetchFile")," is usually passed to ",(0,r.kt)("inlineCode",{parentName:"p"},"parse")," as follows:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"import {fetchFile, parse} from '@loaders.gl/core';\nimport {OBJLoader} from '@loaders.gl/obj';\n\nconst data = await parse(fetchFile(url), OBJLoader);\n")),(0,r.kt)("p",null,"Note that if you don't need the extra features in ",(0,r.kt)("inlineCode",{parentName:"p"},"fetchFile"),", you can just use the browsers built-in ",(0,r.kt)("inlineCode",{parentName:"p"},"fetch")," method."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"import {parse} from '@loaders.gl/core';\nimport {OBJLoader} from '@loaders.gl/obj';\n\nconst data = await parse(fetch(url), OBJLoader);\n")),(0,r.kt)("h2",{id:"functions"},"Functions"),(0,r.kt)("h2",{id:"remarks"},"Remarks"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"fetch")," is supported in Node.js from v18+."),(0,r.kt)("li",{parentName:"ul"},"For ",(0,r.kt)("inlineCode",{parentName:"li"},"string")," URLs - ",(0,r.kt)("inlineCode",{parentName:"li"},"fetchFile")," will delegate to ",(0,r.kt)("inlineCode",{parentName:"li"},"fetch")," after resolving the URL."),(0,r.kt)("li",{parentName:"ul"},"For ",(0,r.kt)("inlineCode",{parentName:"li"},"File"),"/",(0,r.kt)("inlineCode",{parentName:"li"},"Blob")," - a ",(0,r.kt)("inlineCode",{parentName:"li"},"Response")," object will be returned. Any ",(0,r.kt)("inlineCode",{parentName:"li"},"RequestInit")," options are ignored in this case."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Response.headers")," (",(0,r.kt)("inlineCode",{parentName:"li"},"Content-Length")," and ",(0,r.kt)("inlineCode",{parentName:"li"},"Content-Type"),") are populated (on a best effort basis for ",(0,r.kt)("inlineCode",{parentName:"li"},"File"),", ",(0,r.kt)("inlineCode",{parentName:"li"},"Blob")," and under Node.js)."),(0,r.kt)("li",{parentName:"ul"},"Supports ",(0,r.kt)("inlineCode",{parentName:"li"},"setPathPrefix"),": If path prefix has been set, it will be appended if ",(0,r.kt)("inlineCode",{parentName:"li"},"url")," is relative (e.g. does not start with a ",(0,r.kt)("inlineCode",{parentName:"li"},"/"),")."),(0,r.kt)("li",{parentName:"ul"},"Supports ",(0,r.kt)("inlineCode",{parentName:"li"},"File")," and ",(0,r.kt)("inlineCode",{parentName:"li"},"Blob"),' objects on the browser (and returns "mock" fetch response objects).')))}u.isMDXComponent=!0}}]);