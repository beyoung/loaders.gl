(self.webpackChunkproject_website=self.webpackChunkproject_website||[]).push([[7054],{52278:(e,t,n)=>{"use strict";n.d(t,{i5:()=>qe,ZP:()=>$e});var r=n(87462),i=n(67294),s=n(73935),o=n(19521),a=n(33545),l=n(24613),c=n.n(l),u=n(8977),d=n(66883),h=n(24009),f=n(56497),A=n(77045),p=n(24088),m=n(98794),C=n(81547);const g="3DObject";function B(e,t){let n=[];for(let i=0;i<e.length;i++){var r;const s=e[i],{id:o,layerType:a,visibility:l=!0,...c}=s;if(a===g){const e=t+"/sublayers/"+o;n.push({url:e,id:o,layerType:a,visibility:l,...c})}null!=s&&null!=(r=s.sublayers)&&r.length&&(n=[...n,...B(s.sublayers,t)])}return n}const _={name:"I3S Building Scene Layer",id:"i3s-building-scene-layer",module:"i3s",version:"undefined"!=typeof __VERSION__?__VERSION__:"beta",mimeTypes:["application/json"],parse:async function(e,t,n){if(null==n||!n.url)throw new Error("Url is not provided");return async function(e,t){const n=JSON.parse((new TextDecoder).decode(e)),{sublayers:r}=n;return{header:n,sublayers:B(r,t)}}(e,n.url)},extensions:["json"],options:{}};var y=n(36701),E=n(35889),T=n(77035),b=n(25108);function S(e,t){switch(e){case T.T4:return function(e){const t=0,n=8,r=4,i=[];try{const s=new DataView(e,t,r).getUint32(t,!0),o=new Uint32Array(e,n,s);let a=n+s*r;for(const t of o){const n=new TextDecoder("utf-8"),r=new Uint8Array(e,a,t);i.push(n.decode(r)),a+=t}}catch(s){b.error("Parse string attribute error: ",s.message)}return i}(t);case T.xf:return w(t);case T.LU:return function(e){return new Float64Array(e,8)}(t);case T.OA:return function(e){return new Int16Array(e,4)}(t);default:return w(t)}}function w(e){return new Uint32Array(e,4)}var R=n(51779);const I="undefined"!=typeof __VERSION__?__VERSION__:"latest",D="",v="rejected",O={name:"I3S Attribute",id:"i3s-attribute",module:"i3s",version:I,mimeTypes:["application/binary"],parse:async(e,t)=>function(e,t){const{attributeName:n,attributeType:r}=t;return n?{[n]:r?S(r,e):null}:{}}(e,t),extensions:["bin"],options:{},binary:!0};async function G(e,t,n){void 0===n&&(n={});const{attributeStorageInfo:r,attributeUrls:i,tilesetFields:s}=function(e){var t,n,r,i,s;const o=null==(t=e.tileset)||null==(n=t.tileset)?void 0:n.attributeStorageInfo,a=null==(r=e.header)?void 0:r.attributeUrls,l=(null==(i=e.tileset)||null==(s=i.tileset)?void 0:s.fields)||[];return{attributeStorageInfo:o,attributeUrls:a,tilesetFields:l}}(e);if(!r||!i||t<0)return null;let o=[];const a=[];for(let u=0;u<r.length;u++){var l;const e=(0,R.DA)(i[u],null==(l=n.i3s)?void 0:l.token),t=r[u].name,s=M(r[u]),o={...n,attributeName:t,attributeType:s},c=(0,E.z)(e,O,o);a.push(c)}try{o=await Promise.allSettled(a)}catch(c){}return o.length?function(e,t,n,r){const i=function(e){const t=e.find((e=>e.name.includes("OBJECTID")));return null==t?void 0:t.name}(t),s=e.find((e=>e.value[i]));if(!s)return null;const o=s.value[i].indexOf(n);if(o<0)return null;return function(e,t,n,r){const i={};for(let s=0;s<n.length;s++){const o=n[s].name,a=x(o,r),l=N(e,s,o);i[o]=F(l,t,a)}return i}(e,o,t,r)}(o,r,t,s):null}function M(e){return e.hasOwnProperty("objectIds")?"Oid32":e.hasOwnProperty("attributeValues")?e.attributeValues.valueType:""}function x(e,t){var n;const r=t.find((t=>t.name===e||t.alias===e));return(null==r||null==(n=r.domain)?void 0:n.codedValues)||[]}function N(e,t,n){const r=e[t];return r.status===v?null:r.value[n]}function F(e,t,n){let r=D;if(e&&t in e&&(r=String(e[t]).replace(/\u0000|NaN/g,"").trim()),n.length){const e=n.find((e=>e.code===Number(r)));r=(null==e?void 0:e.name)||D}return r}var P=n(33562),L=n(49835),U=n(97737),H=n(45697),J=n.n(H);const X={Light:"https://basemaps.cartocdn.com/gl/positron-nolabels-gl-style/style.json",Dark:"https://basemaps.cartocdn.com/gl/dark-matter-nolabels-gl-style/style.json"},j=X.Dark,k={height:600,width:800,pitch:45,maxPitch:60,bearing:0,minZoom:2,maxZoom:30,zoom:14.5},K="San Francisco v1.7",V={"San Francisco v1.6":{name:"San Francisco v1.6",url:"https://tiles.arcgis.com/tiles/z2tnIkrLQ2BRzr6P/arcgis/rest/services/SanFrancisco_Bldgs/SceneServer/layers/0",viewport:{...k,longitude:-120,latitude:34}},"San Francisco v1.7":{name:"San Francisco v1.7",url:"https://tiles.arcgis.com/tiles/z2tnIkrLQ2BRzr6P/arcgis/rest/services/SanFrancisco_3DObjects_1_7/SceneServer/layers/0",viewport:{...k,longitude:-120,latitude:34}},"New York":{name:"New York",url:"https://tiles.arcgis.com/tiles/P3ePLMYs2RVChkJx/arcgis/rest/services/Buildings_NewYork_17/SceneServer/layers/0",viewport:{...k,longitude:-74,latitude:40}},Building:{name:"Building",url:"https://tiles.arcgis.com/tiles/z2tnIkrLQ2BRzr6P/arcgis/rest/services/Admin_Building_v17/SceneServer/layers/0",viewport:{...k}}},Q=X.Light,Z={transitionDuration:0,longitude:-122.401,latitude:37.796,pitch:40,bearing:0,zoom:16.5},W=new h.Z({id:"main",controller:{inertia:!0,dragPan:!1,dragRotate:!1,scrollZoom:!1},farZMultiplier:2.02}),z="\n  position: static;\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  align-items: center;\n  padding: 4px 16px;\n  cursor: pointer;\n  border-radius: 4px;\n  box-sizing: border-box;\n    option {\n      color: white;\n      background: #0E111A;\n      display: flex;\n      white-space: pre;\n    }\n  &:hover {\n    background: #4F52CC;\n    color: black;\n  }\n",Y="\n  font-family: 'Uber Move' sans-serif;\n  font-size: 16px;\n  font-style: normal;\n  font-weight: 500;\n  line-height: 19px;\n  letter-spacing: 0em;\n  text-align: left;\n",q="\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  position: absolute;\n",$="\n  background: #0E111A;\n  color: white;\n",ee=o.ZP.div.withConfig({displayName:"checkbox__CheckboxContainer",componentId:"sc-n0ckdw-0"})(["display:inline-block;vertical-align:middle;cursor:","};"],(e=>e.disabled?"auto":"pointer")),te=o.ZP.svg.withConfig({displayName:"checkbox__Icon",componentId:"sc-n0ckdw-1"})(["fill:none;stroke:white;stroke-width:2px;"]),ne=o.ZP.input.attrs({type:"checkbox"}).withConfig({displayName:"checkbox__HiddenCheckbox",componentId:"sc-n0ckdw-2"})(["border:0;clip:rect(0 0 0 0);clippath:inset(50%);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;white-space:nowrap;width:1px;"]),re=o.ZP.div.withConfig({displayName:"checkbox__StyledCheckbox",componentId:"sc-n0ckdw-3"})(["display:inline-block;width:22px;height:22px;margin-right:8px;background:",";border:",";border-radius:4px;transition:all 150ms;",":focus + &{box-shadow:0 0 0 2px #4f52cc;}","{visibility:",";}"],(e=>e.checked?"#4F52CC":"#0E111A"),(e=>e.disabled?"1px solid rgba(255,255,255, .6)":"1px solid #4F52CC"),ne,te,(e=>e.checked?"visible":"hidden")),ie=e=>{let{checked:t,...n}=e;return i.createElement(ee,{disabled:n.disabled},i.createElement(ne,(0,r.Z)({checked:t},n)),i.createElement(re,{disabled:n.disabled,checked:t},i.createElement(te,{viewBox:"0 0 24 24"},i.createElement("polyline",{points:"20 6 9 17 4 12"}))))},se=o.ZP.div.withConfig({displayName:"checkbox__CheckboxOption",componentId:"sc-n0ckdw-4"})(["display:flex;flex-direction:row;align-items:center;width:246px;padding-bottom:8px;"]),oe=o.ZP.span.withConfig({displayName:"checkbox__CheckboxSpan",componentId:"sc-n0ckdw-5"})(["margin-left:5;cursor:pointer;"]);var ae=n(92814),le=n(51436);const ce=o.ZP.input.withConfig({displayName:"toggle-switch__Input",componentId:"sc-1l103gi-0"})(["height:0;width:0;opacity:0;z-index:-1;"]),ue=o.ZP.label.withConfig({displayName:"toggle-switch__Label",componentId:"sc-1l103gi-1"})(["position:absolute;margin-left:220px;margin-bottom:2px;font-size:6px;width:28px;height:18px;border-radius:8px;cursor:",";","{opacity:0;width:0;height:0;}"],(e=>e.disabled?"not-allowed":"pointer"),ce),de=o.ZP.span.withConfig({displayName:"toggle-switch__Slider",componentId:"sc-1l103gi-2"})(["position:absolute;cursor:pointer;top:1px;left:0;right:0;bottom:0;background-color:rgba(250,250,250,0.2);transition:0.4s;border-radius:8px;&::after{color:white;}&::before{position:absolute;top:2px;left:2px;content:'';width:13px;height:13px;background-color:#ffffff;transition:0.4s;border-radius:8px;}",":checked + &{background:#4f52cc;}",":checked + &::before{-webkit-transform:translateX(11px);-ms-transform:translateX(11px);transform:translateX(11px);}"],ce,ce);function he(e){let{checked:t,onChange:n,name:r,id:s,title:o}=e;return i.createElement(ue,{htmlFor:s,title:o},i.createElement(ce,{id:s,type:"checkbox",name:r,checked:t,onChange:n,title:o}),i.createElement(de,null))}const fe=o.ZP.div.withConfig({displayName:"building-explorer__BuildingExplorerContainer",componentId:"sc-10f196y-0"})(["height:",";overflow:auto;align-items:flex-start;position:absolute;top:140px;display:flex;flex-direction:column;background:#0e111a;border-radius:8px;padding-top:4px;@media (max-width:768px){top:63px;width:100%;border-radius:0;}"],(e=>e.isShown?"450px":"40px")),Ae=o.ZP.div.withConfig({displayName:"building-explorer__BuildingExplorerSublayers",componentId:"sc-10f196y-1"})(["display:flex;flex-direction:column;"]),pe=o.ZP.div.withConfig({displayName:"building-explorer__CollapseContainer",componentId:"sc-10f196y-2"})(["margin-right:5px;cursor:pointer;"]),me=o.ZP.div.withConfig({displayName:"building-explorer__CheckboxContainer",componentId:"sc-10f196y-3"})([""," "," margin-left:10px;"],$,Y),Ce=o.ZP.h3.withConfig({displayName:"building-explorer__Label",componentId:"sc-10f196y-4"})(["margin:0 16px 8px 16px;cursor:pointer;color:white;font-weight:normal;"]),ge={sublayers:J().array,onToggleBuildingExplorer:J().func,isShown:J().bool};class Be extends i.PureComponent{constructor(e){super(e),this.state={updateCounter:0},this._setChild=this._setChild.bind(this),this._setChildren=this._setChildren.bind(this),this._toggleSublayer=this._toggleSublayer.bind(this),this._renderSublayers=this._renderSublayers.bind(this)}_setChild(e,t){const{onUpdateSublayerVisibility:n}=this.props;e.visibility=t,n(e),this._setChildren(e.sublayers,t)}_setChildren(e,t){if(e)for(const n of e)this._setChild(n,t)}_toggleSublayer(e){const{onUpdateSublayerVisibility:t}=this.props;e.visibility=!e.visibility,t(e),this._setChildren(e.sublayers,e.visibility),this.setState({updateCounter:this.state.updateCounter+1})}_toggleGroup(e){e.expanded=!e.expanded,this.setState({updateCounter:this.state.updateCounter+1})}_renderSublayers(e){return e.map((e=>{const t=e.sublayers||[];let n=le.diR,r="xs";return e.sublayers&&(r="lg",n=e.expanded?le.gc2:le.yOZ),i.createElement(me,{key:e.id},i.createElement(se,null,i.createElement(pe,null,i.createElement(ae.G,{icon:n,onClick:()=>this._toggleGroup(e),size:r})),i.createElement("label",null,i.createElement(ie,{id:"CheckBox"+e.id,value:e.visibility,checked:e.visibility,onChange:()=>this._toggleSublayer(e)}),i.createElement(oe,null,e.name))),e.expanded?this._renderSublayers(t):null)}))}render(){const{sublayers:e,onToggleBuildingExplorer:t,isShown:n}=this.props;return i.createElement(fe,{isShown:n},i.createElement(se,{style:{marginRight:"16px",paddingBottom:0}},i.createElement(Ce,{htmlFor:"BuildingExplorerToggle"},"BuildingExplorer"),i.createElement(he,{id:"BuildingExplorerToggle",value:n,checked:n,onChange:()=>{t&&t(!n)}})),n?i.createElement(Ae,null,this._renderSublayers(e)):null)}}Be.propTypes=ge,Be.defaultProps={sublayers:[],isShown:!1};const _e=o.ZP.div.withConfig({displayName:"control-panel__Container",componentId:"sc-1xdzghl-0"})([""," "," gap:10px;padding:16px;width:277px;height:132px;margin:10px;line-height:28px;background:#0e111a;border-radius:8px;z-index:15;top:",";@media (max-width:768px){width:100vw;margin:0;top:0;border-radius:0;flex-direction:row;align-items:center;height:80px;}"],q,$,(e=>e.debugMode?"50px":"0")),ye=o.ZP.select.withConfig({displayName:"control-panel__TilesetDropDown",componentId:"sc-1xdzghl-1"})([""," "," "," width:245px;@media (max-width:768px){width:auto;}"],$,Y,z),Ee=o.ZP.div.withConfig({displayName:"control-panel__MapContainer",componentId:"sc-1xdzghl-2"})(["display:flex;flex-direction:row;align-items:center;width:245px;"]),Te=o.ZP.div.withConfig({displayName:"control-panel__MapName",componentId:"sc-1xdzghl-3"})([""," font-weight:normal;width:70px;@media (max-width:768px){display:none;}"],$),be=o.ZP.div.withConfig({displayName:"control-panel__ItemName",componentId:"sc-1xdzghl-4"})([""," @media (max-width:768px){display:none;}"],$),Se=o.ZP.select.withConfig({displayName:"control-panel__DropDown",componentId:"sc-1xdzghl-5"})([""," "," "," width:167px;margin-left:8px;left:86px;@media (max-width:768px){width:auto;}"],$,Y,z),we={name:J().string,selectedMapStyle:J().string,mapStyles:J().object,debugMode:J().bool,useTerrainLayer:J().bool,sublayers:J().array,isBuildingExplorerShown:J().bool,onExampleChange:J().func,onMapStyleChange:J().func,onToggleBuildingExplorer:J().func,setMemoryVisibility:J().func,toggleTerrain:J().func},Re="Custom example";class Ie extends i.PureComponent{constructor(e){super(e),this._renderMapStyles=this._renderMapStyles.bind(this)}_renderExamples(){const{name:e,onExampleChange:t}=this.props,n=e||Re;return i.createElement(ye,{value:n,onChange:e=>{const n=e.target.value;this.setState({selected:n}),t(V[n])}},!e&&i.createElement("option",{key:"custom-example",value:"custom-example"},Re),Object.keys(V).map((e=>{const t=V[e];return i.createElement("option",{key:e,value:t.name},t.name)})))}_renderMapStyles(){const{mapStyles:e=X,selectedMapStyle:t,onMapStyleChange:n}=this.props;return i.createElement(Ee,null,i.createElement(Te,null,"Base map"),i.createElement(Se,{value:t,onChange:e=>n({selectedMapStyle:e.target.value})},Object.keys(e).map((t=>i.createElement("option",{key:t,value:e[t]},t)))))}_renderTerrainControl(){const{useTerrainLayer:e,toggleTerrain:t}=this.props;return i.createElement(Ee,null,i.createElement(be,null,"Terrain"),i.createElement(he,{value:e,checked:e,onChange:()=>{t({useTerrainLayer:!e})}}))}render(){const{debugMode:e,sublayers:t,onToggleBuildingExplorer:n,onUpdateSublayerVisibility:r,isBuildingExplorerShown:s}=this.props;return i.createElement(_e,{debugMode:e},this._renderExamples(),this._renderMapStyles(),this._renderTerrainControl(),null!=t&&t.length?i.createElement(Be,{sublayers:t,onToggleBuildingExplorer:n,onUpdateSublayerVisibility:r,isShown:s}):null)}}Ie.propTypes=we,Ie.defaultProps={name:"",debugMode:!1,isBuildingExplorerShown:!1,sublayers:[],useTerrainLayer:!1,toggleTerrain:()=>{}};const De=o.ZP.div.withConfig({displayName:"attributes-panel__Container",componentId:"sc-1mekzsx-0"})([""," align-items:center;color:rgba(255,255,255,.6);background:#0e111a;flex-flow:column;right:0;top:15px;right:15px;width:320px;height:auto;max-height:75%;z-index:16;word-break:break-word;border-radius:8px;@media (max-width:768px){margin:0;top:",";max-height:",";border-radius:0;width:300px;}"],q,(e=>e.isControlPanelShown?"95px":"10px"),(e=>e.isControlPanelShown?"calc(75% - 95px)":"calc(75% - 10px)")),ve=o.ZP.div.withConfig({displayName:"attributes-panel__ContentWrapper",componentId:"sc-1mekzsx-1"})(["overflow-y:auto;width:95%;padding:0 15px;margin-bottom:15px;"]),Oe=o.ZP.table.withConfig({displayName:"attributes-panel__AttributesTable",componentId:"sc-1mekzsx-2"})(["width:100%;"]),Ge={width:"50%",textAlign:"left",fontWeight:"500",borderRight:"3px solid rgba(0,0,0,.05)",padding:"5px 0",border:"none"},Me={width:"50%",fontWeight:"400",padding:"5px 0",border:"none"},xe={height:"30px",border:"none",cursor:"pointer",background:"transparent",color:"white",outline:"none",fontSize:"19px",marginRight:"5px"},Ne={title:J().string,attributesObject:J().object,isControlPanelShown:J().bool,children:J().node,handleClosePanel:J().func},Fe={margin:"0",marginLeft:"15px",color:"white"};class Pe extends i.PureComponent{prepareTable(){const{attributesObject:e}=this.props,t=[];for(const n in e){const r=this.formatValue(e[n]),i=this.createTableColumn(n,r);t.push(i)}return i.createElement(Oe,null,i.createElement("tbody",null,t))}createTableColumn(e,t){return i.createElement("tr",{style:{border:"none"},key:e},i.createElement("th",{style:Ge},e),i.createElement("td",{style:Me},t))}formatValue(e){return String(e).replace(/[{}']+/g,"").trim()||"No Data"}getHeaderStyle(e){return{display:"flex",flexFlow:"row nowrap",justifyContent:e?"space-between":"flex-end",alignItems:"center",minHeight:"40px",width:"100%"}}renderHeader(){const{title:e,handleClosePanel:t}=this.props;return i.createElement("div",{style:this.getHeaderStyle(e)},e&&i.createElement("h3",{style:Fe},e),i.createElement("button",{style:xe,onClick:t},i.createElement(ae.G,{icon:le.NBC})))}render(){const{attributesObject:e,isControlPanelShown:t,children:n}=this.props;return i.createElement(De,{isControlPanelShown:t},this.renderHeader(),i.createElement(ve,null,e&&this.prepareTable(),n))}}function Le(e){var t;const n={...e,sublayers:void 0};if(n.expanded=!1,null!=(t=e.sublayers)&&t.length){const{childNodesCount:t,sublayersCopy:r}=function(e){const t=[];let n=0;for(const r of e){const e=Le(r);e&&(t.push(e),n+=e.childNodesCount+1)}return{childNodesCount:n,sublayersCopy:t}}(e.sublayers);n.sublayers=r,n.childNodesCount=t}else if(n.childNodesCount=0,"group"===e.layerType)return null;return n}Pe.propTypes=Ne,Pe.defaultProps={title:null,attributesObject:{},isControlPanelShown:!1,children:null,handleClosePanel:()=>{}};var Ue=n(8700);function He(e){return new Ue.jk({id:e})}function Je(e,t,n){let r=null;for(const a of Object.values(n)){const{bbox:{east:n,north:i,south:s,west:o}}=a;e>o&&e<n&&t>s&&t<i&&(r=a)}if(!r)return null;const{content:[{attributes:{POSITION:{value:i}}}]}=r;let s=i[2]||0,o=Xe(e,t,i[0],i[1]);for(let a=3;a<i.length;a+=3){const n=Xe(e,t,i[a],i[a+1]);n<o&&(s=i[a+2],o=n)}return s}function Xe(e,t,n,r){const i=n-e,s=r-t;return Math.sqrt(i*i+s*s)}const je={type:d.Z,maxPitch:60,inertia:!0,scrollZoom:{speed:.01,smooth:!0}},ke=new h.Z({id:"main",controller:{inertia:!0},farZMultiplier:2.02}),Ke={longitude:-120,latitude:34,height:600,width:800,pitch:45,maxPitch:90,bearing:0,minZoom:2,maxZoom:30,zoom:14.5},Ve={rScaler:256,gScaler:1,bScaler:1/256,offset:-32768},Qe=o.ZP.div.withConfig({displayName:"app__StatsWidgetWrapper",componentId:"sc-1j8c7pb-0"})(["display:flex;@media (max-width:768px){display:none;}"]),Ze=o.ZP.div.withConfig({displayName:"app__StatsWidgetContainer",componentId:"sc-1j8c7pb-1"})([""," "," "," color:rgba(255,255,255,.6);z-index:3;bottom:15px;word-break:break-word;padding:6px;border-radius:8px;line-height:135%;bottom:auto;width:277px;left:10px;max-height:calc(100% - 125px);overflow:auto;> div{position:unset !important;z-index:1 !important;background-color:transparent !important;}"],q,$,Y);class We extends i.PureComponent{constructor(e){super(e),this._tilesetStatsWidget=null,this._loadedTilesets=[],this.state={tileset:null,url:null,token:null,name:K,viewState:this.props.heroExample?Z:Ke,selectedMapStyle:this.props.heroExample?Q:j,selectedFeatureAttributes:null,selectedFeatureIndex:-1,selectedTilesetBasePath:null,isAttributesLoading:!1,showBuildingExplorer:!1,flattenedSublayers:[],sublayers:[],sublayersUpdateCounter:0,tilesetsStats:He(),useTerrainLayer:!1,terrainTiles:{}},this.needTransitionToTileset=!0,this._onSelectTileset=this._onSelectTileset.bind(this),this.handleClosePanel=this.handleClosePanel.bind(this),this._onToggleBuildingExplorer=this._onToggleBuildingExplorer.bind(this),this._updateSublayerVisibility=this._updateSublayerVisibility.bind(this),this._toggleTerrain=this._toggleTerrain.bind(this)}componentDidMount(){let e;this._memWidget=new P.Z(L.lR.get("Memory Usage"),{framesPerUpdate:1,formatters:{"GPU Memory":"memory","Buffer Memory":"memory","Renderbuffer Memory":"memory","Texture Memory":"memory"},container:this._statsWidgetContainer}),this._tilesetStatsWidget=new P.Z(null,{container:this._statsWidgetContainer});const t=new URL(window.location.href).searchParams.get("url");e=t?{url:t}:this.props.heroExample?{url:"https://tiles.arcgis.com/tiles/z2tnIkrLQ2BRzr6P/arcgis/rest/services/SanFrancisco_3DObjects_1_7/SceneServer/layers/0"}:V[K],this.setState({tilesetsStats:He(t)}),this._onSelectTileset(e)}async getFlattenedSublayers(e){try{const t=await(0,E.z)(e,_),n=function(e){return Le(e.find((e=>"FullModel"===e.modelName)))}(t.header.sublayers);this.setState({sublayers:n.sublayers});return null==t?void 0:t.sublayers.filter((e=>"Overview"!==e.name))}catch(t){return[{url:e,visibility:!0}]}}async _onSelectTileset(e){const t=function(e,t){const n=new URL(e);let r=t&&t.token;const i=function(e){if(e.pathname.match(/layers\/\d/))return e.href.replace(/\/+$/,"");const t=e.pathname.replace(/\/?$/,"/").concat("layers/0");return""+e.origin+t+e.search}(n),s=i.lastIndexOf("/layers/0");let o=i.substring(0,s);return n.search&&(r=n.searchParams.get("token"),o=""+o+n.search),{...t,tilesetUrl:i,token:r,metadataUrl:o}}(e.url,e),{tilesetUrl:n,token:r,name:i,metadataUrl:s}=t;this.setState({tilesetUrl:n,name:i,token:r,sublayers:[]});const o=await(0,U.dc)(s).then((e=>e.json())),a=await this.getFlattenedSublayers(n);this.setState({metadata:o,selectedFeatureAttributes:null,flattenedSublayers:a}),this._loadedTilesets=[],this.needTransitionToTileset=!0;const l=He(n);this._tilesetStatsWidget.setStats(l),this.setState({tilesetsStats:l,showBuildingExplorer:!1})}_updateStatWidgets(){this._memWidget.update();const{tilesetsStats:e}=this.state;!function(e,t){t.reset();for(const n of e)n.stats.forEach((e=>{t.get(e.name).addCount(e.count)}))}(this._loadedTilesets,e),this._tilesetStatsWidget.update()}_rotateCamera(){const{viewState:{bearing:e}}=this.state,t={...this.state.viewState};this.setState({viewState:{...t,bearing:e+30,transitionDuration:1e4,transitionInterpolator:new f.Z(["bearing"]),onTransitionEnd:this._rotateCamera.bind(this)}})}_onTilesetLoad(e){if(this._loadedTilesets=[...this._loadedTilesets,e],this.needTransitionToTileset){const{zoom:r,cartographicCenter:i}=e,[s,o]=i,a=this.currentViewport;let l=s,c=o;if(a){var t,n;const{metadata:e,viewState:{pitch:r,bearing:i}}=this.state,{zmin:u=0}=(null==e||null==(t=e.layers)||null==(n=t[0])?void 0:n.fullExtent)||{},d=u*Math.tan(r*Math.PI/180),h=a.projectPosition([s,o]);h[0]+=d*Math.sin(i*Math.PI/180)*a.distanceScales.unitsPerMeter[0],h[1]+=d*Math.cos(i*Math.PI/180)*a.distanceScales.unitsPerMeter[1],[l,c]=a.unprojectPosition(h)}const u={...this.state.viewState,longitude:l,latitude:c};this.props.heroExample?this.setState({tileset:e,viewState:{...Z,onTransitionEnd:this._rotateCamera()}}):this.setState({tileset:e,viewState:{...u,zoom:r+2.5,transitionDuration:4e3,transitionInterpolator:new A.Z}}),this.needTransitionToTileset=!1}}_onViewStateChange(e){let{interactionState:t,viewState:n}=e,{longitude:r,latitude:i,position:[s,o,a]}=n;const{terrainTiles:l}=this.state,c=Je(r,i,l)||0;let u=null;if(this.currentViewport){const e=this.currentViewport.unprojectPosition(this.currentViewport.cameraPosition);u=Je(e[0],e[1],l)||0}let d=null===u||c>u?c:u;t.isZooming||(a-d>5?d=a-5:d-a>5&&(d=a+5)),this.setState({viewState:{...n,position:[0,0,d]}})}_onSelectMapStyle(e){let{selectedMapStyle:t}=e;this.setState({selectedMapStyle:t})}_toggleTerrain(){const{useTerrainLayer:e}=this.state;this.setState({useTerrainLayer:!e})}_onTerrainTileLoad(e){const{terrainTiles:t}=this.state,{bbox:{east:n,north:r,south:i,west:s}}=e;this.setState({terrainTiles:{...t,[n+";"+r+";"+i+";"+s]:e}})}_renderTerrainLayer(){return new m.Z({id:"terrain",maxZoom:15,elevationDecoder:Ve,elevationData:"https://s3.amazonaws.com/elevation-tiles-prod/terrarium/{z}/{x}/{y}.png",texture:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",onTileLoad:e=>this._onTerrainTileLoad(e),color:[255,255,255]})}_isLayerPickable(){var e;const{tileset:t}=this.state,n=null==t||null==(e=t.tileset)?void 0:e.layerType;return!this.props.heroExample&&"IntegratedMesh"!==n}_renderLayers(){const{flattenedSublayers:e,token:t,selectedFeatureIndex:n,selectedTilesetBasePath:r,useTerrainLayer:i}=this.state,s={i3s:{coordinateSystem:p.COORDINATE_SYSTEM.LNGLAT_OFFSETS}};t&&(s.i3s={...s.i3s,token:t});const o=e.filter((e=>e.visibility)).map((e=>new C.Z({id:"tile-layer-"+e.id,data:e.url,loader:y.N,onTilesetLoad:this._onTilesetLoad.bind(this),onTileLoad:()=>this._updateStatWidgets(),onTileUnload:()=>this._updateStatWidgets(),pickable:this._isLayerPickable(),loadOptions:s,highlightedObjectIndex:e.url===r?n:-1})));if(i){const e=this._renderTerrainLayer();o.push(e)}return o}async handleClick(e){if(!e.object||e.index<0||!e.layer)return void this.handleClosePanel();const{token:t}=this.state,n={};t&&(n.i3s={token:t}),this.setState({isAttributesLoading:!0});const r=await G(e.object,e.index,n);this.setState({isAttributesLoading:!1});const i=e.object.tileset.basePath;this.setState({selectedFeatureAttributes:r,selectedFeatureIndex:e.index,selectedTilesetBasePath:i})}_renderStats(){const{showBuildingExplorer:e,sublayers:t}=this.state,n={display:"flex",top:"150px"};return e&&(n.display="none"),t.length&&(n.top="200px"),i.createElement(Ze,{style:n,ref:e=>this._statsWidgetContainer=e})}_updateSublayerVisibility(e){if("3DObject"===e.layerType){const{flattenedSublayers:t,sublayersUpdateCounter:n}=this.state,r=t.find((t=>t.id===e.id));r&&(r.visibility=e.visibility,this.setState({sublayersUpdateCounter:n+1}),e.visibility||(this._loadedTilesets=this._loadedTilesets.filter((e=>e.basePath!==r.url))))}}_renderControlPanel(){const{name:e,selectedMapStyle:t,sublayers:n,showBuildingExplorer:r,useTerrainLayer:s}=this.state;return i.createElement(Ie,{name:e,onExampleChange:this._onSelectTileset,onMapStyleChange:this._onSelectMapStyle.bind(this),onToggleBuildingExplorer:this._onToggleBuildingExplorer,onUpdateSublayerVisibility:this._updateSublayerVisibility,selectedMapStyle:t,sublayers:n,isBuildingExplorerShown:r,useTerrainLayer:s,toggleTerrain:this._toggleTerrain})}getTooltip(){const{isAttributesLoading:e}=this.state;if(e){const e=document.createElement("div");return(0,s.render)(i.createElement(ae.G,{icon:le.LM3}),e),{html:e.innerHTML}}return null}handleClosePanel(){this.setState({selectedFeatureAttributes:null,selectedFeatureIndex:-1})}renderAttributesPanel(){const{selectedFeatureAttributes:e}=this.state,t=e.NAME||e.OBJECTID;return i.createElement(Pe,{title:t,handleClosePanel:this.handleClosePanel,attributesObject:e,isControlPanelShown:!0})}_renderMemory(){const{showBuildingExplorer:e}=this.state;return i.createElement(Qe,{showMemory:!e},this._renderStats())}_onToggleBuildingExplorer(e){this.setState({showBuildingExplorer:e})}render(){const e=this._renderLayers(),{viewState:t,selectedMapStyle:n,selectedFeatureAttributes:r,useTerrainLayer:s}=this.state;return i.createElement("div",{style:{position:"relative",height:"100%"}},!this.props.hideControlPanel&&this._renderControlPanel(),r&&this.renderAttributesPanel(),!this.props.hideStats&&this._renderMemory(),i.createElement(u.Z,{layers:e,viewState:t,views:[this.props.heroExample?W:ke],onViewStateChange:this._onViewStateChange.bind(this),controller:!this.props.heroExample&&je,onAfterRender:()=>this._updateStatWidgets(),getTooltip:e=>this.getTooltip(e),onClick:e=>this.handleClick(e)},(e=>{let{viewport:t}=e;this.currentViewport=t}),!s&&i.createElement(a.D5,{reuseMaps:!0,mapLib:c(),mapStyle:n,preventStyleDiffing:!0})))}}const ze=(e,t)=>n=>i.createElement(e,(0,r.Z)({},n,t)),Ye=ze(We,{}),qe=(ze(We,{hideControlPanel:!0,hideStats:!0}),ze(We,{hideControlPanel:!0,hideStats:!0,heroExample:!0}));const $e=Ye},41882:(e,t,n)=>{"use strict";n.d(t,{u:()=>ot});var r=n(80072),i=n(5860);const s="undefined"!=typeof __VERSION__?__VERSION__:"latest",o={COMPOSITE:"cmpt",POINT_CLOUD:"pnts",BATCHED_3D_MODEL:"b3dm",INSTANCED_3D_MODEL:"i3dm",GEOMETRY:"geom",VECTOR:"vect",GLTF:"glTF"};Object.keys(o);var a=n(61573);function l(e,t,n){(0,a.h)(e instanceof ArrayBuffer);const r=new TextDecoder("utf8"),i=new Uint8Array(e,t,n);return r.decode(i)}var c=n(76075),u=n(93203),d=n(5120),h=n(43855);const f={[d.I6.DOUBLE]:Float64Array,[d.I6.FLOAT]:Float32Array,[d.I6.UNSIGNED_SHORT]:Uint16Array,[d.I6.UNSIGNED_INT]:Uint32Array,[d.I6.UNSIGNED_BYTE]:Uint8Array,[d.I6.BYTE]:Int8Array,[d.I6.SHORT]:Int16Array,[d.I6.INT]:Int32Array},A={DOUBLE:d.I6.DOUBLE,FLOAT:d.I6.FLOAT,UNSIGNED_SHORT:d.I6.UNSIGNED_SHORT,UNSIGNED_INT:d.I6.UNSIGNED_INT,UNSIGNED_BYTE:d.I6.UNSIGNED_BYTE,BYTE:d.I6.BYTE,SHORT:d.I6.SHORT,INT:d.I6.INT},p="Failed to convert GL type";class m{static fromTypedArray(e){e=ArrayBuffer.isView(e)?e.constructor:e;for(const t in f){if(f[t]===e)return t}throw new Error(p)}static fromName(e){const t=A[e];if(!t)throw new Error(p);return t}static getArrayType(e){switch(e){case d.I6.UNSIGNED_SHORT_5_6_5:case d.I6.UNSIGNED_SHORT_4_4_4_4:case d.I6.UNSIGNED_SHORT_5_5_5_1:return Uint16Array;default:const t=f[e];if(!t)throw new Error(p);return t}}static getByteSize(e){return m.getArrayType(e).BYTES_PER_ELEMENT}static validate(e){return Boolean(m.getArrayType(e))}static createTypedArray(e,t,n,r){void 0===n&&(n=0),void 0===r&&(r=(t.byteLength-n)/m.getByteSize(e));return new(m.getArrayType(e))(t,n,r)}}class C{constructor(e,t){this.featuresLength=0,this._cachedTypedArrays={},this.json=e,this.buffer=t}getExtension(e){return this.json.extensions&&this.json.extensions[e]}hasProperty(e){return Boolean(this.json[e])}getGlobalProperty(e,t,n){void 0===t&&(t=d.GL.UNSIGNED_INT),void 0===n&&(n=1);const r=this.json[e];return r&&Number.isFinite(r.byteOffset)?this._getTypedArrayFromBinary(e,t,n,1,r.byteOffset):r}getPropertyArray(e,t,n){const r=this.json[e];return r&&Number.isFinite(r.byteOffset)?("componentType"in r&&(t=m.fromName(r.componentType)),this._getTypedArrayFromBinary(e,t,n,this.featuresLength,r.byteOffset)):this._getTypedArrayFromArray(e,t,r)}getProperty(e,t,n,r,i){const s=this.json[e];if(!s)return s;const o=this.getPropertyArray(e,t,n);if(1===n)return o[r];for(let a=0;a<n;++a)i[a]=o[n*r+a];return i}_getTypedArrayFromBinary(e,t,n,r,i){const s=this._cachedTypedArrays;let o=s[e];return o||(o=m.createTypedArray(t,this.buffer.buffer,this.buffer.byteOffset+i,r*n),s[e]=o),o}_getTypedArrayFromArray(e,t,n){const r=this._cachedTypedArrays;let i=r[e];return i||(i=m.createTypedArray(t,n),r[e]=i),i}}const g={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},B={SCALAR:(e,t)=>e[t],VEC2:(e,t)=>[e[2*t+0],e[2*t+1]],VEC3:(e,t)=>[e[3*t+0],e[3*t+1],e[3*t+2]],VEC4:(e,t)=>[e[4*t+0],e[4*t+1],e[4*t+2],e[4*t+3]],MAT2:(e,t)=>[e[4*t+0],e[4*t+1],e[4*t+2],e[4*t+3]],MAT3:(e,t)=>[e[9*t+0],e[9*t+1],e[9*t+2],e[9*t+3],e[9*t+4],e[9*t+5],e[9*t+6],e[9*t+7],e[9*t+8]],MAT4:(e,t)=>[e[16*t+0],e[16*t+1],e[16*t+2],e[16*t+3],e[16*t+4],e[16*t+5],e[16*t+6],e[16*t+7],e[16*t+8],e[16*t+9],e[16*t+10],e[16*t+11],e[16*t+12],e[16*t+13],e[16*t+14],e[16*t+15]]},_={SCALAR:(e,t,n)=>{t[n]=e},VEC2:(e,t,n)=>{t[2*n+0]=e[0],t[2*n+1]=e[1]},VEC3:(e,t,n)=>{t[3*n+0]=e[0],t[3*n+1]=e[1],t[3*n+2]=e[2]},VEC4:(e,t,n)=>{t[4*n+0]=e[0],t[4*n+1]=e[1],t[4*n+2]=e[2],t[4*n+3]=e[3]},MAT2:(e,t,n)=>{t[4*n+0]=e[0],t[4*n+1]=e[1],t[4*n+2]=e[2],t[4*n+3]=e[3]},MAT3:(e,t,n)=>{t[9*n+0]=e[0],t[9*n+1]=e[1],t[9*n+2]=e[2],t[9*n+3]=e[3],t[9*n+4]=e[4],t[9*n+5]=e[5],t[9*n+6]=e[6],t[9*n+7]=e[7],t[9*n+8]=e[8],t[9*n+9]=e[9]},MAT4:(e,t,n)=>{t[16*n+0]=e[0],t[16*n+1]=e[1],t[16*n+2]=e[2],t[16*n+3]=e[3],t[16*n+4]=e[4],t[16*n+5]=e[5],t[16*n+6]=e[6],t[16*n+7]=e[7],t[16*n+8]=e[8],t[16*n+9]=e[9],t[16*n+10]=e[10],t[16*n+11]=e[11],t[16*n+12]=e[12],t[16*n+13]=e[13],t[16*n+14]=e[14],t[16*n+15]=e[15]}};var y=n(25108);const E=e=>void 0!==e;function T(e,t,n){if(!t)return null;let r=e.getExtension("3DTILES_batch_table_hierarchy");const i=t.HIERARCHY;return i&&(y.warn("3D Tile Parser: HIERARCHY is deprecated. Use 3DTILES_batch_table_hierarchy."),t.extensions=t.extensions||{},t.extensions["3DTILES_batch_table_hierarchy"]=i,r=i),r?function(e,t){let n,r,i;const s=e.instancesLength,o=e.classes;let a,l=e.classIds,c=e.parentCounts,u=e.parentIds,d=s;E(l.byteOffset)&&(l.componentType=defaultValue(l.componentType,GL.UNSIGNED_SHORT),l.type=AttributeType.SCALAR,i=getBinaryAccessor(l),l=i.createArrayBufferView(t.buffer,t.byteOffset+l.byteOffset,s));if(E(c))for(E(c.byteOffset)&&(c.componentType=defaultValue(c.componentType,GL.UNSIGNED_SHORT),c.type=AttributeType.SCALAR,i=getBinaryAccessor(c),c=i.createArrayBufferView(t.buffer,t.byteOffset+c.byteOffset,s)),a=new Uint16Array(s),d=0,n=0;n<s;++n)a[n]=d,d+=c[n];E(u)&&E(u.byteOffset)&&(u.componentType=defaultValue(u.componentType,GL.UNSIGNED_SHORT),u.type=AttributeType.SCALAR,i=getBinaryAccessor(u),u=i.createArrayBufferView(t.buffer,t.byteOffset+u.byteOffset,d));const h=o.length;for(n=0;n<h;++n){const e=o[n].length,r=o[n].instances,i=getBinaryProperties(e,r,t);o[n].instances=combine(i,r)}const f=new Array(h).fill(0),A=new Uint16Array(s);for(n=0;n<s;++n)r=l[n],A[n]=f[r],++f[r];const p={classes:o,classIds:l,classIndexes:A,parentCounts:c,parentIndexes:a,parentIds:u};return function(e){const t=e.classIds,n=t.length;for(let r=0;r<n;++r)S(e,r,stack)}(p),p}(r,n):null}function b(e,t,n){if(!e)return;const r=e.parentCounts;return e.parentIds?n(e,t):r>0?function(e,t,n){const r=e.classIds,i=e.parentCounts,s=e.parentIds,o=e.parentIndexes,a=r.length,l=scratchVisited;l.length=Math.max(l.length,a);const c=++marker,u=scratchStack;u.length=0,u.push(t);for(;u.length>0;){if(l[t=u.pop()]===c)continue;l[t]=c;const r=n(e,t);if(E(r))return r;const a=i[t],d=o[t];for(let e=0;e<a;++e){const n=s[d+e];n!==t&&u.push(n)}}return null}(e,t,n):function(e,t,n){let r=!0;for(;r;){const i=n(e,t);if(E(i))return i;const s=e.parentIds[t];r=s!==t,t=s}throw new Error("traverseHierarchySingleParent")}(e,t,n)}function S(e,t,n){const r=e.parentCounts,i=e.parentIds,s=e.parentIndexes,o=e.classIds.length;if(!E(i))return;assert(t<o,"Parent index "+t+" exceeds the total number of instances: "+o),assert(-1===n.indexOf(t),"Circular dependency detected in the batch table hierarchy."),n.push(t);const a=E(r)?r[t]:1,l=E(r)?s[t]:t;for(let c=0;c<a;++c){const r=i[l+c];r!==t&&S(e,r,n)}n.pop(t)}function w(e){return null!=e}const R=(e,t)=>e,I={HIERARCHY:!0,extensions:!0,extras:!0};class D{constructor(e,t,n,r){var i;void 0===r&&(r={}),(0,a.h)(n>=0),this.json=e||{},this.binary=t,this.featureCount=n,this._extensions=(null==(i=this.json)?void 0:i.extensions)||{},this._properties={};for(const s in this.json)I[s]||(this._properties[s]=this.json[s]);this._binaryProperties=this._initializeBinaryProperties(),r["3DTILES_batch_table_hierarchy"]&&(this._hierarchy=T(this,this.json,this.binary))}getExtension(e){return this.json&&this.json.extensions&&this.json.extensions[e]}memorySizeInBytes(){return 0}isClass(e,t){if(this._checkBatchId(e),(0,a.h)("string"==typeof t,t),this._hierarchy){return w(b(this._hierarchy,e,((e,n)=>{const r=e.classIds[n];return e.classes[r].name===t})))}return!1}isExactClass(e,t){return(0,a.h)("string"==typeof t,t),this.getExactClassName(e)===t}getExactClassName(e){if(this._checkBatchId(e),this._hierarchy){const t=this._hierarchy.classIds[e];return this._hierarchy.classes[t].name}}hasProperty(e,t){return this._checkBatchId(e),(0,a.h)("string"==typeof t,t),w(this._properties[t])||this._hasPropertyInHierarchy(e,t)}getPropertyNames(e,t){this._checkBatchId(e),(t=w(t)?t:[]).length=0;const n=Object.keys(this._properties);return t.push(...n),this._hierarchy&&this._getPropertyNamesInHierarchy(e,t),t}getProperty(e,t){if(this._checkBatchId(e),(0,a.h)("string"==typeof t,t),this._binaryProperties){const n=this._binaryProperties[t];if(w(n))return this._getBinaryProperty(n,e)}const n=this._properties[t];if(w(n))return R(n[e]);if(this._hierarchy){const n=this._getHierarchyProperty(e,t);if(w(n))return n}}setProperty(e,t,n){const r=this.featureCount;if(this._checkBatchId(e),(0,a.h)("string"==typeof t,t),this._binaryProperties){const r=this._binaryProperties[t];if(r)return void this._setBinaryProperty(r,e,n)}if(this._hierarchy&&this._setHierarchyProperty(this,e,t,n))return;let i=this._properties[t];w(i)||(this._properties[t]=new Array(r),i=this._properties[t]),i[e]=R(n)}_checkBatchId(e){if(!(e>=0&&e<this.featureCount))throw new Error("batchId not in range [0, featureCount - 1].")}_getBinaryProperty(e,t){return e.unpack(e.typedArray,t)}_setBinaryProperty(e,t,n){e.pack(n,e.typedArray,t)}_initializeBinaryProperties(){let e=null;for(const t in this._properties){const n=this._properties[t],r=this._initializeBinaryProperty(t,n);r&&(e=e||{},e[t]=r)}return e}_initializeBinaryProperty(e,t){if("byteOffset"in t){const n=t;(0,a.h)(this.binary,"Property "+e+" requires a batch table binary."),(0,a.h)(n.type,"Property "+e+" requires a type.");const r=function(e,t,n,r){const{componentType:i}=e;(0,a.h)(e.componentType);const s="string"==typeof i?m.fromName(i):i,o=g[e.type],l=B[e.type],c=_[e.type];return n+=e.byteOffset,{values:m.createTypedArray(s,t,n,o*r),type:s,size:o,unpacker:l,packer:c}}(n,this.binary.buffer,0|this.binary.byteOffset,this.featureCount);return{typedArray:r.values,componentCount:r.size,unpack:r.unpacker,pack:r.packer}}return null}_hasPropertyInHierarchy(e,t){if(!this._hierarchy)return!1;const n=b(this._hierarchy,e,((e,n)=>{const r=e.classIds[n];return w(e.classes[r].instances[t])}));return w(n)}_getPropertyNamesInHierarchy(e,t){b(this._hierarchy,e,((e,n)=>{const r=e.classIds[n],i=e.classes[r].instances;for(const s in i)i.hasOwnProperty(s)&&-1===t.indexOf(s)&&t.push(s)}))}_getHierarchyProperty(e,t){return b(this._hierarchy,e,((e,n)=>{const r=e.classIds[n],i=e.classes[r],s=e.classIndexes[n],o=i.instances[t];return w(o)?w(o.typedArray)?this._getBinaryProperty(o,s):R(o[s]):null}))}_setHierarchyProperty(e,t,n,r){const i=b(this._hierarchy,t,((e,i)=>{const s=e.classIds[i],o=e.classes[s],l=e.classIndexes[i],c=o.instances[n];return!!w(c)&&((0,a.h)(i===t,'Inherited property "'+n+'" is read-only.'),w(c.typedArray)?this._setBinaryProperty(c,l,r):c[l]=R(r),!0)}));return w(i)}}const v=4;function O(e,t,n){void 0===n&&(n=0);const r=new DataView(t);if(e.magic=r.getUint32(n,!0),n+=v,e.version=r.getUint32(n,!0),n+=v,e.byteLength=r.getUint32(n,!0),n+=v,1!==e.version)throw new Error("3D Tile Version "+e.version+" not supported");return n}var G=n(25108);const M=4,x="b3dm tile in legacy format.";function N(e,t,n){const r=new DataView(t);let i;e.header=e.header||{};let s=r.getUint32(n,!0);n+=M;let o=r.getUint32(n,!0);n+=M;let a=r.getUint32(n,!0);n+=M;let l=r.getUint32(n,!0);return n+=M,a>=570425344?(n-=2*M,i=s,a=o,l=0,s=0,o=0,G.warn(x)):l>=570425344&&(n-=M,i=a,a=s,l=o,s=0,o=0,G.warn(x)),e.header.featureTableJsonByteLength=s,e.header.featureTableBinaryByteLength=o,e.header.batchTableJsonByteLength=a,e.header.batchTableBinaryByteLength=l,e.header.batchLength=i,n}function F(e,t,n,r){return n=function(e,t,n,r){const{featureTableJsonByteLength:i,featureTableBinaryByteLength:s,batchLength:o}=e.header||{};if(e.featureTableJson={BATCH_LENGTH:o||0},i&&i>0){const r=l(t,n,i);e.featureTableJson=JSON.parse(r)}return n+=i||0,e.featureTableBinary=new Uint8Array(t,n,s),n+=s||0,n}(e,t,n),n=function(e,t,n,r){const{batchTableJsonByteLength:i,batchTableBinaryByteLength:s}=e.header||{};if(i&&i>0){const r=l(t,n,i);e.batchTableJson=JSON.parse(r),n+=i,s&&s>0&&(e.batchTableBinary=new Uint8Array(t,n,s),e.batchTableBinary=new Uint8Array(e.batchTableBinary),n+=s)}return n}(e,t,n),n}function P(e,t){void 0===t&&(t=[0,0,0]);const n=e>>11&31,r=e>>5&63,i=31&e;return t[0]=n<<3,t[1]=r<<2,t[2]=i<<3,t}function L(e,t,n){if(!(t||e&&e.batchIds&&n))return null;const{batchIds:r,isRGB565:i,pointCount:s=0}=e;if(r&&n){const e=new Uint8ClampedArray(3*s);for(let t=0;t<s;t++){const i=r[t],s=n.getProperty(i,"dimensions").map((e=>255*e));e[3*t]=s[0],e[3*t+1]=s[1],e[3*t+2]=s[2]}return{type:d.GL.UNSIGNED_BYTE,value:e,size:3,normalized:!0}}if(t&&i){const e=new Uint8ClampedArray(3*s);for(let n=0;n<s;n++){const r=P(t[n]);e[3*n]=r[0],e[3*n+1]=r[1],e[3*n+2]=r[2]}return{type:d.GL.UNSIGNED_BYTE,value:e,size:3,normalized:!0}}return t&&t.length===3*s?{type:d.GL.UNSIGNED_BYTE,value:t,size:3,normalized:!0}:{type:d.GL.UNSIGNED_BYTE,value:t||new Uint8ClampedArray,size:4,normalized:!0}}var U=n(37069),H=n(14034);new U.Z,new h.Z,new U.Z,new U.Z,new Uint8Array(1);function J(e,t){return void 0===t&&(t=255),(0,H.uZ)(e,0,t)/t*2-1}function X(e){return e<0?-1:1}function j(e,t,n,r){if(function(e,t){if(!e)throw new Error("math.gl assertion failed. "+t)}(r),e<0||e>n||t<0||t>n)throw new Error("x and y must be unsigned normalized integers between 0 and "+n);if(r.x=J(e,n),r.y=J(t,n),r.z=1-(Math.abs(r.x)+Math.abs(r.y)),r.z<0){const e=r.x;r.x=(1-Math.abs(r.y))*X(e),r.y=(1-Math.abs(e))*X(r.y)}return r.normalize()}function k(e,t,n){return j(e,t,255,n)}const K=new h.Z;function V(e,t,n){return e.isQuantized?n["3d-tiles"]&&n["3d-tiles"].decodeQuantizedPositions?(e.isQuantized=!1,function(e,t){const n=new h.Z,r=new Float32Array(3*e.pointCount);for(let i=0;i<e.pointCount;i++)n.set(t[3*i],t[3*i+1],t[3*i+2]).scale(1/e.quantizedRange).multiply(e.quantizedVolumeScale).add(e.quantizedVolumeOffset).toArray(r,3*i);return r}(e,t)):{type:d.GL.UNSIGNED_SHORT,value:t,size:3,normalized:!0}:t}async function Q(e,t,n,r,i){n=F(e,t,n=N(e,t,n=O(e,t,n))),function(e){e.attributes={positions:null,colors:null,normals:null,batchIds:null},e.isQuantized=!1,e.isTranslucent=!1,e.isRGB565=!1,e.isOctEncoded16P=!1}(e);const{featureTable:s,batchTable:o}=function(e){const t=new C(e.featureTableJson,e.featureTableBinary),n=t.getGlobalProperty("POINTS_LENGTH");if(!Number.isFinite(n))throw new Error("POINTS_LENGTH must be defined");t.featuresLength=n,e.featuresLength=n,e.pointsLength=n,e.pointCount=n,e.rtcCenter=t.getGlobalProperty("RTC_CENTER",d.GL.FLOAT,3);const r=function(e,t){let n=null;if(!e.batchIds&&t.hasProperty("BATCH_ID")&&(e.batchIds=t.getPropertyArray("BATCH_ID",d.GL.UNSIGNED_SHORT,1),e.batchIds)){const r=t.getGlobalProperty("BATCH_LENGTH");if(!r)throw new Error("Global property: BATCH_LENGTH must be defined when BATCH_ID is defined.");const{batchTableJson:i,batchTableBinary:s}=e;n=new D(i,s,r)}return n}(e,t);return{featureTable:t,batchTable:r}}(e);return await async function(e,t,n,r,i){let s,o,a;const l=e.batchTableJson&&e.batchTableJson.extensions&&e.batchTableJson.extensions["3DTILES_draco_point_compression"];l&&(a=l.properties);const d=t.getExtension("3DTILES_draco_point_compression");if(d){o=d.properties;const t=d.byteOffset,n=d.byteLength;if(!o||!Number.isFinite(t)||!n)throw new Error("Draco properties, byteOffset, and byteLength must be defined");s=(e.featureTableBinary||[]).slice(t,t+n),e.hasPositions=Number.isFinite(o.POSITION),e.hasColors=Number.isFinite(o.RGB)||Number.isFinite(o.RGBA),e.hasNormals=Number.isFinite(o.NORMAL),e.hasBatchIds=Number.isFinite(o.BATCH_ID),e.isTranslucent=Number.isFinite(o.RGBA)}if(!s)return!0;const f={buffer:s,properties:{...o,...a},featureTableProperties:o,batchTableProperties:a,dequantizeInShader:!1};return await async function(e,t,n,r){if(!r)return;const i={...n,draco:{...null==n?void 0:n.draco,extraAttributes:t.batchTableProperties||{}}};delete i["3d-tiles"];const s=await(0,u.cr)(t.buffer,c.VJ,i,r),o=s.attributes.POSITION&&s.attributes.POSITION.value,a=s.attributes.COLOR_0&&s.attributes.COLOR_0.value,l=s.attributes.NORMAL&&s.attributes.NORMAL.value,d=s.attributes.BATCH_ID&&s.attributes.BATCH_ID.value,f=o&&s.attributes.POSITION.value.quantization,A=l&&s.attributes.NORMAL.value.quantization;if(f){const t=s.POSITION.data.quantization,n=t.range;e.quantizedVolumeScale=new h.Z(n,n,n),e.quantizedVolumeOffset=new h.Z(t.minValues),e.quantizedRange=(1<<t.quantizationBits)-1,e.isQuantizedDraco=!0}A&&(e.octEncodedRange=(1<<s.NORMAL.data.quantization.quantizationBits)-1,e.isOctEncodedDraco=!0);const p={};if(t.batchTableProperties)for(const c of Object.keys(t.batchTableProperties))s.attributes[c]&&s.attributes[c].value&&(p[c.toLowerCase()]=s.attributes[c].value);e.attributes={positions:o,colors:L(e,a,void 0),normals:l,batchIds:d,...p}}(e,f,r,i)}(e,s,0,r,i),function(e,t,n){if(e.attributes=e.attributes||{positions:null,colors:null,normals:null,batchIds:null},!e.attributes.positions)if(t.hasProperty("POSITION"))e.attributes.positions=t.getPropertyArray("POSITION",d.GL.FLOAT,3);else if(t.hasProperty("POSITION_QUANTIZED")){const r=t.getPropertyArray("POSITION_QUANTIZED",d.GL.UNSIGNED_SHORT,3);if(e.isQuantized=!0,e.quantizedRange=65535,e.quantizedVolumeScale=t.getGlobalProperty("QUANTIZED_VOLUME_SCALE",d.GL.FLOAT,3),!e.quantizedVolumeScale)throw new Error("QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");if(e.quantizedVolumeOffset=t.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",d.GL.FLOAT,3),!e.quantizedVolumeOffset)throw new Error("QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");e.attributes.positions=V(e,r,n)}if(!e.attributes.positions)throw new Error("Either POSITION or POSITION_QUANTIZED must be defined.")}(e,s,r),function(e,t,n){if(e.attributes=e.attributes||{positions:null,colors:null,normals:null,batchIds:null},!e.attributes.colors){let r=null;t.hasProperty("RGBA")?(r=t.getPropertyArray("RGBA",d.GL.UNSIGNED_BYTE,4),e.isTranslucent=!0):t.hasProperty("RGB")?r=t.getPropertyArray("RGB",d.GL.UNSIGNED_BYTE,3):t.hasProperty("RGB565")&&(r=t.getPropertyArray("RGB565",d.GL.UNSIGNED_SHORT,1),e.isRGB565=!0),e.attributes.colors=L(e,r,n)}t.hasProperty("CONSTANT_RGBA")&&(e.constantRGBA=t.getGlobalProperty("CONSTANT_RGBA",d.GL.UNSIGNED_BYTE,4))}(e,s,o),function(e,t){if(e.attributes=e.attributes||{positions:null,colors:null,normals:null,batchIds:null},!e.attributes.normals){let n=null;t.hasProperty("NORMAL")?n=t.getPropertyArray("NORMAL",d.GL.FLOAT,3):t.hasProperty("NORMAL_OCT16P")&&(n=t.getPropertyArray("NORMAL_OCT16P",d.GL.UNSIGNED_BYTE,2),e.isOctEncoded16P=!0),e.attributes.normals=function(e,t){if(!t)return null;if(e.isOctEncoded16P){const n=new Float32Array(3*(e.pointsLength||0));for(let r=0;r<(e.pointsLength||0);r++)k(t[2*r],t[2*r+1],K),K.toArray(n,3*r);return{type:d.GL.FLOAT,size:2,value:n}}return{type:d.GL.FLOAT,size:2,value:t}}(e,n)}}(e,s),n}var Z=n(91098),W=n(4183),z=n(79054),Y=n(25108);const q={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},$={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},ee=10240,te=10241,ne=10242,re=10243,ie=10497,se={magFilter:ee,minFilter:te,wrapS:ne,wrapT:re},oe={[ee]:9729,[te]:9986,[ne]:ie,[re]:ie};class ae{constructor(){this.baseUri="",this.buffers=[],this.images=[]}postProcess(e,t){void 0===t&&(t={});const{json:n,buffers:r=[],images:i=[]}=e,{baseUri:s=""}=e;return(0,W.h)(n),this.baseUri=s,this.buffers=r,this.images=i,this.jsonUnprocessed=n,this.json=this._resolveTree(e.json,t),this.json}_resolveTree(e,t){void 0===t&&(t={});const n={...e};return this.json=n,e.bufferViews&&(n.bufferViews=e.bufferViews.map(((e,t)=>this._resolveBufferView(e,t)))),e.images&&(n.images=e.images.map(((e,t)=>this._resolveImage(e,t)))),e.samplers&&(n.samplers=e.samplers.map(((e,t)=>this._resolveSampler(e,t)))),e.textures&&(n.textures=e.textures.map(((e,t)=>this._resolveTexture(e,t)))),e.accessors&&(n.accessors=e.accessors.map(((e,t)=>this._resolveAccessor(e,t)))),e.materials&&(n.materials=e.materials.map(((e,t)=>this._resolveMaterial(e,t)))),e.meshes&&(n.meshes=e.meshes.map(((e,t)=>this._resolveMesh(e,t)))),e.nodes&&(n.nodes=e.nodes.map(((e,t)=>this._resolveNode(e,t))),n.nodes=n.nodes.map(((e,t)=>this._resolveNodeChildren(e)))),e.skins&&(n.skins=e.skins.map(((e,t)=>this._resolveSkin(e,t)))),e.scenes&&(n.scenes=e.scenes.map(((e,t)=>this._resolveScene(e,t)))),"number"==typeof this.json.scene&&n.scenes&&(n.scene=n.scenes[this.json.scene]),n}getScene(e){return this._get(this.json.scenes,e)}getNode(e){return this._get(this.json.nodes,e)}getSkin(e){return this._get(this.json.skins,e)}getMesh(e){return this._get(this.json.meshes,e)}getMaterial(e){return this._get(this.json.materials,e)}getAccessor(e){return this._get(this.json.accessors,e)}getCamera(e){return this._get(this.json.cameras,e)}getTexture(e){return this._get(this.json.textures,e)}getSampler(e){return this._get(this.json.samplers,e)}getImage(e){return this._get(this.json.images,e)}getBufferView(e){return this._get(this.json.bufferViews,e)}getBuffer(e){return this._get(this.json.buffers,e)}_get(e,t){if("object"==typeof t)return t;const n=e&&e[t];return n||Y.warn("glTF file error: Could not find "+e+"["+t+"]"),n}_resolveScene(e,t){return{...e,id:e.id||"scene-"+t,nodes:(e.nodes||[]).map((e=>this.getNode(e)))}}_resolveNode(e,t){const n={...e,id:(null==e?void 0:e.id)||"node-"+t};return void 0!==e.mesh&&(n.mesh=this.getMesh(e.mesh)),void 0!==e.camera&&(n.camera=this.getCamera(e.camera)),void 0!==e.skin&&(n.skin=this.getSkin(e.skin)),void 0!==e.meshes&&e.meshes.length&&(n.mesh=e.meshes.reduce(((e,t)=>{const n=this.getMesh(t);return e.id=n.id,e.primitives=e.primitives.concat(n.primitives),e}),{primitives:[]})),n}_resolveNodeChildren(e){return e.children&&(e.children=e.children.map((e=>this.getNode(e)))),e}_resolveSkin(e,t){const n="number"==typeof e.inverseBindMatrices?this.getAccessor(e.inverseBindMatrices):void 0;return{...e,id:e.id||"skin-"+t,inverseBindMatrices:n}}_resolveMesh(e,t){const n={...e,id:e.id||"mesh-"+t,primitives:[]};return e.primitives&&(n.primitives=e.primitives.map((e=>{const t={...e,attributes:{},indices:void 0,material:void 0},n=e.attributes;for(const r in n)t.attributes[r]=this.getAccessor(n[r]);return void 0!==e.indices&&(t.indices=this.getAccessor(e.indices)),void 0!==e.material&&(t.material=this.getMaterial(e.material)),t}))),n}_resolveMaterial(e,t){const n={...e,id:e.id||"material-"+t};if(n.normalTexture&&(n.normalTexture={...n.normalTexture},n.normalTexture.texture=this.getTexture(n.normalTexture.index)),n.occlusionTexture&&(n.occlusionTexture={...n.occlusionTexture},n.occlusionTexture.texture=this.getTexture(n.occlusionTexture.index)),n.emissiveTexture&&(n.emissiveTexture={...n.emissiveTexture},n.emissiveTexture.texture=this.getTexture(n.emissiveTexture.index)),n.emissiveFactor||(n.emissiveFactor=n.emissiveTexture?[1,1,1]:[0,0,0]),n.pbrMetallicRoughness){n.pbrMetallicRoughness={...n.pbrMetallicRoughness};const e=n.pbrMetallicRoughness;e.baseColorTexture&&(e.baseColorTexture={...e.baseColorTexture},e.baseColorTexture.texture=this.getTexture(e.baseColorTexture.index)),e.metallicRoughnessTexture&&(e.metallicRoughnessTexture={...e.metallicRoughnessTexture},e.metallicRoughnessTexture.texture=this.getTexture(e.metallicRoughnessTexture.index))}return n}_resolveAccessor(e,t){const n=(r=e.componentType,$[r]);var r;const i=(s=e.type,q[s]);var s;const o=n*i,a={...e,id:e.id||"accessor-"+t,bytesPerComponent:n,components:i,bytesPerElement:o,value:void 0,bufferView:void 0,sparse:void 0};if(void 0!==e.bufferView&&(a.bufferView=this.getBufferView(e.bufferView)),a.bufferView){const e=a.bufferView.buffer,{ArrayType:t,byteLength:n}=(0,z.pN)(a,a.bufferView),r=(a.bufferView.byteOffset||0)+(a.byteOffset||0)+e.byteOffset;let i=e.arrayBuffer.slice(r,r+n);a.bufferView.byteStride&&(i=this._getValueFromInterleavedBuffer(e,r,a.bufferView.byteStride,a.bytesPerElement,a.count)),a.value=new t(i)}return a}_getValueFromInterleavedBuffer(e,t,n,r,i){const s=new Uint8Array(i*r);for(let o=0;o<i;o++){const i=t+o*n;s.set(new Uint8Array(e.arrayBuffer.slice(i,i+r)),o*r)}return s.buffer}_resolveTexture(e,t){return{...e,id:e.id||"texture-"+t,sampler:"number"==typeof e.sampler?this.getSampler(e.sampler):{id:"default-sampler",parameters:oe},source:"number"==typeof e.source?this.getImage(e.source):void 0}}_resolveSampler(e,t){const n={id:e.id||"sampler-"+t,...e,parameters:{}};for(const r in n){const e=this._enumSamplerParameter(r);void 0!==e&&(n.parameters[e]=n[r])}return n}_enumSamplerParameter(e){return se[e]}_resolveImage(e,t){const n={...e,id:e.id||"image-"+t,image:null,bufferView:void 0!==e.bufferView?this.getBufferView(e.bufferView):void 0},r=this.images[t];return r&&(n.image=r),n}_resolveBufferView(e,t){const n=e.buffer,r=this.buffers[n].arrayBuffer;let i=this.buffers[n].byteOffset||0;e.byteOffset&&(i+=e.byteOffset);return{id:"bufferView-"+t,...e,buffer:this.buffers[n],data:new Uint8Array(r,i,e.byteLength)}}_resolveCamera(e,t){const n={...e,id:e.id||"camera-"+t};return n.perspective,n.orthographic,n}}function le(e,t){return(new ae).postProcess(e,t)}var ce=n(28490),ue=n(25108);const de={URI:0,EMBEDDED:1};function he(e,t,n,r){e.rotateYtoZ=!0;const i=(e.byteOffset||0)+(e.byteLength||0)-n;if(0===i)throw new Error("glTF byte length must be greater than 0.");return e.gltfUpAxis=null!=r&&r["3d-tiles"]&&r["3d-tiles"].assetGltfUpAxis?r["3d-tiles"].assetGltfUpAxis:"Y",e.gltfArrayBuffer=(0,ce.qv)(t,n,i),e.gltfByteOffset=0,e.gltfByteLength=i,n%4==0||ue.warn(e.type+": embedded glb is not aligned to a 4-byte boundary."),(e.byteOffset||0)+(e.byteLength||0)}async function fe(e,t,n,r){const i=(null==n?void 0:n["3d-tiles"])||{};if(function(e,t,n){switch(t){case de.URI:if(e.gltfArrayBuffer){const t=new Uint8Array(e.gltfArrayBuffer,e.gltfByteOffset),n=(new TextDecoder).decode(t);e.gltfUrl=n.replace(/[\s\0]+$/,"")}delete e.gltfArrayBuffer,delete e.gltfByteOffset,delete e.gltfByteLength;break;case de.EMBEDDED:break;default:throw new Error("b3dm: Illegal glTF format field")}}(e,t),i.loadGLTF){if(!r)return;if(e.gltfUrl){const{fetch:t}=r,i=await t(e.gltfUrl,n);e.gltfArrayBuffer=await i.arrayBuffer(),e.gltfByteOffset=0}if(e.gltfArrayBuffer){const t=await(0,u.cr)(e.gltfArrayBuffer,Z.E,n,r);e.gltf=le(t),e.gpuMemoryUsageInBytes=(0,z.Xr)(e.gltf),delete e.gltfArrayBuffer,delete e.gltfByteOffset,delete e.gltfByteLength}}}async function Ae(e,t,n,r,i){var s;n=function(e,t,n,r,i){n=O(e,t,n),n=N(e,t,n),n=F(e,t,n),n=he(e,t,n,r);const s=new C(e.featureTableJson,e.featureTableBinary);return e.rtcCenter=s.getGlobalProperty("RTC_CENTER",d.GL.FLOAT,3),n}(e,t,n,r),await fe(e,de.EMBEDDED,r,i);const o=null==e||null==(s=e.gltf)?void 0:s.extensions;return o&&o.CESIUM_RTC&&(e.rtcCenter=o.CESIUM_RTC.center),n}var pe=n(80540),me=n(79108),Ce=n(85451),ge=n(98759);async function Be(e,t,n,r,i){return n=function(e,t,n,r,i){var s;if(n=O(e,t,n),1!==e.version)throw new Error("Instanced 3D Model version "+e.version+" is not supported");n=N(e,t,n);const o=new DataView(t);if(e.gltfFormat=o.getUint32(n,!0),n+=4,n=F(e,t,n),n=he(e,t,n,r),!(null!=e&&null!=(s=e.header)&&s.featureTableJsonByteLength)||0===e.header.featureTableJsonByteLength)throw new Error("i3dm parser: featureTableJsonByteLength is zero.");const a=new C(e.featureTableJson,e.featureTableBinary),l=a.getGlobalProperty("INSTANCES_LENGTH");if(a.featuresLength=l,!Number.isFinite(l))throw new Error("i3dm parser: INSTANCES_LENGTH must be defined");e.eastNorthUp=a.getGlobalProperty("EAST_NORTH_UP"),e.rtcCenter=a.getGlobalProperty("RTC_CENTER",d.GL.FLOAT,3);new D(e.batchTableJson,e.batchTableBinary,l);return function(e,t,n,r){const i=new Array(r),s=new h.Z,o=new h.Z,a=new h.Z,l=new h.Z,c=new pe.Z,u=new me.Z,f=new h.Z,A={},p=new Ce.Z,m=[],C=[],g=[],B=[];for(let h=0;h<r;h++){let n;if(t.hasProperty("POSITION"))n=t.getProperty("POSITION",d.GL.FLOAT,3,h,s);else if(t.hasProperty("POSITION_QUANTIZED")){n=t.getProperty("POSITION_QUANTIZED",d.GL.UNSIGNED_SHORT,3,h,s);const e=t.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",d.GL.FLOAT,3);if(!e)throw new Error("i3dm parser: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");const r=t.getGlobalProperty("QUANTIZED_VOLUME_SCALE",d.GL.FLOAT,3);if(!r)throw new Error("i3dm parser: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");const i=65535;for(let t=0;t<3;t++)n[t]=n[t]/i*r[t]+e[t]}if(!n)throw new Error("i3dm: POSITION or POSITION_QUANTIZED must be defined for each instance.");s.copy(n),A.translation=s,e.normalUp=t.getProperty("NORMAL_UP",d.GL.FLOAT,3,h,m),e.normalRight=t.getProperty("NORMAL_RIGHT",d.GL.FLOAT,3,h,C);const r=!1;if(e.normalUp){if(!e.normalRight)throw new Error("i3dm: Custom orientation requires both NORMAL_UP and NORMAL_RIGHT.");e.hasCustomOrientation=!0}else{if(e.octNormalUp=t.getProperty("NORMAL_UP_OCT32P",d.GL.UNSIGNED_SHORT,2,h,m),e.octNormalRight=t.getProperty("NORMAL_RIGHT_OCT32P",d.GL.UNSIGNED_SHORT,2,h,C),e.octNormalUp){if(!e.octNormalRight)throw new Error("i3dm: oct-encoded orientation requires NORMAL_UP_OCT32P and NORMAL_RIGHT_OCT32P");throw new Error("i3dm: oct-encoded orientation not implemented")}e.eastNorthUp?(ge.H.WGS84.eastNorthUpToFixedFrame(s,p),p.getRotationMatrix3(c)):c.identity()}r&&(l.copy(o).cross(a).normalize(),c.setColumn(0,o),c.setColumn(1,a),c.setColumn(2,l)),u.fromMatrix3(c),A.rotation=u,f.set(1,1,1);const _=t.getProperty("SCALE",d.GL.FLOAT,1,h,g);Number.isFinite(_)&&f.multiplyByScalar(_);const y=t.getProperty("SCALE_NON_UNIFORM",d.GL.FLOAT,3,h,m);y&&f.scale(y),A.scale=f;let E=t.getProperty("BATCH_ID",d.GL.UNSIGNED_SHORT,1,h,B);void 0===E&&(E=h);const T=(new Ce.Z).fromQuaternion(A.rotation);p.identity(),p.translate(A.translation),p.multiplyRight(T),p.scale(A.scale);const b=p.clone();i[h]={modelMatrix:b,batchId:E}}e.instances=i}(e,a,0,l),n}(e,t,n,r),await fe(e,e.gltfFormat||0,r,i),n}async function _e(e,t,n,r,i){switch(void 0===t&&(t=0),void 0===i&&(i={shape:"tile3d"}),i.byteOffset=t,i.type=function(e,t){void 0===t&&(t=0);const n=new DataView(e);return""+String.fromCharCode(n.getUint8(t+0))+String.fromCharCode(n.getUint8(t+1))+String.fromCharCode(n.getUint8(t+2))+String.fromCharCode(n.getUint8(t+3))}(e,t),i.type){case o.COMPOSITE:return await async function(e,t,n,r,i,s){n=O(e,t,n);const o=new DataView(t);for(e.tilesLength=o.getUint32(n,!0),n+=4,e.tiles=[];e.tiles.length<e.tilesLength&&(e.byteLength||0)-n>12;){const o={shape:"tile3d"};e.tiles.push(o),n=await s(t,n,r,i,o)}return n}(i,e,t,n,r,_e);case o.BATCHED_3D_MODEL:return await Ae(i,e,t,n,r);case o.GLTF:return await async function(e,t,n,r){var i,s;if(e.rotateYtoZ=!0,e.gltfUpAxis=null!=n&&null!=(i=n["3d-tiles"])&&i.assetGltfUpAxis?n["3d-tiles"].assetGltfUpAxis:"Y",null!=n&&null!=(s=n["3d-tiles"])&&s.loadGLTF){if(!r)return t.byteLength;const i=await(0,u.cr)(t,Z.E,n,r);e.gltf=le(i),e.gpuMemoryUsageInBytes=(0,z.Xr)(e.gltf)}else e.gltfArrayBuffer=t;return t.byteLength}(i,e,n,r);case o.INSTANCED_3D_MODEL:return await Be(i,e,t,n,r);case o.POINT_CLOUD:return await Q(i,e,t,n,r);default:throw new Error("3DTileLoader: unknown type "+i.type)}}async function ye(e,t,n,r){const i=Number.isFinite(t.bitstream)?t.bitstream:t.bufferView;if("number"!=typeof i)return;const s=e.bufferViews[i],o=e.buffers[s.buffer];if(null==r||!r.baseUrl)throw new Error("Url is not provided");if(!r.fetch)throw new Error("fetch is not provided");if(o.uri){const e=((null==r?void 0:r.baseUrl)||"")+"/"+o.uri,n=await r.fetch(e),i=await n.arrayBuffer();t.explicitBitstream=new Uint8Array(i,s.byteOffset,s.byteLength)}else t.explicitBitstream=new Uint8Array(n,s.byteOffset,s.byteLength)}function Ee(e){const t=new DataView(e);return t.getUint32(0,!0)+2**32*t.getUint32(4,!0)}const Te={id:"3d-tiles-subtree",name:"3D Tiles Subtree",module:"3d-tiles",version:s,extensions:["subtree"],mimeTypes:["application/octet-stream"],tests:["subtree"],parse:async function(e,t,n){if(1952609651!==new Uint32Array(e.slice(0,4))[0])throw new Error("Wrong subtree file magic number");if(1!==new Uint32Array(e.slice(4,8))[0])throw new Error("Wrong subtree file verson, must be 1");const r=Ee(e.slice(8,16)),i=new Uint8Array(e,24,r),s=new TextDecoder("utf8").decode(i),o=JSON.parse(s),a=Ee(e.slice(16,24));let l=new ArrayBuffer(0);if(a&&(l=e.slice(24+r)),await ye(o,o.tileAvailability,l,n),Array.isArray(o.contentAvailability))for(const c of o.contentAvailability)await ye(o,c,l,n);else await ye(o,o.contentAvailability,l,n);return await ye(o,o.childSubtreeAvailability,l,n),o},options:{}};var be=n(35889),Se=n(25811),we=n(20514),Re=n.n(we);const Ie=16;function De(e){"X"===e&&(e="");const t=e.padEnd(Ie,"0");return Re().fromString(t,!0,16)}var ve=n(36625);const Oe=3,Ge=61,Me=180/Math.PI;function xe(e,t,n){const r=1<<t;return[(e[0]+n[0])/r,(e[1]+n[1])/r]}function Ne(e){return e>=.5?1/3*(4*e*e-1):1/3*(1-4*(1-e)*(1-e))}function Fe(e){return[Ne(e[0]),Ne(e[1])]}function Pe(e,t){let[n,r]=t;switch(e){case 0:return[1,n,r];case 1:return[-n,1,r];case 2:return[-n,-r,1];case 3:return[-1,-r,-n];case 4:return[r,-1,-n];case 5:return[r,n,-1];default:throw new Error("Invalid face")}}function Le(e){let[t,n,r]=e;const i=Math.atan2(r,Math.sqrt(t*t+n*n));return[Math.atan2(n,t)*Me,i*Me]}function Ue(e,t,n,r){if(0===r){1===n&&(t[0]=e-1-t[0],t[1]=e-1-t[1]);const r=t[0];t[0]=t[1],t[1]=r}}function He(e){const t=function(e){if(e.indexOf("/")>0)return e;const t=De(e);return function(e){if(e.isZero())return"";let t=e.toString(2);for(;t.length<Oe+Ge;)t="0"+t;const n=t.lastIndexOf("1"),r=t.substring(0,3),i=t.substring(3,n),s=i.length/2,o=Re().fromString(r,!0,2).toString(10);let a="";if(0!==s)for(a=Re().fromString(i,!0,2).toString(4);a.length<s;)a="0"+a;return o+"/"+a}(t)}(e);return function(e){if(0===e.length)throw new Error("Invalid Hilbert quad key "+e);const t=e.split("/"),n=parseInt(t[0],10),r=t[1],i=r.length;let s=0;const o=[0,0];for(let a=i-1;a>=0;a--){s=i-a;const e=r[a];let t=0,n=0;"1"===e?n=1:"2"===e?(t=1,n=1):"3"===e&&(t=1);const l=Math.pow(2,s-1);Ue(l,o,t,n),o[0]+=l*t,o[1]+=l*n}if(n%2==1){const e=o[0];o[0]=o[1],o[1]=e}return{face:n,ij:o,level:s}}(t)}const Je=100;function Xe(e){const{face:t,ij:n,level:r}=e,i=[[0,0],[0,1],[1,1],[1,0],[0,0]],s=Math.max(1,Math.ceil(Je*Math.pow(2,-r))),o=new Float64Array(4*s*2+2);let a=0,l=0;for(let c=0;c<4;c++){const e=i[c].slice(0),u=i[c+1],d=(u[0]-e[0])/s,h=(u[1]-e[1])/s;for(let i=0;i<s;i++){e[0]+=d,e[1]+=h;const i=Le(Pe(t,Fe(xe(n,r,e))));Math.abs(i[1])>89.999&&(i[0]=l);const s=i[0]-l;i[0]+=s>180?-360:s<-180?360:0,o[a++]=i[0],o[a++]=i[1],l=i[0]}}return o[a++]=o[0],o[a++]=o[1],o}function je(e){if(e.length%2!=0)throw new Error("Invalid corners");const t=[],n=[];for(let r=0;r<e.length;r+=2)t.push(e[r]),n.push(e[r+1]);return t.sort(((e,t)=>e-t)),n.sort(((e,t)=>e-t)),{west:t[0],east:t[t.length-1],north:n[n.length-1],south:n[0]}}function ke(e,t){const n=(null==t?void 0:t.minimumHeight)||0,r=(null==t?void 0:t.maximumHeight)||0,i=function(e){let t;if(2===e.face||5===e.face){let n=null,r=0;for(let t=0;t<4;t++){const i=Xe(He(e.face+"/"+t));null==n&&(n=new Float64Array(4*i.length)),n.set(i,r),r+=i.length}t=je(n)}else t=je(Xe(e));return t}(He(e)),s=i.west,o=i.south,a=i.east,l=i.north,c=[];return c.push(new h.Z(s,l,n)),c.push(new h.Z(a,l,n)),c.push(new h.Z(a,o,n)),c.push(new h.Z(s,o,n)),c.push(new h.Z(s,l,r)),c.push(new h.Z(a,l,r)),c.push(new h.Z(a,o,r)),c.push(new h.Z(s,o,r)),c}function Ke(e){return function(e){const t=Fe(xe(e.ij,e.level,[.5,.5]));return Le(Pe(e.face,t))}(He(e))}function Ve(e){const t=e.token,n={minimumHeight:e.minimumHeight,maximumHeight:e.maximumHeight},r=ke(t,n),i=Ke(t),s=i[0],o=i[1],a=ge.H.WGS84.cartographicToCartesian([s,o,n.maximumHeight]),l=new h.Z(a[0],a[1],a[2]);r.push(l);const c=(0,ve.du)(r);return[...c.center,...c.halfAxes]}const Qe={QUADTREE:4,OCTREE:8};function Ze(e,t,n){if(null!=e&&e.box){const r=function(e,t){const n=function(e){return e.and(e.not().add(1))}(e).shiftRightUnsigned(2);return e.add(Re().fromNumber(2*t+1-4).multiply(n))}(De(e.s2VolumeInfo.token),t),i=function(e){if(e.isZero())return"X";let t=e.countTrailingZeros();t=(t-t%4)/4;const n=t;t*=4;const r=e.shiftRightUnsigned(t).toString(16).replace(/0+$/,"");return Array(17-n-r.length).join("0")+r}(r),s={...e.s2VolumeInfo};if(s.token=i,"OCTREE"===n){const t=e.s2VolumeInfo,n=t.maximumHeight-t.minimumHeight,r=n/2,i=t.minimumHeight+n/2;t.minimumHeight=i-r,t.maximumHeight=i+r}return{box:Ve(s),s2VolumeInfo:s}}}async function We(e){const{implicitOptions:t,parentData:n={mortonIndex:0,x:0,y:0,z:0},childIndex:r=0,globalData:i={level:0,mortonIndex:0,x:0,y:0,z:0},s2VolumeBox:s,loaderOptions:o}=e;let{subtree:a,level:l=0}=e;const{subdivisionScheme:c,subtreeLevels:u,maximumLevel:d,contentUrlTemplate:h,subtreesUriTemplate:f,basePath:A}=t,p={children:[],lodMetricValue:0,contentUrl:""};if(!d)return Se.ZP.once("Missing 'maximumLevel' or 'availableLevels' property. The subtree "+h+" won't be loaded..."),p;const m=l+i.level;if(m>d)return p;const C=Qe[c],g=Math.log2(C),B=1&r,_=r>>1&1,y=r>>2&1,E=(C**l-1)/(C-1);let T=qe(n.mortonIndex,r,g),b=E+T,S=qe(n.x,B,1),w=qe(n.y,_,1),R=qe(n.z,y,1),I=!1;l>=u&&(I=ze(a.childSubtreeAvailability,T));const D=qe(i.x,S,l*g),v=qe(i.y,w,l*g),O=qe(i.z,R,l*g);if(I){const e=$e(A+"/"+f,m,D,v,O);a=await(0,be.z)(e,Te,o),i.mortonIndex=T,i.x=S,i.y=w,i.z=R,i.level=l,T=0,b=0,S=0,w=0,R=0,l=0}if(!ze(a.tileAvailability,b))return p;ze(a.contentAvailability,b)&&(p.contentUrl=$e(h,m,D,v,O));const G=l+1,M={mortonIndex:T,x:S,y:w,z:R};for(let x=0;x<C;x++){const e=Ze(s,x,c),n=await We({subtree:a,implicitOptions:t,loaderOptions:o,parentData:M,childIndex:x,level:G,globalData:{...i},s2VolumeBox:e});if(n.contentUrl||n.children.length){const e=Ye(n,m+1,{childTileX:S,childTileY:w,childTileZ:R},t,s);p.children.push(e)}}return p}function ze(e,t){let n;return Array.isArray(e)?(n=e[0],e.length>1&&Se.ZP.once('Not supported extension "3DTILES_multiple_contents" has been detected')):n=e,"constant"in n?Boolean(n.constant):!!n.explicitBitstream&&function(e,t){const n=Math.floor(e/8),r=e%8;return 1==(t[n]>>r&1)}(t,n.explicitBitstream)}function Ye(e,t,n,r,i){const{basePath:s,refine:o,getRefine:a,lodMetricType:l,getTileType:c,rootLodMetricValue:u,rootBoundingVolume:d}=r,h=e.contentUrl&&e.contentUrl.replace(s+"/",""),f=u/2**t,A=function(e,t,n){if(t.region){const{childTileX:r,childTileY:i,childTileZ:s}=n,[o,a,l,c,u,d]=t.region,h=2**e,f=(l-o)/h,A=(c-a)/h,p=(d-u)/h,[m,C]=[o+f*r,o+f*(r+1)],[g,B]=[a+A*i,a+A*(i+1)],[_,y]=[u+p*s,u+p*(s+1)];return{region:[m,g,C,B,_,y]}}if(t.box)return t;throw new Error("Unsupported bounding volume type "+t)}(t,null!=i&&i.box?{box:i.box}:d,n);return{children:e.children,contentUrl:e.contentUrl,content:{uri:h},id:e.contentUrl,refine:a(o),type:c(e),lodMetricType:l,lodMetricValue:f,geometricError:f,transform:e.transform,boundingVolume:A}}function qe(e,t,n){return(e<<n)+t}function $e(e,t,n,r,i){const s=function(e){const t={};for(const n in e)t["{"+n+"}"]=e[n];return t}({level:t,x:n,y:r,z:i});return e.replace(/{level}|{x}|{y}|{z}/gi,(e=>s[e]))}function et(e,t){if(void 0===t&&(t=""),!t)return i.R7.EMPTY;const n=t.split("?")[0].split(".").pop();switch(n){case"pnts":return i.R7.POINTCLOUD;case"i3dm":case"b3dm":case"glb":case"gltf":return i.R7.SCENEGRAPH;default:return n||i.R7.EMPTY}}function tt(e){switch(e){case"REPLACE":case"replace":return i.F$.REPLACE;case"ADD":case"add":return i.F$.ADD;default:return e}}function nt(e,t){void 0===e&&(e="");if(/^[a-z][0-9a-z+.-]*:/i.test(t)){const n=new URL(e,t+"/");return decodeURI(n.toString())}return e.startsWith("/")?e:r.DB(t,e)}function rt(e,t){if(!e)return null;let n;if(e.content){var r;n=nt(e.content.uri||(null==(r=e.content)?void 0:r.url),t)}return{...e,id:n,contentUrl:n,lodMetricType:i.ci.GEOMETRIC_ERROR,lodMetricValue:e.geometricError,transformMatrix:e.transform,type:et(0,n),refine:tt(e.refine)}}async function it(e,t,n,r,s){var o,a,l;const{subdivisionScheme:c,maximumLevel:u,availableLevels:d,subtreeLevels:h,subtrees:{uri:f}}=r,A=nt($e(f,0,0,0,0),n),p=await(0,be.z)(A,Te,s),m=nt(null==(o=e.content)?void 0:o.uri,n),C=null==t||null==(a=t.root)?void 0:a.refine,g=e.geometricError,B=null==(l=e.boundingVolume.extensions)?void 0:l["3DTILES_bounding_volume_S2"];if(B){const t={box:Ve(B),s2VolumeInfo:B};e.boundingVolume=t}const _=e.boundingVolume,y={contentUrlTemplate:m,subtreesUriTemplate:f,subdivisionScheme:c,subtreeLevels:h,maximumLevel:Number.isFinite(d)?d-1:u,refine:C,basePath:n,lodMetricType:i.ci.GEOMETRIC_ERROR,rootLodMetricValue:g,rootBoundingVolume:_,getTileType:et,getRefine:tt};return await async function(e,t,n,r,s){if(!e)return null;const{children:o,contentUrl:a}=await We({subtree:n,implicitOptions:r,loaderOptions:s});let l,c=null;a&&(l=a,c={uri:a.replace(t+"/","")});const u={...e,id:l,contentUrl:l,lodMetricType:i.ci.GEOMETRIC_ERROR,lodMetricValue:e.geometricError,transformMatrix:e.transform,type:et(0,l),refine:tt(e.refine),content:c||e.content,children:o};return u}(e,n,p,y,s)}function st(e){var t;return(null==e||null==(t=e.extensions)?void 0:t["3DTILES_implicit_tiling"])||(null==e?void 0:e.implicitTiling)}const ot={id:"3d-tiles",name:"3D Tiles",module:"3d-tiles",version:s,extensions:["cmpt","pnts","b3dm","i3dm"],mimeTypes:["application/octet-stream"],tests:["cmpt","pnts","b3dm","i3dm"],parse:async function(e,t,n){void 0===t&&(t={});const s=t["3d-tiles"]||{};let o;o="auto"===s.isTileset?(null==n?void 0:n.url)&&-1!==n.url.indexOf(".json"):s.isTileset;return o?async function(e,t,n){var s;const o=JSON.parse((new TextDecoder).decode(e)),a=(null==n?void 0:n.url)||"",l=function(e){return r.XX(e)}(a),c=await async function(e,t,n){let r=null;const i=st(e.root);r=i&&e.root?await it(e.root,e,t,i,n):rt(e.root,t);const s=[];for(s.push(r);s.length>0;){const r=s.pop()||{},i=r.children||[],o=[];for(const a of i){const r=st(a);let i;i=r?await it(a,e,t,r,n):rt(a,t),i&&(o.push(i),s.push(i))}r.children=o}return r}(o,l,t||{}),u={...o,shape:"tileset3d",loader:ot,url:a,queryString:(null==n?void 0:n.queryString)||"",basePath:l,root:c||o.root,type:i.i3.TILES3D,lodMetricType:i.ci.GEOMETRIC_ERROR,lodMetricValue:(null==(s=o.root)?void 0:s.geometricError)||0};return u}(e,t,n):async function(e,t,n){const r={content:{shape:"tile3d",featureIds:null}},i=0;return await _e(e,i,t,n,r.content),r.content}(e,t,n)},options:{"3d-tiles":{loadGLTF:!0,decodeQuantizedPositions:!1,isTileset:"auto",assetGltfUpAxis:null}}}},54361:(e,t,n)=>{"use strict";n.d(t,{D0:()=>l,Ew:()=>c,Kn:()=>s,Lj:()=>u,Os:()=>h,Ss:()=>o,TW:()=>a,zH:()=>d});const r=e=>"boolean"==typeof e,i=e=>"function"==typeof e,s=e=>null!==e&&"object"==typeof e,o=e=>s(e)&&e.constructor==={}.constructor,a=e=>Boolean(e)&&"function"==typeof e[Symbol.iterator],l=e=>e&&"function"==typeof e[Symbol.asyncIterator],c=e=>"undefined"!=typeof Response&&e instanceof Response||e&&e.arrayBuffer&&e.text&&e.json,u=e=>"undefined"!=typeof Blob&&e instanceof Blob,d=e=>e&&"object"==typeof e&&e.isBuffer,h=e=>(e=>"undefined"!=typeof ReadableStream&&e instanceof ReadableStream||s(e)&&i(e.tee)&&i(e.cancel)&&i(e.getReader))(e)||(e=>s(e)&&i(e.read)&&i(e.pipe)&&r(e.readable))(e)},35889:(e,t,n)=>{"use strict";n.d(t,{z:()=>a});var r=n(54361),i=n(7386),s=n(61727),o=n(52291);async function a(e,t,n,a){let l,c;Array.isArray(t)||(0,i.C)(t)?(l=t,c=n):(l=[],c=t);const u=(0,s.b)(c);let d=e;return"string"==typeof e&&(d=await u(e)),(0,r.Lj)(e)&&(d=await u(e)),Array.isArray(l),await(0,o.Q)(d,l,c)}},52291:(e,t,n)=>{"use strict";n.d(t,{Q:()=>j});var r=n(56369);class i{terminate(){}}var s=n(67625);const o=new Map;function a(e){(0,s.h)(e.source&&!e.url||!e.source&&e.url);let t=o.get(e.source||e.url);return t||(e.url&&(t=function(e){if(!e.startsWith("http"))return e;return l((t=e,"try {\n  importScripts('"+t+"');\n} catch (error) {\n  console.error(error);\n  throw error;\n}"));var t}(e.url),o.set(e.url,t)),e.source&&(t=l(e.source),o.set(e.source,t))),(0,s.h)(t),t}function l(e){const t=new Blob([e],{type:"application/javascript"});return URL.createObjectURL(t)}function c(e,t,n){void 0===t&&(t=!0);const r=n||new Set;if(e){if(u(e))r.add(e);else if(u(e.buffer))r.add(e.buffer);else if(ArrayBuffer.isView(e));else if(t&&"object"==typeof e)for(const i in e)c(e[i],t,r)}else;return void 0===n?Array.from(r):[]}function u(e){return!!e&&(e instanceof ArrayBuffer||("undefined"!=typeof MessagePort&&e instanceof MessagePort||("undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas)))}var d=n(25108);const h=()=>{};class f{static isSupported(){return"undefined"!=typeof Worker&&r.jU||void 0!==i&&!r.jU}constructor(e){this.terminated=!1,this._loadableURL="";const{name:t,source:n,url:i}=e;(0,s.h)(n||i),this.name=t,this.source=n,this.url=i,this.onMessage=h,this.onError=e=>d.log(e),this.worker=r.jU?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=h,this.onError=h,this.worker.terminate(),this.terminated=!0}get isRunning(){return Boolean(this.onMessage)}postMessage(e,t){t=t||c(e),this.worker.postMessage(e,t)}_getErrorFromErrorEvent(e){let t="Failed to load ";return t+="worker "+this.name+" from "+this.url+". ",e.message&&(t+=e.message+" in "),e.lineno&&(t+=":"+e.lineno+":"+e.colno),new Error(t)}_createBrowserWorker(){this._loadableURL=a({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=e=>{e.data?this.onMessage(e.data):this.onError(new Error("No data received"))},e.onerror=e=>{this.onError(this._getErrorFromErrorEvent(e)),this.terminated=!0},e.onmessageerror=e=>d.error(e),e}_createNodeWorker(){let e;if(this.url){const t=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./"+this.url;e=new i(t,{eval:!1})}else{if(!this.source)throw new Error("no worker");e=new i(this.source,{eval:!0})}return e.on("message",(e=>{this.onMessage(e)})),e.on("error",(e=>{this.onError(e)})),e.on("exit",(e=>{})),e}}class A{constructor(e,t){this.isRunning=!0,this._resolve=()=>{},this._reject=()=>{},this.name=e,this.workerThread=t,this.result=new Promise(((e,t)=>{this._resolve=e,this._reject=t}))}postMessage(e,t){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:t})}done(e){(0,s.h)(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){(0,s.h)(this.isRunning),this.isRunning=!1,this._reject(e)}}var p=n(25108);class m{static isSupported(){return f.isSupported()}constructor(e){this.name="unnamed",this.maxConcurrency=1,this.maxMobileConcurrency=1,this.onDebug=()=>{},this.reuseWorkers=!0,this.props={},this.jobQueue=[],this.idleQueue=[],this.count=0,this.isDestroyed=!1,this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach((e=>e.destroy())),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},void 0!==e.name&&(this.name=e.name),void 0!==e.maxConcurrency&&(this.maxConcurrency=e.maxConcurrency),void 0!==e.maxMobileConcurrency&&(this.maxMobileConcurrency=e.maxMobileConcurrency),void 0!==e.reuseWorkers&&(this.reuseWorkers=e.reuseWorkers),void 0!==e.onDebug&&(this.onDebug=e.onDebug)}async startJob(e,t,n){void 0===t&&(t=(e,t,n)=>e.done(n)),void 0===n&&(n=(e,t)=>e.error(t));const r=new Promise((r=>(this.jobQueue.push({name:e,onMessage:t,onError:n,onStart:r}),this)));return this._startQueuedJob(),await r}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const t=this.jobQueue.shift();if(t){this.onDebug({message:"Starting job",name:t.name,workerThread:e,backlog:this.jobQueue.length});const r=new A(t.name,e);e.onMessage=e=>t.onMessage(r,e.type,e.payload),e.onError=e=>t.onError(r,e),t.onStart(r);try{await r.result}catch(n){p.error("Worker exception: "+n)}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){!r.jU||this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e=this.name.toLowerCase()+" (#"+this.count+" of "+this.maxConcurrency+")";return new f({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return r.tq?this.maxMobileConcurrency:this.maxConcurrency}}const C={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class g{static isSupported(){return f.isSupported()}static getWorkerFarm(e){return void 0===e&&(e={}),g._workerFarm=g._workerFarm||new g({}),g._workerFarm.setProps(e),g._workerFarm}constructor(e){this.workerPools=new Map,this.props={...C},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const t of this.workerPools.values())t.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:t,source:n,url:r}=e;let i=this.workerPools.get(t);return i||(i=new m({name:t,source:n,url:r}),i.setProps(this._getWorkerPoolProps()),this.workerPools.set(t,i)),i}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}var B=n(34329);var _=n(25108);async function y(e,t,n,i,o){const a=e.id,l=function(e,t){void 0===t&&(t={});const n=t[e.id]||{},i=r.jU?e.id+"-worker.js":e.id+"-worker-node.js";let o=n.workerUrl;if(o||"compression"!==e.id||(o=t.workerUrl),"test"===t._workerType&&(o="modules/"+e.module+"/dist/"+i),!o){let t=e.version;"latest"===t&&(t=B.e);const n=t?"@"+t:"";o="https://unpkg.com/@loaders.gl/"+e.module+n+"/dist/"+i}return(0,s.h)(o),o}(e,n),c=g.getWorkerFarm(n).getWorkerPool({name:a,url:l});n=JSON.parse(JSON.stringify(n)),i=JSON.parse(JSON.stringify(i||{}));const u=await c.startJob("process-on-worker",E.bind(null,o));u.postMessage("process",{input:t,options:n,context:i});const d=await u.result;return await d.result}async function E(e,t,n,r){switch(n){case"done":t.done(r);break;case"error":t.error(new Error(r.error));break;case"process":const{id:s,input:o,options:a}=r;try{const n=await e(o,a);t.postMessage("done",{id:s,result:n})}catch(i){const e=i instanceof Error?i.message:"unknown error";t.postMessage("error",{id:s,error:e})}break;default:_.warn("parse-with-worker unknown message "+n)}}var T=n(7386),b=n(54361),S=n(488),w=n(56525),R=n(78346);const I=262144;const D=262144;const v=1048576;var O=n(82282),G=n(7598);function M(e,t){return O.jU?async function*(e,t){const n=e.getReader();let r;try{for(;;){const e=r||n.read();null!=t&&t._streamReadAhead&&(r=n.read());const{done:i,value:s}=await e;if(i)return;yield(0,G.rJ)(s)}}catch(i){n.releaseLock()}}(e,t):async function*(e,t){for await(const n of e)yield(0,G.rJ)(n)}(e)}function x(e,t){if("string"==typeof e)return function*(e,t){const n=(null==t?void 0:t.chunkSize)||I;let r=0;const i=new TextEncoder;for(;r<e.length;){const t=Math.min(e.length-r,n),s=e.slice(r,r+t);r+=t,yield i.encode(s)}}(e,t);if(e instanceof ArrayBuffer)return function(e,t){return void 0===t&&(t={}),function*(){const{chunkSize:n=D}=t;let r=0;for(;r<e.byteLength;){const t=Math.min(e.byteLength-r,n),i=new ArrayBuffer(t),s=new Uint8Array(e,r,t);new Uint8Array(i).set(s),r+=t,yield i}}()}(e,t);if((0,b.Lj)(e))return async function*(e,t){const n=(null==t?void 0:t.chunkSize)||v;let r=0;for(;r<e.size;){const t=r+n,i=await e.slice(r,t).arrayBuffer();r=t,yield i}}(e,t);if((0,b.Os)(e))return M(e,t);if((0,b.Ew)(e)){return M(e.body,t)}throw new Error("makeIterator")}var N=n(46832);const F="Cannot convert supplied data type";async function P(e,t,n){const r=e instanceof ArrayBuffer||ArrayBuffer.isView(e);if("string"==typeof e||r)return function(e,t,n){if(t.text&&"string"==typeof e)return e;if((0,b.zH)(e)&&(e=e.buffer),e instanceof ArrayBuffer){const n=e;return t.text&&!t.binary?new TextDecoder("utf8").decode(n):n}if(ArrayBuffer.isView(e)){if(t.text&&!t.binary)return new TextDecoder("utf8").decode(e);let n=e.buffer;const r=e.byteLength||e.length;return 0===e.byteOffset&&r===n.byteLength||(n=n.slice(e.byteOffset,e.byteOffset+r)),n}throw new Error(F)}(e,t);if((0,b.Lj)(e)&&(e=await(0,N.L1)(e)),(0,b.Ew)(e)){const n=e;return await(0,N.mm)(n),t.binary?await n.arrayBuffer():await n.text()}if((0,b.Os)(e)&&(e=x(e,n)),(0,b.TW)(e)||(0,b.D0)(e))return(0,R.GZ)(e);throw new Error(F)}var L=n(61727),U=n(27346),H=n(80072);var J=n(86865),X=n(25939);async function j(e,t,n,i){!t||Array.isArray(t)||(0,T.C)(t)||(i=void 0,n=t,t=void 0),e=await e,n=n||{};const o=(0,J.vM)(e),a=function(e,t){if(e&&!Array.isArray(e))return e;let n;if(e&&(n=Array.isArray(e)?e:[e]),t&&t.loaders){const e=Array.isArray(t.loaders)?t.loaders:[t.loaders];n=n?[...n,...e]:e}return n&&n.length?n:void 0}(t,i),l=await(0,X.A)(e,a,n);return l?(i=function(e,t,n){if(n)return n;const r={fetch:(0,L.b)(t,e),...e};if(r.url){const e=(0,U.k)(r.url);r.baseUrl=e,r.queryString=(0,U.S)(r.url),r.filename=H.vB(e),r.baseUrl=H.XX(e)}return Array.isArray(r.loaders)||(r.loaders=null),r}({url:o,_parse:j,loaders:a},n=(0,S.GR)(n,l,a,o),i||null),await async function(e,t,n,i){if(function(e,t){void 0===t&&(t=B.q),(0,s.h)(e,"no worker provided");const n=e.version}(e),n=(0,w.N)(e.options,n),(0,b.Ew)(t)){const e=t,{ok:n,redirected:r,status:s,statusText:o,type:a,url:l}=e,c=Object.fromEntries(e.headers.entries());i.response={headers:c,ok:n,redirected:r,status:s,statusText:o,type:a,url:l}}t=await P(t,e,n);const o=e;if(o.parseTextSync&&"string"==typeof t)return o.parseTextSync(t,n,i);if(function(e,t){return!!g.isSupported()&&!!(r.jU||null!=t&&t._nodeWorkers)&&e.worker&&(null==t?void 0:t.worker)}(e,n))return await y(e,t,n,i,j);if(o.parseText&&"string"==typeof t)return await o.parseText(t,n,i);if(o.parse)return await o.parse(t,n,i);throw(0,s.h)(!o.parseSync),new Error(e.id+" loader - no parser found and worker is disabled")}(l,e,n,i)):null}},92859:(e,t,n)=>{"use strict";n.d(t,{fh:()=>o,kO:()=>a});var r=n(7386),i=n(488);const s=()=>{const e=(0,i.rx)();return e.loaderRegistry=e.loaderRegistry||[],e.loaderRegistry};function o(e){const t=s();e=Array.isArray(e)?e:[e];for(const n of e){const e=(0,r.T)(n);t.find((t=>e===t))||t.unshift(e)}}function a(){return s()}},25939:(e,t,n)=>{"use strict";n.d(t,{A:()=>h});var r=n(80072),i=n(28490),s=n(7386);const o=new(n(18686).Z)({id:"loaders.gl"});var a=n(86865),l=n(92859),c=n(54361),u=n(27346);const d=/\.([^.]+)$/;async function h(e,t,n,r){if(void 0===t&&(t=[]),!A(e))return null;let i=f(e,t,{...n,nothrow:!0},r);if(i)return i;if((0,c.Lj)(e)&&(i=f(e=await e.slice(0,10).arrayBuffer(),t,n,r)),!(i||null!=n&&n.nothrow))throw new Error(p(e));return i}function f(e,t,n,r){if(void 0===t&&(t=[]),!A(e))return null;if(t&&!Array.isArray(t))return(0,s.T)(t);let i=[];t&&(i=i.concat(t)),null!=n&&n.ignoreRegisteredLoaders||i.push(...(0,l.kO)()),function(e){for(const t of e)(0,s.T)(t)}(i);const c=function(e,t,n,r){const i=(0,a.vM)(e),s=(0,a.Ry)(e),l=(0,u.k)(i)||(null==r?void 0:r.url);let c=null,h="";null!=n&&n.mimeType&&(c=m(t,null==n?void 0:n.mimeType),h="match forced by supplied MIME type "+(null==n?void 0:n.mimeType));c=c||function(e,t){const n=t&&d.exec(t),r=n&&n[1];return r?function(e,t){t=t.toLowerCase();for(const n of e)for(const e of n.extensions)if(e.toLowerCase()===t)return n;return null}(e,r):null}(t,l),h=h||(c?"matched url "+l:""),c=c||m(t,s),h=h||(c?"matched MIME type "+s:""),c=c||function(e,t){if(!t)return null;for(const n of e)if("string"==typeof t){if(C(t,n))return n}else if(ArrayBuffer.isView(t)){if(g(t.buffer,t.byteOffset,n))return n}else if(t instanceof ArrayBuffer){if(g(t,0,n))return n}return null}(t,e),h=h||(c?"matched initial data "+B(e):""),null!=n&&n.fallbackMimeType&&(c=c||m(t,null==n?void 0:n.fallbackMimeType),h=h||(c?"matched fallback MIME type "+s:""));var f;h&&o.log(1,"selectLoader selected "+(null==(f=c)?void 0:f.name)+": "+h+".");return c}(e,i,n,r);if(!(c||null!=n&&n.nothrow))throw new Error(p(e));return c}function A(e){return!(e instanceof Response&&204===e.status)}function p(e){const t=(0,a.vM)(e),n=(0,a.Ry)(e);let i="No valid loader found (";i+=t?r.vB(t)+", ":"no url provided, ",i+="MIME type: "+(n?'"'+n+'"':"not provided")+", ";const s=e?B(e):"";return i+=s?' first bytes: "'+s+'"':"first bytes: not available",i+=")",i}function m(e,t){for(const n of e){if(n.mimeTypes&&n.mimeTypes.includes(t))return n;if(t==="application/x."+n.id)return n}return null}function C(e,t){if(t.testText)return t.testText(e);return(Array.isArray(t.tests)?t.tests:[t.tests]).some((t=>e.startsWith(t)))}function g(e,t,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some((n=>function(e,t,n,r){if(r instanceof ArrayBuffer)return(0,i.Xq)(r,e,r.byteLength);switch(typeof r){case"function":return r(e);case"string":return r===_(e,t,r.length);default:return!1}}(e,t,0,n)))}function B(e,t){if(void 0===t&&(t=5),"string"==typeof e)return e.slice(0,t);if(ArrayBuffer.isView(e))return _(e.buffer,e.byteOffset,t);if(e instanceof ArrayBuffer){return _(e,0,t)}return""}function _(e,t,n){if(e.byteLength<t+n)return"";const r=new DataView(e);let i="";for(let s=0;s<n;s++)i+=String.fromCharCode(r.getUint8(t+s));return i}},97737:(e,t,n)=>{"use strict";n.d(t,{dc:()=>s});var r=n(92730),i=n(46832);async function s(e,t){if("string"==typeof e){const i=(0,r.i3)(e);var n,s;if(function(e){return!function(e){return e.startsWith("http:")||e.startsWith("https:")}(e)&&!function(e){return e.startsWith("data:")}(e)}(i))if(null!=(n=globalThis.loaders)&&n.fetchNode)return null==(s=globalThis.loaders)?void 0:s.fetchNode(i,t);return await fetch(i,t)}return await(0,i.L1)(e)}},61727:(e,t,n)=>{"use strict";n.d(t,{b:()=>o});var r=n(54361),i=n(97737),s=n(488);function o(e,t){const n=(0,s.pm)(),o=e||n;return"function"==typeof o.fetch?o.fetch:(0,r.Kn)(o.fetch)?e=>(0,i.dc)(e,o.fetch):null!=t&&t.fetch?null==t?void 0:t.fetch:i.dc}},7386:(e,t,n)=>{"use strict";n.d(t,{C:()=>i,T:()=>s});var r=n(61573);function i(e){var t;if(!e)return!1;Array.isArray(e)&&(e=e[0]);return Array.isArray(null==(t=e)?void 0:t.extensions)}function s(e){var t,n;let s;return(0,r.h)(e,"null loader"),(0,r.h)(i(e),"invalid loader"),Array.isArray(e)&&(s=e[1],e=e[0],e={...e,options:{...e.options,...s}}),(null!=(t=e)&&t.parseTextSync||null!=(n=e)&&n.parseText)&&(e.text=!0),e.text||(e.binary=!0),e}},488:(e,t,n)=>{"use strict";n.d(t,{pm:()=>h,rx:()=>d,GR:()=>f});var r=n(54361),i=n(18686),s=n(25108);const o=new i.Z({id:"loaders.gl"});class a{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}var l=n(82282);const c={fetch:null,mimeType:void 0,nothrow:!1,log:new class{constructor(){this.console=s}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.console.log.bind(this.console,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.console.info.bind(this.console,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.console.warn.bind(this.console,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.console.error.bind(this.console,...t)}},useLocalLibraries:!1,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:l.jU,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},u={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function d(){globalThis.loaders=globalThis.loaders||{};const{loaders:e}=globalThis;return e._state=e._state||{},e._state}function h(){const e=d();return e.globalOptions=e.globalOptions||{...c},e.globalOptions}function f(e,t,n,r){return n=n||[],function(e,t){A(e,null,c,u,t);for(const n of t){const r=e&&e[n.id]||{},i=n.options&&n.options[n.id]||{},s=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};A(r,n.id,i,s,t)}}(e,n=Array.isArray(n)?n:[n]),m(t,e,r)}function A(e,t,n,i,s){const a=t||"Top level",l=t?t+".":"";for(const c in e){const u=!t&&(0,r.Kn)(e[c]);if(!(c in n)&&!("baseUri"===c&&!t)&&!("workerUrl"===c&&t))if(c in i)o.warn(a+" loader option '"+l+c+"' no longer supported, use '"+i[c]+"'")();else if(!u){const e=p(c,s);o.warn(a+" loader option '"+l+c+"' not recognized. "+e)()}}}function p(e,t){const n=e.toLowerCase();let r="";for(const i of t)for(const t in i.options){if(e===t)return"Did you mean '"+i.id+"."+t+"'?";const s=t.toLowerCase();(n.startsWith(s)||s.startsWith(n))&&(r=r||"Did you mean '"+i.id+"."+t+"'?")}return r}function m(e,t,n){const r={...e.options||{}};return function(e,t){t&&!("baseUri"in e)&&(e.baseUri=t)}(r,n),null===r.log&&(r.log=new a),C(r,h()),C(r,t),r}function C(e,t){for(const n in t)if(n in t){const i=t[n];(0,r.Ss)(i)&&(0,r.Ss)(e[n])?e[n]={...e[n],...t[n]}:e[n]=t[n]}}},86865:(e,t,n)=>{"use strict";n.d(t,{Cu:()=>u,Ry:()=>c,vM:()=>l});var r=n(54361);const i=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,s=/^([-\w.]+\/[-\w.+]+)/;function o(e){const t=i.exec(e);return t?t[1]:""}var a=n(27346);function l(e){if((0,r.Ew)(e)){return e.url}if((0,r.Lj)(e)){return e.name||""}return"string"==typeof e?e:""}function c(e){if((0,r.Ew)(e)){const t=e,n=t.headers.get("content-type")||"",r=(0,a.k)(t.url);return function(e){const t=s.exec(e);return t?t[1]:e}(n)||o(r)}if((0,r.Lj)(e)){return e.type||""}return"string"==typeof e?o(e):""}function u(e){if((0,r.Ew)(e)){return e.headers["content-length"]||-1}if((0,r.Lj)(e)){return e.size}return"string"==typeof e?e.length:e instanceof ArrayBuffer||ArrayBuffer.isView(e)?e.byteLength:-1}},46832:(e,t,n)=>{"use strict";n.d(t,{L1:()=>s,mm:()=>o});var r=n(54361),i=n(86865);async function s(e){if((0,r.Ew)(e))return e;const t={},n=(0,i.Cu)(e);n>=0&&(t["content-length"]=String(n));const s=(0,i.vM)(e),o=(0,i.Ry)(e);o&&(t["content-type"]=o);const a=await async function(e){const t=5;if("string"==typeof e)return"data:,"+e.slice(0,t);if(e instanceof Blob){const t=e.slice(0,5);return await new Promise((e=>{const n=new FileReader;n.onload=t=>{var n;return e(null==t||null==(n=t.target)?void 0:n.result)},n.readAsDataURL(t)}))}if(e instanceof ArrayBuffer){return"data:base64,"+function(e){let t="";const n=new Uint8Array(e);for(let r=0;r<n.byteLength;r++)t+=String.fromCharCode(n[r]);return btoa(t)}(e.slice(0,t))}return null}(e);a&&(t["x-first-bytes"]=a),"string"==typeof e&&(e=(new TextEncoder).encode(e));const l=new Response(e,{headers:t});return Object.defineProperty(l,"url",{value:s}),l}async function o(e){if(!e.ok){const t=await async function(e){let t="Failed to fetch resource "+e.url+" ("+e.status+"): ";try{const n=e.headers.get("Content-Type");let r=e.statusText;null!=n&&n.includes("application/json")&&(r+=" "+await e.text()),t+=r,t=t.length>60?t.slice(0,60)+"...":t}catch(n){}return t}(e);throw new Error(t)}}},27346:(e,t,n)=>{"use strict";n.d(t,{S:()=>i,k:()=>s});const r=/\?.*/;function i(e){const t=e.match(r);return t&&t[0]}function s(e){return e.replace(r,"")}},76075:(e,t,n)=>{"use strict";n.d(t,{VJ:()=>g});const r="undefined"!=typeof __VERSION__?__VERSION__:"latest",i={name:"Draco",id:"draco",module:"draco",version:r,worker:!0,extensions:["drc"],mimeTypes:["application/octet-stream"],binary:!0,tests:["DRACO"],options:{draco:{decoderType:"object"==typeof WebAssembly?"wasm":"js",libraryPath:"libs/",extraAttributes:{},attributeNameEntry:void 0}}};var s=n(9231),o=n(65293);function a(e,t,n){const r=n?l(n.metadata):void 0;return(0,o.ou)(e,t,r)}function l(e){Object.entries(e);const t={};for(const n in e)t[n+".string"]=JSON.stringify(e[n]);return t}const c={POSITION:"POSITION",NORMAL:"NORMAL",COLOR:"COLOR_0",TEX_COORD:"TEXCOORD_0"},u={1:Int8Array,2:Uint8Array,3:Int16Array,4:Uint16Array,5:Int32Array,6:Uint32Array,9:Float32Array};class d{constructor(e){this.draco=e,this.decoder=new this.draco.Decoder,this.metadataQuerier=new this.draco.MetadataQuerier}destroy(){this.draco.destroy(this.decoder),this.draco.destroy(this.metadataQuerier)}parseSync(e,t){void 0===t&&(t={});const n=new this.draco.DecoderBuffer;n.Init(new Int8Array(e),e.byteLength),this._disableAttributeTransforms(t);const r=this.decoder.GetEncodedGeometryType(n),i=r===this.draco.TRIANGULAR_MESH?new this.draco.Mesh:new this.draco.PointCloud;try{let e;switch(r){case this.draco.TRIANGULAR_MESH:e=this.decoder.DecodeBufferToMesh(n,i);break;case this.draco.POINT_CLOUD:e=this.decoder.DecodeBufferToPointCloud(n,i);break;default:throw new Error("DRACO: Unknown geometry type.")}if(!e.ok()||!i.ptr){const t="DRACO decompression failed: "+e.error_msg();throw new Error(t)}const o=this._getDracoLoaderData(i,r,t),c=this._getMeshData(i,o,t),u=(0,s.v)(c.attributes),d=function(e,t,n){const r=l(t.metadata),i=[],s=function(e){const t={};for(const n in e){const r=e[n];t[r.name||"undefined"]=r}return t}(t.attributes);for(const o in e){const t=a(o,e[o],s[o]);i.push(t)}if(n){const e=a("indices",n);i.push(e)}return{fields:i,metadata:r}}(c.attributes,o,c.indices);return{loader:"draco",loaderData:o,header:{vertexCount:i.num_points(),boundingBox:u},...c,schema:d}}finally{this.draco.destroy(n),i&&this.draco.destroy(i)}}_getDracoLoaderData(e,t,n){const r=this._getTopLevelMetadata(e),i=this._getDracoAttributes(e,n);return{geometry_type:t,num_attributes:e.num_attributes(),num_points:e.num_points(),num_faces:e instanceof this.draco.Mesh?e.num_faces():0,metadata:r,attributes:i}}_getDracoAttributes(e,t){const n={};for(let r=0;r<e.num_attributes();r++){const i=this.decoder.GetAttribute(e,r),s=this._getAttributeMetadata(e,r);n[i.unique_id()]={unique_id:i.unique_id(),attribute_type:i.attribute_type(),data_type:i.data_type(),num_components:i.num_components(),byte_offset:i.byte_offset(),byte_stride:i.byte_stride(),normalized:i.normalized(),attribute_index:r,metadata:s};const o=this._getQuantizationTransform(i,t);o&&(n[i.unique_id()].quantization_transform=o);const a=this._getOctahedronTransform(i,t);a&&(n[i.unique_id()].octahedron_transform=a)}return n}_getMeshData(e,t,n){const r=this._getMeshAttributes(t,e,n);if(!r.POSITION)throw new Error("DRACO: No position attribute found.");return e instanceof this.draco.Mesh?"triangle-strip"===n.topology?{topology:"triangle-strip",mode:4,attributes:r,indices:{value:this._getTriangleStripIndices(e),size:1}}:{topology:"triangle-list",mode:5,attributes:r,indices:{value:this._getTriangleListIndices(e),size:1}}:{topology:"point-list",mode:0,attributes:r}}_getMeshAttributes(e,t,n){const r={};for(const i of Object.values(e.attributes)){const e=this._deduceAttributeName(i,n);i.name=e;const{value:s,size:o}=this._getAttributeValues(t,i);r[e]={value:s,size:o,byteOffset:i.byte_offset,byteStride:i.byte_stride,normalized:i.normalized}}return r}_getTriangleListIndices(e){const t=3*e.num_faces(),n=4*t,r=this.draco._malloc(n);try{return this.decoder.GetTrianglesUInt32Array(e,n,r),new Uint32Array(this.draco.HEAPF32.buffer,r,t).slice()}finally{this.draco._free(r)}}_getTriangleStripIndices(e){const t=new this.draco.DracoInt32Array;try{return this.decoder.GetTriangleStripsFromMesh(e,t),function(e){const t=e.size(),n=new Int32Array(t);for(let r=0;r<t;r++)n[r]=e.GetValue(r);return n}(t)}finally{this.draco.destroy(t)}}_getAttributeValues(e,t){const n=u[t.data_type],r=t.num_components,i=e.num_points()*r,s=i*n.BYTES_PER_ELEMENT,o=function(e,t){switch(t){case Float32Array:return e.DT_FLOAT32;case Int8Array:return e.DT_INT8;case Int16Array:return e.DT_INT16;case Int32Array:return e.DT_INT32;case Uint8Array:return e.DT_UINT8;case Uint16Array:return e.DT_UINT16;case Uint32Array:return e.DT_UINT32;default:return e.DT_INVALID}}(this.draco,n);let a;const l=this.draco._malloc(s);try{const r=this.decoder.GetAttribute(e,t.attribute_index);this.decoder.GetAttributeDataArrayForAllPoints(e,r,o,s,l),a=new n(this.draco.HEAPF32.buffer,l,i).slice()}finally{this.draco._free(l)}return{value:a,size:r}}_deduceAttributeName(e,t){const n=e.unique_id;for(const[s,o]of Object.entries(t.extraAttributes||{}))if(o===n)return s;const r=e.attribute_type;for(const s in c){if(this.draco[s]===r)return c[s]}const i=t.attributeNameEntry||"name";return e.metadata[i]?e.metadata[i].string:"CUSTOM_ATTRIBUTE_"+n}_getTopLevelMetadata(e){const t=this.decoder.GetMetadata(e);return this._getDracoMetadata(t)}_getAttributeMetadata(e,t){const n=this.decoder.GetAttributeMetadata(e,t);return this._getDracoMetadata(n)}_getDracoMetadata(e){if(!e||!e.ptr)return{};const t={},n=this.metadataQuerier.NumEntries(e);for(let r=0;r<n;r++){const n=this.metadataQuerier.GetEntryName(e,r);t[n]=this._getDracoMetadataField(e,n)}return t}_getDracoMetadataField(e,t){const n=new this.draco.DracoInt32Array;try{this.metadataQuerier.GetIntEntryArray(e,t,n);const r=function(e){const t=e.size(),n=new Int32Array(t);for(let r=0;r<t;r++)n[r]=e.GetValue(r);return n}(n);return{int:this.metadataQuerier.GetIntEntry(e,t),string:this.metadataQuerier.GetStringEntry(e,t),double:this.metadataQuerier.GetDoubleEntry(e,t),intArray:r}}finally{this.draco.destroy(n)}}_disableAttributeTransforms(e){const{quantizedAttributes:t=[],octahedronAttributes:n=[]}=e,r=[...t,...n];for(const i of r)this.decoder.SkipAttributeTransform(this.draco[i])}_getQuantizationTransform(e,t){const{quantizedAttributes:n=[]}=t,r=e.attribute_type();if(n.map((e=>this.decoder[e])).includes(r)){const t=new this.draco.AttributeQuantizationTransform;try{if(t.InitFromAttribute(e))return{quantization_bits:t.quantization_bits(),range:t.range(),min_values:new Float32Array([1,2,3]).map((e=>t.min_value(e)))}}finally{this.draco.destroy(t)}}return null}_getOctahedronTransform(e,t){const{octahedronAttributes:n=[]}=t,r=e.attribute_type();if(n.map((e=>this.decoder[e])).includes(r)){const t=new this.draco.AttributeQuantizationTransform;try{if(t.InitFromAttribute(e))return{quantization_bits:t.quantization_bits()}}finally{this.draco.destroy(t)}}return null}}var h=n(94236);const f="https://www.gstatic.com/draco/versioned/decoders/1.5.6",A={DECODER:"draco_wasm_wrapper.js",DECODER_WASM:"draco_decoder.wasm",FALLBACK_DECODER:"draco_decoder.js",ENCODER:"draco_encoder.js"},p={[A.DECODER]:f+"/"+A.DECODER,[A.DECODER_WASM]:f+"/"+A.DECODER_WASM,[A.FALLBACK_DECODER]:f+"/"+A.FALLBACK_DECODER,[A.ENCODER]:"https://raw.githubusercontent.com/google/draco/1.4.1/javascript/"+A.ENCODER};let m;async function C(e){const t=e.modules||{};return m=t.draco3d?m||t.draco3d.createDecoderModule({}).then((e=>({draco:e}))):m||async function(e){let t,n;if("js"===(e.draco&&e.draco.decoderType))t=await(0,h.Y)(p[A.FALLBACK_DECODER],"draco",e,A.FALLBACK_DECODER);else[t,n]=await Promise.all([await(0,h.Y)(p[A.DECODER],"draco",e,A.DECODER),await(0,h.Y)(p[A.DECODER_WASM],"draco",e,A.DECODER_WASM)]);return t=t||globalThis.DracoDecoderModule,await function(e,t){const n={};t&&(n.wasmBinary=t);return new Promise((t=>{e({...n,onModuleLoaded:e=>t({draco:e})})}))}(t,n)}(e),await m}const g={...i,parse:async function(e,t){const{draco:n}=await C(t),r=new d(n);try{return r.parseSync(e,null==t?void 0:t.draco)}finally{r.destroy()}}}},91098:(e,t,n)=>{"use strict";n.d(t,{E:()=>Jt});var r={};n.r(r),n.d(r,{decode:()=>se,name:()=>ie});var i={};n.r(i),n.d(i,{decode:()=>ce,name:()=>le});var s={};n.r(s),n.d(s,{decode:()=>De,name:()=>Ie});var o={};n.r(o),n.d(o,{name:()=>Fe,preprocess:()=>Pe});var a={};n.r(a),n.d(a,{name:()=>Ue,preprocess:()=>He});var l={};n.r(l),n.d(l,{decode:()=>Ve,encode:()=>Qe,name:()=>ke,preprocess:()=>Ke});var c={};n.r(c),n.d(c,{decode:()=>st,name:()=>tt});var u={};n.r(u),n.d(u,{decode:()=>dt,encode:()=>ht,name:()=>ut});var d={};n.r(d),n.d(d,{decode:()=>pt,encode:()=>mt,name:()=>At});var h={};n.r(h),n.d(h,{decode:()=>Bt,encode:()=>_t,name:()=>gt});var f={};n.r(f),n.d(f,{decode:()=>bt,name:()=>Tt});const A="undefined"!=typeof __VERSION__?__VERSION__:"latest";function p(e,t,n){if(e.byteLength<=t+n)return"";const r=new DataView(e);let i="";for(let s=0;s<n;s++)i+=String.fromCharCode(r.getUint8(t+s));return i}function m(e){try{return JSON.parse(e)}catch(t){throw new Error('Failed to parse JSON from data starting with "'+function(e,t){if(void 0===t&&(t=5),"string"==typeof e)return e.slice(0,t);if(ArrayBuffer.isView(e))return p(e.buffer,e.byteOffset,t);if(e instanceof ArrayBuffer)return p(e,0,t);return""}(e)+'"')}}var C=n(28490),g=n(93203),B=n(48093),_=n(30202),y=n(33313),E=n(4183),T=n(61573);function b(e,t){return(0,T.h)(e>=0),(0,T.h)(t>0),e+(t-1)&~(t-1)}function S(e,t,n){let r;if(e instanceof ArrayBuffer)r=new Uint8Array(e);else{const t=e.byteOffset,n=e.byteLength;r=new Uint8Array(e.buffer||e.arrayBuffer,t,n)}return t.set(r,n),n+b(r.byteLength,4)}const w=!0,R=1735152710,I=12,D=8,v=1313821514,O=5130562,G=0,M=0,x=1;function N(e,t,n,r){void 0===n&&(n=0),void 0===r&&(r={});const i=new DataView(t),s=function(e,t){return void 0===t&&(t=0),""+String.fromCharCode(e.getUint8(t+0))+String.fromCharCode(e.getUint8(t+1))+String.fromCharCode(e.getUint8(t+2))+String.fromCharCode(e.getUint8(t+3))}(i,n+0),o=i.getUint32(n+4,w),a=i.getUint32(n+8,w);switch(Object.assign(e,{header:{byteOffset:n,byteLength:a,hasBinChunk:!1},type:s,version:o,json:{},binChunks:[]}),n+=I,e.version){case 1:return function(e,t,n){(0,T.h)(e.header.byteLength>I+D);const r=t.getUint32(n+0,w),i=t.getUint32(n+4,w);return n+=D,(0,T.h)(i===G),F(e,t,n,r),n+=r,n+=P(e,t,n,e.header.byteLength),n}(e,i,n);case 2:return function(e,t,n,r){return(0,T.h)(e.header.byteLength>I+D),function(e,t,n,r){for(;n+8<=e.header.byteLength;){const i=t.getUint32(n+0,w),s=t.getUint32(n+4,w);switch(n+=D,s){case v:F(e,t,n,i);break;case O:P(e,t,n,i);break;case M:r.strict||F(e,t,n,i);break;case x:r.strict||P(e,t,n,i)}n+=b(i,4)}}(e,t,n,r),n+e.header.byteLength}(e,i,n,r={});default:throw new Error("Invalid GLB version "+e.version+". Only supports version 1 and 2.")}}function F(e,t,n,r){const i=new Uint8Array(t.buffer,n,r),s=new TextDecoder("utf8").decode(i);return e.json=JSON.parse(s),b(r,4)}function P(e,t,n,r){return e.header.hasBinChunk=!0,e.binChunks.push({byteOffset:n,byteLength:r,arrayBuffer:t.buffer}),b(r,4)}function L(e,t){if(e.startsWith("data:")||e.startsWith("http:")||e.startsWith("https:"))return e;const n=t.baseUri||t.uri;if(!n)throw new Error("'baseUri' must be provided to resolve relative url "+e);return n.substr(0,n.lastIndexOf("/")+1)+e}var U=n(79054);function H(e,t,n){const r=e.bufferViews[n];(0,E.h)(r);const i=t[r.buffer];(0,E.h)(i);const s=(r.byteOffset||0)+i.byteOffset;return new Uint8Array(i.arrayBuffer,s,r.byteLength)}var J=n(98746);class X{constructor(e){this.gltf={json:(null==e?void 0:e.json)||{asset:{version:"2.0",generator:"loaders.gl"},buffers:[],extensions:{},extensionsRequired:[],extensionsUsed:[]},buffers:(null==e?void 0:e.buffers)||[],images:(null==e?void 0:e.images)||[]},this.sourceBuffers=[],this.byteLength=0,this.gltf.buffers&&this.gltf.buffers[0]&&(this.byteLength=this.gltf.buffers[0].byteLength,this.sourceBuffers=[this.gltf.buffers[0]])}get json(){return this.gltf.json}getApplicationData(e){return this.json[e]}getExtraData(e){return(this.json.extras||{})[e]}hasExtension(e){const t=this.getUsedExtensions().find((t=>t===e)),n=this.getRequiredExtensions().find((t=>t===e));return"string"==typeof t||"string"==typeof n}getExtension(e){const t=this.getUsedExtensions().find((t=>t===e)),n=this.json.extensions||{};return t?n[e]:null}getRequiredExtension(e){return this.getRequiredExtensions().find((t=>t===e))?this.getExtension(e):null}getRequiredExtensions(){return this.json.extensionsRequired||[]}getUsedExtensions(){return this.json.extensionsUsed||[]}getRemovedExtensions(){return this.json.extensionsRemoved||[]}getObjectExtension(e,t){return(e.extensions||{})[t]}getScene(e){return this.getObject("scenes",e)}getNode(e){return this.getObject("nodes",e)}getSkin(e){return this.getObject("skins",e)}getMesh(e){return this.getObject("meshes",e)}getMaterial(e){return this.getObject("materials",e)}getAccessor(e){return this.getObject("accessors",e)}getTexture(e){return this.getObject("textures",e)}getSampler(e){return this.getObject("samplers",e)}getImage(e){return this.getObject("images",e)}getBufferView(e){return this.getObject("bufferViews",e)}getBuffer(e){return this.getObject("buffers",e)}getObject(e,t){if("object"==typeof t)return t;const n=this.json[e]&&this.json[e][t];if(!n)throw new Error("glTF file error: Could not find "+e+"["+t+"]");return n}getTypedArrayForBufferView(e){const t=(e=this.getBufferView(e)).buffer,n=this.gltf.buffers[t];(0,E.h)(n);const r=(e.byteOffset||0)+n.byteOffset;return new Uint8Array(n.arrayBuffer,r,e.byteLength)}getTypedArrayForAccessor(e){const t=this.getAccessor(e);return function(e,t,n){var r,i;const s="number"==typeof n?null==(r=e.accessors)?void 0:r[n]:n;if(!s)throw new Error("No gltf accessor "+n);const o=null==(i=e.bufferViews)?void 0:i[s.bufferView||0];if(!o)throw new Error("No gltf buffer view for accessor "+o);const{arrayBuffer:a,byteOffset:l}=t[o.buffer],c=(l||0)+(s.byteOffset||0)+(o.byteOffset||0),{ArrayType:u,length:d,componentByteSize:h,numberOfComponentsInElement:f}=(0,U.pN)(s,o),A=h*f,p=o.byteStride||A;if(void 0===o.byteStride||o.byteStride===A)return new u(a,c,d);const m=new u(d);for(let C=0;C<s.count;C++){const e=new u(a,c+C*p,f);m.set(e,C*f)}return m}(this.gltf.json,this.gltf.buffers,t)}getTypedArrayForImageData(e){e=this.getAccessor(e);const t=this.getBufferView(e.bufferView),n=this.getBuffer(t.buffer).data,r=t.byteOffset||0;return new Uint8Array(n,r,t.byteLength)}addApplicationData(e,t){return this.json[e]=t,this}addExtraData(e,t){return this.json.extras=this.json.extras||{},this.json.extras[e]=t,this}addObjectExtension(e,t,n){return e.extensions=e.extensions||{},e.extensions[t]=n,this.registerUsedExtension(t),this}setObjectExtension(e,t,n){(e.extensions||{})[t]=n}removeObjectExtension(e,t){const n=(null==e?void 0:e.extensions)||{};if(n[t]){this.json.extensionsRemoved=this.json.extensionsRemoved||[];const e=this.json.extensionsRemoved;e.includes(t)||e.push(t)}delete n[t]}addExtension(e,t){return void 0===t&&(t={}),(0,E.h)(t),this.json.extensions=this.json.extensions||{},this.json.extensions[e]=t,this.registerUsedExtension(e),t}addRequiredExtension(e,t){return void 0===t&&(t={}),(0,E.h)(t),this.addExtension(e,t),this.registerRequiredExtension(e),t}registerUsedExtension(e){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find((t=>t===e))||this.json.extensionsUsed.push(e)}registerRequiredExtension(e){this.registerUsedExtension(e),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find((t=>t===e))||this.json.extensionsRequired.push(e)}removeExtension(e){var t;if(null!=(t=this.json.extensions)&&t[e]){this.json.extensionsRemoved=this.json.extensionsRemoved||[];const t=this.json.extensionsRemoved;t.includes(e)||t.push(e)}this.json.extensions&&delete this.json.extensions[e],this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,e),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,e)}setDefaultScene(e){this.json.scene=e}addScene(e){const{nodeIndices:t}=e;return this.json.scenes=this.json.scenes||[],this.json.scenes.push({nodes:t}),this.json.scenes.length-1}addNode(e){const{meshIndex:t,matrix:n}=e;this.json.nodes=this.json.nodes||[];const r={mesh:t};return n&&(r.matrix=n),this.json.nodes.push(r),this.json.nodes.length-1}addMesh(e){const{attributes:t,indices:n,material:r,mode:i=4}=e,s={primitives:[{attributes:this._addAttributes(t),mode:i}]};if(n){const e=this._addIndices(n);s.primitives[0].indices=e}return Number.isFinite(r)&&(s.primitives[0].material=r),this.json.meshes=this.json.meshes||[],this.json.meshes.push(s),this.json.meshes.length-1}addPointCloud(e){const t={primitives:[{attributes:this._addAttributes(e),mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(t),this.json.meshes.length-1}addImage(e,t){const n=(0,J.I)(e),r=t||(null==n?void 0:n.mimeType),i={bufferView:this.addBufferView(e),mimeType:r};return this.json.images=this.json.images||[],this.json.images.push(i),this.json.images.length-1}addBufferView(e,t,n){void 0===t&&(t=0),void 0===n&&(n=this.byteLength);const r=e.byteLength;(0,E.h)(Number.isFinite(r)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(e);const i={buffer:t,byteOffset:n,byteLength:r};return this.byteLength+=b(r,4),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(i),this.json.bufferViews.length-1}addAccessor(e,t){const n={bufferView:e,type:(0,U.dl)(t.size),componentType:t.componentType,count:t.count,max:t.max,min:t.min};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(n),this.json.accessors.length-1}addBinaryBuffer(e,t){void 0===t&&(t={size:3});const n=this.addBufferView(e);let r={min:t.min,max:t.max};r.min&&r.max||(r=this._getAccessorMinMax(e,t.size));const i={size:t.size,componentType:(0,U.x$)(e),count:Math.round(e.length/t.size),min:r.min,max:r.max};return this.addAccessor(n,Object.assign(i,t))}addTexture(e){const{imageIndex:t}=e,n={source:t};return this.json.textures=this.json.textures||[],this.json.textures.push(n),this.json.textures.length-1}addMaterial(e){return this.json.materials=this.json.materials||[],this.json.materials.push(e),this.json.materials.length-1}createBinaryChunk(){var e,t;this.gltf.buffers=[];const n=this.byteLength,r=new ArrayBuffer(n),i=new Uint8Array(r);let s=0;for(const o of this.sourceBuffers||[])s=S(o,i,s);null!=(e=this.json)&&null!=(t=e.buffers)&&t[0]?this.json.buffers[0].byteLength=n:this.json.buffers=[{byteLength:n}],this.gltf.binary=r,this.sourceBuffers=[r]}_removeStringFromArray(e,t){let n=!0;for(;n;){const r=e.indexOf(t);r>-1?e.splice(r,1):n=!1}}_addAttributes(e){void 0===e&&(e={});const t={};for(const n in e){const r=e[n],i=this._getGltfAttributeName(n),s=this.addBinaryBuffer(r.value,r);t[i]=s}return t}_addIndices(e){return this.addBinaryBuffer(e,{size:1})}_getGltfAttributeName(e){switch(e.toLowerCase()){case"position":case"positions":case"vertices":return"POSITION";case"normal":case"normals":return"NORMAL";case"color":case"colors":return"COLOR_0";case"texcoord":case"texcoords":return"TEXCOORD_0";default:return e}}_getAccessorMinMax(e,t){const n={min:null,max:null};if(e.length<t)return n;n.min=[],n.max=[];const r=e.subarray(0,t);for(const i of r)n.min.push(i),n.max.push(i);for(let i=t;i<e.length;i+=t)for(let r=0;r<t;r++)n.min[0+r]=Math.min(n.min[0+r],e[i+r]),n.max[0+r]=Math.max(n.max[0+r],e[i+r]);return n}}var j=n(74885);function k(e){return(e%1+1)%1}const K={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16,BOOLEAN:1,STRING:1,ENUM:1},V={INT8:Int8Array,UINT8:Uint8Array,INT16:Int16Array,UINT16:Uint16Array,INT32:Int32Array,UINT32:Uint32Array,INT64:BigInt64Array,UINT64:BigUint64Array,FLOAT32:Float32Array,FLOAT64:Float64Array},Q={INT8:1,UINT8:1,INT16:2,UINT16:2,INT32:4,UINT32:4,INT64:8,UINT64:8,FLOAT32:4,FLOAT64:8};function Z(e,t){return Q[t]*K[e]}function W(e,t,n,r){if("UINT8"!==n&&"UINT16"!==n&&"UINT32"!==n&&"UINT64"!==n)return null;const i=z(e.getTypedArrayForBufferView(t),"SCALAR",n,r+1);return i instanceof BigInt64Array||i instanceof BigUint64Array?null:i}function z(e,t,n,r){void 0===r&&(r=1);const i=K[t],s=V[n],o=Q[n],a=r*i,l=a*o;let c=e.buffer,u=e.byteOffset;if(u%o!=0){c=new Uint8Array(c).slice(u,u+l).buffer,u=0}return new s(c,u,a)}function Y(e,t,n){var r,i;const s="TEXCOORD_"+(t.texCoord||0),o=n.attributes[s],a=e.getTypedArrayForAccessor(o),l=e.gltf.json,c=t.index,u=null==(r=l.textures)||null==(i=r[c])?void 0:i.source;if(void 0!==u){var d,h,f;const n=null==(d=l.images)||null==(h=d[u])?void 0:h.mimeType,r=null==(f=e.gltf.images)?void 0:f[u];if(r&&void 0!==r.width){const e=[];for(let i=0;i<a.length;i+=2){const s=$(r,n,a,i,t.channels);e.push(s)}return e}}return[]}function q(e,t,n,r,i){if(null==n||!n.length)return;const s=[];for(const u of n){let e=r.findIndex((e=>e===u));-1===e&&(e=r.push(u)-1),s.push(e)}const o=new Uint32Array(s),a=e.gltf.buffers.push({arrayBuffer:o.buffer,byteOffset:o.byteOffset,byteLength:o.byteLength})-1,l=e.addBufferView(o,a,0),c=e.addAccessor(l,{size:1,componentType:(0,U.x$)(o),count:o.length});i.attributes[t]=c}function $(e,t,n,r,i){void 0===i&&(i=[0]);const s={r:{offset:0,shift:0},g:{offset:1,shift:8},b:{offset:2,shift:16},a:{offset:3,shift:24}},o=n[r],a=n[r+1];let l=1;!t||-1===t.indexOf("image/jpeg")&&-1===t.indexOf("image/png")||(l=4);const c=function(e,t,n,r){void 0===r&&(r=1);const i=n.width,s=k(e)*(i-1),o=Math.round(s),a=n.height,l=k(t)*(a-1),c=Math.round(l),u=n.components?n.components:r,d=(c*i+o)*u;return d}(o,a,e,l);let u=0;for(const d of i){const t="number"==typeof d?Object.values(s)[d]:s[d],n=c+t.offset,r=(0,j.n$)(e);if(r.data.length<=n)throw new Error(r.data.length+" <= "+n);u|=r.data[n]<<t.shift}return u}function ee(e,t,n,r,i){const s=[];for(let o=0;o<t;o++){const t=n[o],a=n[o+1]-n[o];if(a+t>r)break;const l=t/i,c=a/i;s.push(e.slice(l,l+c))}return s}function te(e,t,n){const r=[];for(let i=0;i<t;i++){const t=i*n;r.push(e.slice(t,t+n))}return r}function ne(e,t,n,r){if(n)throw new Error("Not implemented - arrayOffsets for strings is specified");if(r){const n=[],i=new TextDecoder("utf8");let s=0;for(let o=0;o<e;o++){const e=r[o+1]-r[o];if(e+s<=t.length){const r=t.subarray(s,e+s),o=i.decode(r);n.push(o),s+=e}}return n}return[]}const re="EXT_mesh_features",ie=re;async function se(e,t){!function(e,t){const n=e.gltf.json;if(!n.meshes)return;for(const r of n.meshes)for(const n of r.primitives)oe(e,n,t)}(new X(e),t)}function oe(e,t,n){var r,i;if(null==n||null==(r=n.gltf)||!r.loadBuffers)return;const s=null==(i=t.extensions)?void 0:i[re],o=null==s?void 0:s.featureIds;if(o)for(const l of o){var a;let r;if(void 0!==l.attribute){const n="_FEATURE_ID_"+l.attribute,i=t.attributes[n];r=e.getTypedArrayForAccessor(i)}else r=void 0!==l.texture&&null!=n&&null!=(a=n.gltf)&&a.loadImages?Y(e,l.texture,t):[];l.data=r}}const ae="EXT_structural_metadata",le=ae;async function ce(e,t){!function(e,t){var n,r;if(null==(n=t.gltf)||!n.loadBuffers)return;const i=e.getExtension(ae);if(!i)return;null!=(r=t.gltf)&&r.loadImages&&function(e,t){const n=t.propertyTextures,r=e.gltf.json;if(n&&r.meshes)for(const i of r.meshes)for(const r of i.primitives)de(e,n,r,t)}(e,i);!function(e,t){const n=t.schema;if(!n)return;const r=n.classes,i=t.propertyTables;if(r&&i)for(const s in r){const t=ue(i,s);t&&fe(e,n,t)}}(e,i)}(new X(e),t)}function ue(e,t){for(const n of e)if(n.class===t)return n;return null}function de(e,t,n,r){var i;if(!t)return;const s=null==(i=n.extensions)?void 0:i[ae],o=null==s?void 0:s.propertyTextures;if(o)for(const a of o){he(e,t[a],n,r)}}function he(e,t,n,r){if(!t.properties)return;r.dataAttributeNames||(r.dataAttributeNames=[]);const i=t.class;for(const o in t.properties){var s;const a=i+"_"+o,l=null==(s=t.properties)?void 0:s[o];if(!l)continue;l.data||(l.data=[]);const c=l.data,u=Y(e,l,n);null!==u&&(q(e,a,u,c,n),l.data=c,r.dataAttributeNames.push(a))}}function fe(e,t,n){var r;const i=null==(r=t.classes)?void 0:r[n.class];if(!i)throw new Error("Incorrect data in the EXT_structural_metadata extension: no schema class with name "+n.class);const s=n.count;for(const a in i.properties){var o;const r=i.properties[a],l=null==(o=n.properties)?void 0:o[a];if(l){const n=Ae(e,t,r,s,l);l.data=n}}}function Ae(e,t,n,r,i){let s=[];const o=i.values,a=e.getTypedArrayForBufferView(o),l=function(e,t,n,r){if(t.array&&void 0===t.count&&void 0!==n.arrayOffsets)return W(e,n.arrayOffsets,n.arrayOffsetType||"UINT32",r);return null}(e,n,i,r),c=function(e,t,n){if(void 0!==t.stringOffsets)return W(e,t.stringOffsets,t.stringOffsetType||"UINT32",n);return null}(e,i,r);switch(n.type){case"SCALAR":case"VEC2":case"VEC3":case"VEC4":case"MAT2":case"MAT3":case"MAT4":s=function(e,t,n,r){const i=e.array,s=e.count,o=Z(e.type,e.componentType),a=n.byteLength/o;let l;l=e.componentType?z(n,e.type,e.componentType,a):n;if(i)return r?ee(l,t,r,n.length,o):s?te(l,t,s):[];return l}(n,r,a,l);break;case"BOOLEAN":throw new Error("Not implemented - classProperty.type="+n.type);case"STRING":s=ne(r,a,l,c);break;case"ENUM":s=function(e,t,n,r,i){var s;const o=t.enumType;if(!o)throw new Error("Incorrect data in the EXT_structural_metadata extension: classProperty.enumType is not set for type ENUM");const a=null==(s=e.enums)?void 0:s[o];if(!a)throw new Error("Incorrect data in the EXT_structural_metadata extension: schema.enums does't contain "+o);const l=a.valueType||"UINT16",c=Z(t.type,l),u=r.byteLength/c;let d=z(r,t.type,l,u);d||(d=r);if(t.array){if(i)return function(e){const{valuesData:t,numberOfElements:n,arrayOffsets:r,valuesDataBytesLength:i,elementSize:s,enumEntry:o}=e,a=[];for(let l=0;l<n;l++){const e=r[l],n=r[l+1]-r[l];if(n+e>i)break;const c=pe(t,e/s,n/s,o);a.push(c)}return a}({valuesData:d,numberOfElements:n,arrayOffsets:i,valuesDataBytesLength:r.length,elementSize:c,enumEntry:a});const e=t.count;return e?function(e,t,n,r){const i=[];for(let s=0;s<t;s++){const t=pe(e,n*s,n,r);i.push(t)}return i}(d,n,e,a):[]}return pe(d,0,n,a)}(t,n,r,a,l);break;default:throw new Error("Unknown classProperty type "+n.type)}return s}function pe(e,t,n,r){const i=[];for(let s=0;s<n;s++)if(e instanceof BigInt64Array||e instanceof BigUint64Array)i.push("");else{const n=me(r,e[t+s]);n?i.push(n.name):i.push("")}return i}function me(e,t){for(const n of e.values)if(n.value===t)return n;return null}var Ce=n(25108);const ge="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",Be="B9h9z9tFBBBF8dL9gBB9gLaaaaaFa9gEaaaB9gGaaB9gFaFaEQSBBFBFFGEGEGIILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBNn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBcI9z9iqlBMc/j9JSIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMkRIbaG97FaK978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAnDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAnDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBRnCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBHiCFD9tAiAPD9OD9hD9RHiDQBTFtGmEYIPLdKeOnH8ZAIAQJDBIBHpCFD9tApAPD9OD9hD9RHpAIASJDBIBHyCFD9tAyAPD9OD9hD9RHyDQBTFtGmEYIPLdKeOnH8cDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAnD9uHnDyBjGBAEAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnA8ZA8cDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNiV8ZcpMyS8cQ8df8eb8fHdApAyDQNiV8ZcpMyS8cQ8df8eb8fHiDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/xLGEaK978jUUUUBCAlHE8kUUUUBGXGXAGCI9HQBGXAFC98ZHI9FQBABRGCBRLEXAGAGDBBBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMBBAGCTJRGALCIJHLAI9JQBMMAIAF9PQFAEAFCEZHLCGWHGqCBCTAGl/8MBAEABAICGWJHIAG/8cBBGXAL9FQBAEAEDBIBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMIBMAIAEAG/8cBBSFMABAFC98ZHGT+HUUUBAGAF9PQBAEAFCEZHICEWHLJCBCAALl/8MBAEABAGCEWJHGAL/8cBBAEAIT+HUUUBAGAEAL/8cBBMAECAJ8kUUUUBM+yEGGaO97GXAF9FQBCBRGEXABCTJHEAEDBBBHICBDtHLCUU98D8cFCUU98D8cEHKD9OABDBBBHOAIDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAOAIDQBFGENVcMTtmYi8ZpyHICTD+sFD/6FHND/gFAICTD+rFCTD+sFD/6FHVD/gFD/kFD/lFHI9DB/+g6DYAVAIALD+2FHLAVCUUUU94DtHcD9OD9RD/kFHVAVD/mFAIAID/mFANALANAcD9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHLD/kFCTD+rFAVAND/mFALD/kFCggEDtD9OD9QHVAIAND/mFALD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHIDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAOAKD9OAVAIDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM94FEa8jUUUUBCAlHE8kUUUUBABAFC98ZHIT+JUUUBGXAIAF9PQBAEAFCEZHLCEWHFJCBCAAFl/8MBAEABAICEWJHBAF/8cBBAEALT+JUUUBABAEAF/8cBBMAECAJ8kUUUUBM/hEIGaF97FaL978jUUUUBCTlRGGXAF9FQBCBREEXAGABDBBBHIABCTJHLDBBBHKDQILKOSQfbPden8c8d8e8fHOCTD+sFHNCID+rFDMIBAB9DBBU8/DY9D/zI818/DYANCEDtD9QD/6FD/nFHNAIAKDQBFGENVcMTtmYi8ZpyHICTD+rFCTD+sFD/6FD/mFHKAKD/mFANAICTD+sFD/6FD/mFHVAVD/mFANAOCTD+rFCTD+sFD/6FD/mFHOAOD/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHND/mF9DBBX9LDYHID/kFCggEDtHcD9OAVAND/mFAID/kFCTD+rFD9QHVAOAND/mFAID/kFCTD+rFAKAND/mFAID/kFAcD9OD9QHNDQBFTtGEmYILPdKOenHID8dBAGDBIBDyB+t+J83EBABCNJAID8dFAGDBIBDyF+t+J83EBALAVANDQNVi8ZcMpySQ8c8dfb8e8fHND8dBAGDBIBDyG+t+J83EBABCiJAND8dFAGDBIBDyE+t+J83EBABCAJRBAECIJHEAF9JQBMMM/3FGEaF978jUUUUBCoBlREGXAGCGrAF9sHIC98ZHL9FQBCBRGABRFEXAFAFDBBBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBAFCTJRFAGCIJHGAL9JQBMMGXALAI9PQBAEAICEZHGCGWHFqCBCoBAFl/8MBAEABALCGWJHLAF/8cBBGXAG9FQBAEAEDBIBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMIBMALAEAF/8cBBMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",_e=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),ye=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]),Ee={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},Te={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};let be;async function Se(){return be||(be=async function(){let e=ge;WebAssembly.validate(_e)&&(e=Be,Ce.log("Warning: meshopt_decoder is using experimental SIMD support"));const t=await WebAssembly.instantiate(function(e){const t=new Uint8Array(e.length);for(let r=0;r<e.length;++r){const n=e.charCodeAt(r);t[r]=n>96?n-71:n>64?n-65:n>47?n+4:n>46?63:62}let n=0;for(let r=0;r<e.length;++r)t[n++]=t[r]<60?ye[t[r]]:64*(t[r]-60)+t[++r];return t.buffer.slice(0,n)}(e),{});return await t.instance.exports.__wasm_call_ctors(),t.instance}()),be}function we(e,t,n,r,i,s,o){const a=e.exports.sbrk,l=r+3&-4,c=a(l*i),u=a(s.length),d=new Uint8Array(e.exports.memory.buffer);d.set(s,u);const h=t(c,r,i,u,s.length);if(0===h&&o&&o(c,l,i),n.set(d.subarray(c,c+r*i)),a(c-a(0)),0!==h)throw new Error("Malformed buffer data: "+h)}const Re="EXT_meshopt_compression",Ie=Re;async function De(e,t){var n,r;const i=new X(e);if(null==t||null==(n=t.gltf)||!n.decompressMeshes||null==(r=t.gltf)||!r.loadBuffers)return;const s=[];for(const o of e.json.bufferViews||[])s.push(ve(i,o));await Promise.all(s),i.removeExtension(Re)}async function ve(e,t){const n=e.getObjectExtension(t,Re);if(n){const{byteOffset:r=0,byteLength:i=0,byteStride:s,count:o,mode:a,filter:l="NONE",buffer:c}=n,u=e.gltf.buffers[c],d=new Uint8Array(u.arrayBuffer,u.byteOffset+r,i),h=new Uint8Array(e.gltf.buffers[t.buffer].arrayBuffer,t.byteOffset,t.byteLength);await async function(e,t,n,r,i,s){void 0===s&&(s="NONE");const o=await Se();we(o,o.exports[Te[i]],e,t,n,r,o.exports[Ee[s||"NONE"]])}(h,o,s,d,a,l),e.removeObjectExtension(t,Re)}}var Oe=n(82282);const Ge={};function Me(e){if(void 0===Ge[e]){const t=Oe.jU?function(e){switch(e){case"image/avif":case"image/webp":return function(e){try{const t=document.createElement("canvas");return 0===t.toDataURL(e).indexOf("data:"+e)}catch{return!1}}(e);default:return!0}}(e):xe(e);Ge[e]=t}return Ge[e]}function xe(e){var t,n;const r=(null==(t=globalThis.loaders)?void 0:t.imageFormatsNode)||["image/png","image/jpeg","image/gif"],i=null==(n=globalThis.loaders)?void 0:n.parseImageNode;return Boolean(i)&&r.includes(e)}const Ne="EXT_texture_webp",Fe=Ne;function Pe(e,t){const n=new X(e);if(!Me("image/webp")){if(n.getRequiredExtensions().includes(Ne))throw new Error("gltf: Required extension "+Ne+" not supported by browser");return}const{json:r}=n;for(const i of r.textures||[]){const e=n.getObjectExtension(i,Ne);e&&(i.source=e.source),n.removeObjectExtension(i,Ne)}n.removeExtension(Ne)}const Le="KHR_texture_basisu",Ue=Le;function He(e,t){const n=new X(e),{json:r}=n;for(const i of r.textures||[]){const e=n.getObjectExtension(i,Le);e&&(i.source=e.source,n.removeObjectExtension(i,Le))}n.removeExtension(Le)}var Je=n(76075);function Xe(e){const{buffer:t,size:n,count:r}=function(e){let t=e,n=1,r=0;e&&e.value&&(t=e.value,n=e.size||1);t&&(ArrayBuffer.isView(t)||(t=function(e,t,n){void 0===n&&(n=!1);if(!e)return null;if(Array.isArray(e))return new t(e);if(n&&!(e instanceof t))return new t(e);return e}(t,Float32Array)),r=t.length/n);return{buffer:t,size:n,count:r}}(e);return{value:t,size:n,byteOffset:0,count:r,type:(0,U.dl)(n),componentType:(0,U.x$)(t)}}const je="KHR_draco_mesh_compression",ke=je;function Ke(e,t,n){const r=new X(e);for(const i of ze(r))r.getObjectExtension(i,je)}async function Ve(e,t,n){var r;if(null==t||null==(r=t.gltf)||!r.decompressMeshes)return;const i=new X(e),s=[];for(const o of ze(i))i.getObjectExtension(o,je)&&s.push(Ze(i,o,t,n));await Promise.all(s),i.removeExtension(je)}function Qe(e,t){void 0===t&&(t={});const n=new X(e);for(const r of n.json.meshes||[])We(r,t),n.addRequiredExtension(je)}async function Ze(e,t,n,r){const i=e.getObjectExtension(t,je);if(!i)return;const s=e.getTypedArrayForBufferView(i.bufferView),o=(0,C.qv)(s.buffer,s.byteOffset),a={...n};delete a["3d-tiles"];const l=await(0,g.cr)(o,Je.VJ,a,r),c=function(e){const t={};for(const n in e){const r=e[n];if("indices"!==n){const e=Xe(r);t[n]=e}}return t}(l.attributes);for(const[u,d]of Object.entries(c))if(u in t.attributes){const n=t.attributes[u],r=e.getAccessor(n);null!=r&&r.min&&null!=r&&r.max&&(d.min=r.min,d.max=r.max)}t.attributes=c,l.indices&&(t.indices=Xe(l.indices)),e.removeObjectExtension(t,je),function(e){if(!e.attributes&&Object.keys(e.attributes).length>0)throw new Error("glTF: Empty primitive detected: Draco decompression failure?")}(t)}function We(e,t,n,r,i){if(void 0===n&&(n=4),!r.DracoWriter)throw new Error("options.gltf.DracoWriter not provided");const s=r.DracoWriter.encodeSync({attributes:e}),o=null==i||null==i.parseSync?void 0:i.parseSync({attributes:e}),a=r._addFauxAttributes(o.attributes),l=r.addBufferView(s);return{primitives:[{attributes:a,mode:n,extensions:{[je]:{bufferView:l,attributes:a}}}]}}function*ze(e){for(const t of e.json.meshes||[])for(const e of t.primitives)yield e}var Ye=n(43855),qe=n(80540),$e=n(85680);const et="KHR_texture_transform",tt=et,nt=new Ye.Z,rt=new qe.Z,it=new qe.Z;async function st(e,t){var n;if(!new X(e).hasExtension(et)||null==(n=t.gltf)||!n.loadBuffers)return;const r=e.json.materials||[];for(let i=0;i<r.length;i++)ot(i,e)}function ot(e,t){var n,r,i;const s=[],o=null==(n=t.json.materials)?void 0:n[e],a=null==o||null==(r=o.pbrMetallicRoughness)?void 0:r.baseColorTexture;a&&at(t,e,a,s);const l=null==o?void 0:o.emissiveTexture;l&&at(t,e,l,s);const c=null==o?void 0:o.normalTexture;c&&at(t,e,c,s);const u=null==o?void 0:o.occlusionTexture;u&&at(t,e,u,s);const d=null==o||null==(i=o.pbrMetallicRoughness)?void 0:i.metallicRoughnessTexture;d&&at(t,e,d,s)}function at(e,t,n,r){const i=function(e,t){var n;const r=null==(n=e.extensions)?void 0:n[et],{texCoord:i=0}=e,{texCoord:s=i}=r,o=-1!==t.findIndex((e=>{let[t,n]=e;return t===i&&n===s}));if(!o){const n=function(e){const{offset:t=[0,0],rotation:n=0,scale:r=[1,1]}=e,i=(new qe.Z).set(1,0,0,0,1,0,t[0],t[1],1),s=rt.set(Math.cos(n),Math.sin(n),0,-Math.sin(n),Math.cos(n),0,0,0,1),o=it.set(r[0],0,0,0,r[1],0,0,0,1);return i.multiplyRight(s).multiplyRight(o)}(r);return i!==s&&(e.texCoord=s),t.push([i,s]),{originalTexCoord:i,texCoord:s,matrix:n}}return null}(n,r);if(!i)return;const s=e.json.meshes||[];for(const o of s)for(const n of o.primitives){const r=n.material;Number.isFinite(r)&&t===r&&lt(e,n,i)}}function lt(e,t,n){const{originalTexCoord:r,texCoord:i,matrix:s}=n,o=t.attributes["TEXCOORD_"+r];if(Number.isFinite(o)){var a;const n=null==(a=e.json.accessors)?void 0:a[o];if(n&&n.bufferView){var l;const o=null==(l=e.json.bufferViews)?void 0:l[n.bufferView];if(o){const{arrayBuffer:a,byteOffset:l}=e.buffers[o.buffer],c=(l||0)+(n.byteOffset||0)+(o.byteOffset||0),{ArrayType:u,length:d}=(0,U.pN)(n,o),h=$e.A0[n.componentType],f=$e.KC[n.type],A=o.byteStride||h*f,p=new Float32Array(d);for(let e=0;e<n.count;e++){const t=new u(a,c+e*A,2);nt.set(t[0],t[1],1),nt.transformByMatrix3(s),p.set([nt[0],nt[1]],e*f)}r===i?function(e,t,n,r){e.componentType=5126,n.push({arrayBuffer:r.buffer,byteOffset:0,byteLength:r.buffer.byteLength}),t.buffer=n.length-1,t.byteLength=r.buffer.byteLength,t.byteOffset=0,delete t.byteStride}(n,o,e.buffers,p):function(e,t,n,r,i){r.buffers.push({arrayBuffer:i.buffer,byteOffset:0,byteLength:i.buffer.byteLength});const s=r.json.bufferViews;if(!s)return;s.push({buffer:r.buffers.length-1,byteLength:i.buffer.byteLength,byteOffset:0});const o=r.json.accessors;if(!o)return;o.push({bufferView:(null==s?void 0:s.length)-1,byteOffset:0,componentType:5126,count:t.count,type:"VEC2"}),n.attributes["TEXCOORD_"+e]=o.length-1}(i,n,t,e,p)}}}}const ct="KHR_lights_punctual",ut=ct;async function dt(e){const t=new X(e),{json:n}=t,r=t.getExtension(ct);r&&(t.json.lights=r.lights,t.removeExtension(ct));for(const i of n.nodes||[]){const e=t.getObjectExtension(i,ct);e&&(i.light=e.light),t.removeObjectExtension(i,ct)}}async function ht(e){const t=new X(e),{json:n}=t;if(n.lights){const e=t.addExtension(ct);(0,E.h)(!e.lights),e.lights=n.lights,delete n.lights}if(t.json.lights){for(const e of t.json.lights){const n=e.node;t.addObjectExtension(n,ct,e)}delete t.json.lights}}const ft="KHR_materials_unlit",At=ft;async function pt(e){const t=new X(e),{json:n}=t;for(const r of n.materials||[]){r.extensions&&r.extensions.KHR_materials_unlit&&(r.unlit=!0),t.removeObjectExtension(r,ft)}t.removeExtension(ft)}function mt(e){const t=new X(e),{json:n}=t;if(t.materials)for(const r of n.materials||[])r.unlit&&(delete r.unlit,t.addObjectExtension(r,ft,{}),t.addExtension(ft))}const Ct="KHR_techniques_webgl",gt=Ct;async function Bt(e){const t=new X(e),{json:n}=t,r=t.getExtension(Ct);if(r){const e=function(e,t){const{programs:n=[],shaders:r=[],techniques:i=[]}=e,s=new TextDecoder;return r.forEach((e=>{if(!Number.isFinite(e.bufferView))throw new Error("KHR_techniques_webgl: no shader code");e.code=s.decode(t.getTypedArrayForBufferView(e.bufferView))})),n.forEach((e=>{e.fragmentShader=r[e.fragmentShader],e.vertexShader=r[e.vertexShader]})),i.forEach((e=>{e.program=n[e.program]})),i}(r,t);for(const r of n.materials||[]){const n=t.getObjectExtension(r,Ct);n&&(r.technique=Object.assign({},n,e[n.technique]),r.technique.values=yt(r.technique,t)),t.removeObjectExtension(r,Ct)}t.removeExtension(Ct)}}async function _t(e,t){}function yt(e,t){const n=Object.assign({},e.values);return Object.keys(e.uniforms||{}).forEach((t=>{e.uniforms[t].value&&!(t in n)&&(n[t]=e.uniforms[t].value)})),Object.keys(n).forEach((e=>{"object"==typeof n[e]&&void 0!==n[e].index&&(n[e].texture=t.getTexture(n[e].index))})),n}const Et="EXT_feature_metadata",Tt=Et;async function bt(e,t){!function(e,t){var n,r;if(null==(n=t.gltf)||!n.loadBuffers)return;const i=e.getExtension(Et);if(!i)return;null!=(r=t.gltf)&&r.loadImages&&function(e,t){const n=t.schema;if(!n)return;const r=n.classes,{featureTextures:i}=t;if(r&&i)for(const s in r){const t=r[s],n=wt(i,s);n&&It(e,n,t)}}(e,i);!function(e,t){const n=t.schema;if(!n)return;const r=n.classes,i=t.featureTables;if(r&&i)for(const s in r){const t=St(i,s);t&&Rt(e,n,t)}}(e,i)}(new X(e),t)}function St(e,t){for(const n in e){const r=e[n];if(r.class===t)return r}return null}function wt(e,t){for(const n in e){const r=e[n];if(r.class===t)return r}return null}function Rt(e,t,n){var r;if(!n.class)return;const i=null==(r=t.classes)?void 0:r[n.class];if(!i)throw new Error("Incorrect data in the EXT_structural_metadata extension: no schema class with name "+n.class);const s=n.count;for(const a in i.properties){var o;const r=i.properties[a],l=null==(o=n.properties)?void 0:o[a];if(l){const n=Dt(e,t,r,s,l);l.data=n}}}function It(e,t,n){const r=t.class;for(const s in n.properties){var i;const n=null==t||null==(i=t.properties)?void 0:i[s];if(n){const t=vt(e,n,r);n.data=t}}}function Dt(e,t,n,r,i){let s=[];const o=i.bufferView,a=e.getTypedArrayForBufferView(o),l=function(e,t,n,r){if("ARRAY"===t.type&&void 0===t.componentCount&&void 0!==n.arrayOffsetBufferView)return W(e,n.arrayOffsetBufferView,n.offsetType||"UINT32",r);return null}(e,n,i,r),c=function(e,t,n,r){if(void 0!==n.stringOffsetBufferView)return W(e,n.stringOffsetBufferView,n.offsetType||"UINT32",r);return null}(e,0,i,r);return"STRING"===n.type||"STRING"===n.componentType?s=ne(r,a,l,c):function(e){const t=["UINT8","INT16","UINT16","INT32","UINT32","INT64","UINT64","FLOAT32","FLOAT64"];return t.includes(e.type)||void 0!==e.componentType&&t.includes(e.componentType)}(n)&&(s=function(e,t,n,r){const i="ARRAY"===e.type,s=e.componentCount,o="SCALAR",a=e.componentType||e.type,l=Z(o,a),c=n.byteLength/l,u=z(n,o,a,c);if(i)return r?ee(u,t,r,n.length,l):s?te(u,t,s):[];return u}(n,r,a,l)),s}function vt(e,t,n){const r=e.gltf.json;if(!r.meshes)return[];const i=[];for(const s of r.meshes)for(const r of s.primitives)Ot(e,n,t,i,r);return i}function Ot(e,t,n,r,i){const s=Y(e,{channels:n.channels,...n.texture},i);s&&q(e,t,s,r,i)}const Gt=[i,r,s,o,a,l,u,d,h,c,f];function Mt(e,t){var n;const r=(null==t||null==(n=t.gltf)?void 0:n.excludeExtensions)||{};return!(e in r&&!r[e])}const xt="KHR_binary_glTF";var Nt=n(25108);const Ft={accessors:"accessor",animations:"animation",buffers:"buffer",bufferViews:"bufferView",images:"image",materials:"material",meshes:"mesh",nodes:"node",samplers:"sampler",scenes:"scene",skins:"skin",textures:"texture"},Pt={accessor:"accessors",animations:"animation",buffer:"buffers",bufferView:"bufferViews",image:"images",material:"materials",mesh:"meshes",node:"nodes",sampler:"samplers",scene:"scenes",skin:"skins",texture:"textures"};class Lt{constructor(){this.idToIndexMap={animations:{},accessors:{},buffers:{},bufferViews:{},images:{},materials:{},meshes:{},nodes:{},samplers:{},scenes:{},skins:{},textures:{}}}normalize(e,t){this.json=e.json;const n=e.json;switch(n.asset&&n.asset.version){case"2.0":return;case void 0:case"1.0":break;default:return void Nt.warn("glTF: Unknown version "+n.asset.version)}if(!t.normalize)throw new Error("glTF v1 is not supported.");Nt.warn("Converting glTF v1 to glTF v2 format. This is experimental and may fail."),this._addAsset(n),this._convertTopLevelObjectsToArrays(n),function(e){const t=new X(e),{json:n}=t;for(const r of n.images||[]){const e=t.getObjectExtension(r,xt);e&&Object.assign(r,e),t.removeObjectExtension(r,xt)}n.buffers&&n.buffers[0]&&delete n.buffers[0].uri,t.removeExtension(xt)}(e),this._convertObjectIdsToArrayIndices(n),this._updateObjects(n),this._updateMaterial(n)}_addAsset(e){e.asset=e.asset||{},e.asset.version="2.0",e.asset.generator=e.asset.generator||"Normalized to glTF 2.0 by loaders.gl"}_convertTopLevelObjectsToArrays(e){for(const t in Ft)this._convertTopLevelObjectToArray(e,t)}_convertTopLevelObjectToArray(e,t){const n=e[t];if(n&&!Array.isArray(n)){e[t]=[];for(const r in n){const i=n[r];i.id=i.id||r;const s=e[t].length;e[t].push(i),this.idToIndexMap[t][r]=s}}}_convertObjectIdsToArrayIndices(e){for(const t in Ft)this._convertIdsToIndices(e,t);"scene"in e&&(e.scene=this._convertIdToIndex(e.scene,"scene"));for(const t of e.textures)this._convertTextureIds(t);for(const t of e.meshes)this._convertMeshIds(t);for(const t of e.nodes)this._convertNodeIds(t);for(const t of e.scenes)this._convertSceneIds(t)}_convertTextureIds(e){e.source&&(e.source=this._convertIdToIndex(e.source,"image"))}_convertMeshIds(e){for(const t of e.primitives){const{attributes:e,indices:n,material:r}=t;for(const t in e)e[t]=this._convertIdToIndex(e[t],"accessor");n&&(t.indices=this._convertIdToIndex(n,"accessor")),r&&(t.material=this._convertIdToIndex(r,"material"))}}_convertNodeIds(e){e.children&&(e.children=e.children.map((e=>this._convertIdToIndex(e,"node")))),e.meshes&&(e.meshes=e.meshes.map((e=>this._convertIdToIndex(e,"mesh"))))}_convertSceneIds(e){e.nodes&&(e.nodes=e.nodes.map((e=>this._convertIdToIndex(e,"node"))))}_convertIdsToIndices(e,t){e[t]||(Nt.warn("gltf v1: json doesn't contain attribute "+t),e[t]=[]);for(const n of e[t])for(const e in n){const t=n[e],r=this._convertIdToIndex(t,e);n[e]=r}}_convertIdToIndex(e,t){const n=Pt[t];if(n in this.idToIndexMap){const r=this.idToIndexMap[n][e];if(!Number.isFinite(r))throw new Error("gltf v1: failed to resolve "+t+" with id "+e);return r}return e}_updateObjects(e){for(const t of this.json.buffers)delete t.type}_updateMaterial(e){for(const i of e.materials){var t,n,r;i.pbrMetallicRoughness={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1};const s=(null==(t=i.values)?void 0:t.tex)||(null==(n=i.values)?void 0:n.texture2d_0)||(null==(r=i.values)?void 0:r.diffuseTex),o=e.textures.findIndex((e=>e.id===s));-1!==o&&(i.pbrMetallicRoughness.baseColorTexture={index:o})}}}async function Ut(e,t,n,r,i){var s,o,a;return void 0===n&&(n=0),function(e,t,n,r){r.uri&&(e.baseUri=r.uri);if(t instanceof ArrayBuffer&&!function(e,t,n){void 0===t&&(t=0),void 0===n&&(n={});const r=new DataView(e),{magic:i=R}=n,s=r.getUint32(t,!1);return s===i||s===R}(t,n,r)){t=(new TextDecoder).decode(t)}if("string"==typeof t)e.json=m(t);else if(t instanceof ArrayBuffer){const i={};n=N(i,t,n,r.glb),(0,E.h)("glTF"===i.type,"Invalid GLB magic string "+i.type),e._glb=i,e.json=i.json}else(0,E.h)(!1,"GLTF: must be ArrayBuffer or string");const i=e.json.buffers||[];if(e.buffers=new Array(i.length).fill(null),e._glb&&e._glb.header.hasBinChunk){const{binChunks:t}=e._glb;e.buffers[0]={arrayBuffer:t[0].arrayBuffer,byteOffset:t[0].byteOffset,byteLength:t[0].byteLength}}const s=e.json.images||[];e.images=new Array(s.length).fill({})}(e,t,n,r),function(e,t){void 0===t&&(t={}),(new Lt).normalize(e,t)}(e,{normalize:null==r||null==(s=r.gltf)?void 0:s.normalize}),function(e,t,n){void 0===t&&(t={});const r=Gt.filter((e=>Mt(e.name,t)));for(const i of r)null==i.preprocess||i.preprocess(e,t,n)}(e,r,i),null!=r&&null!=(o=r.gltf)&&o.loadBuffers&&e.json.buffers&&await async function(e,t,n){const r=e.json.buffers||[];for(let i=0;i<r.length;++i){const s=r[i];if(s.uri){const{fetch:r}=n;(0,E.h)(r);const o=L(s.uri,t),a=await(null==n||null==n.fetch?void 0:n.fetch(o)),l=await(null==a||null==a.arrayBuffer?void 0:a.arrayBuffer());e.buffers[i]={arrayBuffer:l,byteOffset:0,byteLength:l.byteLength},delete s.uri}else null===e.buffers[i]&&(e.buffers[i]={arrayBuffer:new ArrayBuffer(s.byteLength),byteOffset:0,byteLength:s.byteLength})}}(e,r,i),null!=r&&null!=(a=r.gltf)&&a.loadImages&&await async function(e,t,n){const r=function(e){const t=new Set,n=e.json.textures||[];for(const r of n)void 0!==r.source&&t.add(r.source);return Array.from(t).sort()}(e),i=e.json.images||[],s=[];for(const o of r)s.push(Ht(e,i[o],o,t,n));return await Promise.all(s)}(e,r,i),await async function(e,t,n){void 0===t&&(t={});const r=Gt.filter((e=>Mt(e.name,t)));for(const i of r)await(null==i.decode?void 0:i.decode(e,t,n))}(e,r,i),e}async function Ht(e,t,n,r,i){let s;if(t.uri&&!t.hasOwnProperty("bufferView")){const e=L(t.uri,r),{fetch:n}=i,o=await n(e);s=await o.arrayBuffer(),t.bufferView={data:s}}if(Number.isFinite(t.bufferView)){const n=H(e.json,e.buffers,t.bufferView);s=(0,C.qv)(n.buffer,n.byteOffset,n.byteLength)}(0,E.h)(s,"glTF image has no data");let o=await(0,g.cr)(s,[B.S,_.G],{...r,mimeType:t.mimeType,basis:r.basis||{format:(0,y.h)()}},i);o&&o[0]&&(o={compressed:!0,mipmaps:!1,width:o[0].width,height:o[0].height,data:o[0]}),e.images=e.images||[],e.images[n]=o}const Jt={name:"glTF",id:"gltf",module:"gltf",version:A,extensions:["gltf","glb"],mimeTypes:["model/gltf+json","model/gltf-binary"],text:!0,binary:!0,tests:["glTF"],parse:async function(e,t,n){void 0===t&&(t={});(t={...Jt.options,...t}).gltf={...Jt.options.gltf,...t.gltf};const{byteOffset:r=0}=t;return await Ut({},e,r,t,n)},options:{gltf:{normalize:!0,loadBuffers:!0,loadImages:!0,decompressMeshes:!0},log:n(25108)}}},85680:(e,t,n)=>{"use strict";n.d(t,{A0:()=>i,KC:()=>r});const r={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},i={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4}},79054:(e,t,n)=>{"use strict";n.d(t,{Xr:()=>p,dl:()=>h,pN:()=>A,x$:()=>f});var r=n(4183),i=n(85680);const s=1.33,o=["SCALAR","VEC2","VEC3","VEC4"],a=[[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126],[Float64Array,5130]],l=new Map(a),c={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},u={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},d={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function h(e){return o[e-1]||o[0]}function f(e){const t=l.get(e.constructor);if(!t)throw new Error("Illegal typed array");return t}function A(e,t){const n=d[e.componentType],s=c[e.type],o=u[e.componentType],a=e.count*s,l=e.count*s*o;(0,r.h)(l>=0&&l<=t.byteLength);return{ArrayType:n,length:a,byteLength:l,componentByteSize:i.A0[e.componentType],numberOfComponentsInElement:i.KC[e.type]}}function p(e){let{images:t,bufferViews:n}=e;t=t||[],n=n||[];const r=t.map((e=>e.bufferView));n=n.filter((e=>!r.includes(e)));const i=n.reduce(((e,t)=>e+t.byteLength),0),o=t.reduce(((e,t)=>{const{width:n,height:r}=t.image;return e+n*r}),0);return i+Math.ceil(4*o*s)}},4183:(e,t,n)=>{"use strict";function r(e,t){if(!e)throw new Error(t||"assert failed: gltf")}n.d(t,{h:()=>r})},36701:(e,t,n)=>{"use strict";n.d(t,{N:()=>N});var r=n(52291),i=n(35889),s=n(43855),o=n(85451),a=n(98759),l=n(93203),c=n(48093),u=n(76075),d=n(11459),h=n(30202);let f=function(e){return e.vertexCount="vertexCount",e.featureCount="featureCount",e}({});var A=n(51779),p=n(77035);const m=new s.Z([0,0,0]);const C="i3s-attribute-type";async function g(e,t,n,g,y){const T={attributes:{},indices:null,featureIds:[],vertexCount:0,modelMatrix:new o.Z,coordinateSystem:0,byteLength:0,texture:null};if(t.textureUrl){var b;const e=(0,A.DA)(t.textureUrl,null==g||null==(b=g.i3s)?void 0:b.token),n=function(e){switch(e){case"ktx-etc2":case"dds":return d.D;case"ktx2":return h.G;default:return c.S}}(t.textureFormat),s=(null==y?void 0:y.fetch)||fetch,o=await s(e),a=await o.arrayBuffer();if(null!=g&&g.i3s.decodeTextures){if(n===c.S){const e={...t.textureLoaderOptions,image:{type:"data"}};try{const t=await(0,l.cr)(a,[],e,y);T.texture=t}catch(S){const t=await(0,r.Q)(a,n,e,y);T.texture=t}}else if(n===d.D||n===h.G){let e=await(0,i.z)(a,n,t.textureLoaderOptions);n===h.G&&(e=e[0]),T.texture={compressed:!0,mipmaps:!1,width:e[0].width,height:e[0].height,data:e}}}else T.texture=a}return T.material=function(e,t){let n;e?n={...e,pbrMetallicRoughness:e.pbrMetallicRoughness?{...e.pbrMetallicRoughness}:{baseColorFactor:[255,255,255,255]}}:(n={pbrMetallicRoughness:{}},t?n.pbrMetallicRoughness.baseColorTexture={texCoord:0}:n.pbrMetallicRoughness.baseColorFactor=[255,255,255,255]);n.alphaCutoff=n.alphaCutoff||.25,n.alphaMode&&(n.alphaMode=n.alphaMode.toUpperCase());n.emissiveFactor&&(n.emissiveFactor=E(n.emissiveFactor));n.pbrMetallicRoughness&&n.pbrMetallicRoughness.baseColorFactor&&(n.pbrMetallicRoughness.baseColorFactor=E(n.pbrMetallicRoughness.baseColorFactor));t&&function(e,t){const n={source:{image:t}};e.pbrMetallicRoughness&&e.pbrMetallicRoughness.baseColorTexture?e.pbrMetallicRoughness.baseColorTexture={...e.pbrMetallicRoughness.baseColorTexture,texture:n}:e.emissiveTexture?e.emissiveTexture={...e.emissiveTexture,texture:n}:e.pbrMetallicRoughness&&e.pbrMetallicRoughness.metallicRoughnessTexture?e.pbrMetallicRoughness.metallicRoughnessTexture={...e.pbrMetallicRoughness.metallicRoughnessTexture,texture:n}:e.normalTexture?e.normalTexture={...e.normalTexture,texture:n}:e.occlusionTexture&&(e.occlusionTexture={...e.occlusionTexture,texture:n})}(n,t);return n}(t.materialDefinition,T.texture),T.material&&(T.texture=null),await async function(e,t,n,i,l){var c;const d=e.byteLength;let h,A,g,y=0,E=0;if(n.isDracoGeometry){var T;const t=await(0,r.Q)(e,u.VJ,{draco:{attributeNameEntry:C}});A=t.header.vertexCount,g=null==(T=t.indices)?void 0:T.value;const{POSITION:n,NORMAL:i,COLOR_0:s,TEXCOORD_0:o,"feature-index":a,"uv-region":l}=t.attributes;h={position:n,normal:i,color:s,uv0:o,uvRegion:l,id:a},function(e,t){for(const n in t.loaderData.attributes){const r=t.loaderData.attributes[n];switch(r.name){case"POSITION":e.position.metadata=r.metadata;break;case"feature-index":e.id.metadata=r.metadata}}}(h,t);const c=function(e){var t,n;return null==e||null==(t=e.metadata)||null==(n=t["i3s-feature-ids"])?void 0:n.intArray}(a);c&&function(e,t){const n=e.id.value,r=new Float32Array(n.length);for(let i=0;i<n.length;i++)r[i]=t[n[i]];e.id.value=r}(h,c)}else{const{vertexAttributes:t,ordering:n,featureAttributes:r,featureAttributeOrder:s}=i.store.defaultGeometrySchema,o=function(e,t){let n=0,r=0,i=0;for(const{property:s,type:o}of t.store.defaultGeometrySchema.header){const t=(0,p.Jo)(o);switch(s){case f.vertexCount:r=new t(e,0,4)[0],n+=(0,p.Qm)(o);break;case f.featureCount:i=new t(e,4,4)[0],n+=(0,p.Qm)(o)}}return{vertexCount:r,featureCount:i,byteOffset:n}}(e,i);y=o.byteOffset,A=o.vertexCount,E=o.featureCount;const{attributes:a,byteOffset:l}=_(e,y,t,A,n),{attributes:c}=_(e,l,r,E,s);!function(e){const{id:t,faceRange:n}=e;if(!t||!n)return;const r=t.value,i=n.value,s=i[i.length-1]+1,o=new Uint32Array(3*s);let a=0,l=0;for(let c=1;c<i.length;c+=2){const e=Number(r[a]),t=l+3*(i[c]-i[c-1]+1);o.fill(e,l,t),a++,l=t}e.id.value=o}(c),h=function(e,t){return{...e,...t}}(a,c)}if(null!=l&&null!=(c=l.i3s)&&c.coordinateSystem&&l.i3s.coordinateSystem!==p.Df.METER_OFFSETS)t.modelMatrix=function(e){var t,n;const r=e.metadata,i=(null==r||null==(t=r["i3s-scale_x"])?void 0:t.double)||1,s=(null==r||null==(n=r["i3s-scale_y"])?void 0:n.double)||1,a=new o.Z;return a[0]=i,a[5]=s,a}(h.position),t.coordinateSystem=p.Df.LNGLAT_OFFSETS;else{const e=function(e,t){const n=t.mbs,r=e.value,i=e.metadata,l=new o.Z,c=new s.Z(n[0],n[1],n[2]),u=new s.Z;return a.H.WGS84.cartographicToCartesian(c,u),a.H.WGS84.eastNorthUpToFixedFrame(u,l),e.value=function(e,t,n){void 0===t&&(t={});const r=new Float64Array(e.length),i=t["i3s-scale_x"]&&t["i3s-scale_x"].double||1,s=t["i3s-scale_y"]&&t["i3s-scale_y"].double||1;for(let o=0;o<r.length;o+=3)r[o]=e[o]*i+n.x,r[o+1]=e[o+1]*s+n.y,r[o+2]=e[o+2]+n.z;for(let o=0;o<r.length;o+=3)a.H.WGS84.cartographicToCartesian(r.subarray(o,o+3),m),r[o]=m.x,r[o+1]=m.y,r[o+2]=m.z;return r}(r,i,c),l}(h.position,n);t.modelMatrix=e.invert(),t.coordinateSystem=p.Df.METER_OFFSETS}t.attributes={positions:h.position,normals:h.normal,colors:B(h.color),texCoords:h.uv0,uvRegions:B(h.uvRegion||h.region)},t.indices=g||null,h.id&&h.id.value&&(t.featureIds=h.id.value);for(const r in t.attributes)t.attributes[r]||delete t.attributes[r];return t.vertexCount=A,t.byteLength=d,t}(e,T,t,n,g)}function B(e){return e?(e.normalized=!0,e):e}function _(e,t,n,r,i){const s={};for(const o of i)if(n[o]){const{valueType:i,valuesPerElement:a}=n[o];if(t+r*a*(0,p.Qm)(i)<=e.byteLength){const n=e.slice(t);let l;if("UInt64"===i)l=y(n,r*a,(0,p.Qm)(i));else{l=new((0,p.Jo)(i))(n,0,r*a)}if(s[o]={value:l,type:p.PX[i],size:a},"color"===o)s.color.normalized=!0;t+=r*a*(0,p.Qm)(i)}else if("uv0"!==o)break}return{attributes:s,byteOffset:t}}function y(e,t,n){const r=[],i=new DataView(e);let s=0;for(let o=0;o<t;o++){const e=i.getUint32(s,!0)+2**32*i.getUint32(s+4,!0);r.push(e),s+=n}return new Uint32Array(r)}function E(e){const t=[...e];for(let n=0;n<e.length;n++)t[n]=e[n]/255;return t}const T={name:"I3S Content (Indexed Scene Layers)",id:"i3s-content",module:"i3s",worker:!0,version:"undefined"!=typeof __VERSION__?__VERSION__:"beta",mimeTypes:["application/octet-stream"],parse:async function(e,t,n){const{tile:r,_tileOptions:i,tileset:s,_tilesetOptions:o}=(null==t?void 0:t.i3s)||{},a=i||r,l=o||s;if(!a||!l)return null;return await g(e,a,l,t,n)},extensions:["bin"],options:{"i3s-content":{}}};var b=n(36625),S=n(5860),w=n(33313),R=n(45475);const I={name:"I3S Node Page",id:"i3s-node-page",module:"i3s",version:"undefined"!=typeof __VERSION__?__VERSION__:"latest",mimeTypes:["application/json"],parse:async function(e,t){return JSON.parse((new TextDecoder).decode(e))},extensions:["json"],options:{i3s:{}}};class D{constructor(e,t,n){var r,i;void 0===t&&(t=""),this.nodePages=[],this.pendingNodePages=[],this.textureDefinitionsSelectedFormats=[],this.textureLoaderOptions={},this.tileset={...e},this.url=t,this.nodesPerPage=(null==(r=e.nodePages)?void 0:r.nodesPerPage)||64,this.lodSelectionMetricType=null==(i=e.nodePages)?void 0:i.lodSelectionMetricType,this.options=n,this.nodesInNodePages=0,this.initSelectedFormatsForTextureDefinitions(e)}async getNodeById(e){const t=Math.floor(e/this.nodesPerPage);if(!this.nodePages[t]&&!this.pendingNodePages[t]){var n;const e=(0,A.DA)(this.url+"/nodepages/"+t,null==(n=this.options.i3s)?void 0:n.token);this.pendingNodePages[t]={status:"Pending",promise:(0,i.z)(e,I,this.options)},this.nodePages[t]=await this.pendingNodePages[t].promise,this.nodesInNodePages+=this.nodePages[t].nodes.length,this.pendingNodePages[t].status="Done"}"Pending"===this.pendingNodePages[t].status&&(this.nodePages[t]=await this.pendingNodePages[t].promise);const r=e%this.nodesPerPage;return this.nodePages[t].nodes[r]}async formTileFromNodePages(e){const t=await this.getNodeById(e),n=[],r=[];for(const h of t.children||[])r.push(this.getNodeById(h));const i=await Promise.all(r);for(const h of i)n.push({id:h.index.toString(),obb:h.obb});let s,o,a,l="jpg",c=[],u=!1;if(t&&t.mesh){const{url:e,isDracoGeometry:n}=t.mesh.geometry&&this.getContentUrl(t.mesh.geometry)||{isDracoGeometry:!1};s=e,u=n;const{textureData:r,materialDefinition:i}=this.getInformationFromMaterial(t.mesh.material);a=i,l=r.format||l,r.name&&(o=this.url+"/nodes/"+t.mesh.material.resource+"/textures/"+r.name),this.tileset.attributeStorageInfo&&(c=(0,A.OX)(this.tileset,this.url,t.mesh.attribute.resource))}const d=this.getLodSelection(t);return v({id:e.toString(),lodSelection:d,obb:t.obb,contentUrl:s,textureUrl:o,attributeUrls:c,materialDefinition:a,textureFormat:l,textureLoaderOptions:this.textureLoaderOptions,children:n,isDracoGeometry:u})}getContentUrl(e){let t=null;const n=this.tileset.geometryDefinitions[e.definition];let r=-1;if(this.options.i3s&&this.options.i3s.useDracoGeometry&&(r=n.geometryBuffers.findIndex((e=>e.compressedAttributes&&"draco"===e.compressedAttributes.encoding))),-1===r&&(r=n.geometryBuffers.findIndex((e=>!e.compressedAttributes))),-1!==r){const i=Boolean(n.geometryBuffers[r].compressedAttributes);t={url:this.url+"/nodes/"+e.resource+"/geometries/"+r,isDracoGeometry:i}}return t}getLodSelection(e){const t=[];return"maxScreenThresholdSQ"===this.lodSelectionMetricType&&t.push({metricType:"maxScreenThreshold",maxError:Math.sqrt(e.lodThreshold/(.25*Math.PI))}),t.push({metricType:this.lodSelectionMetricType,maxError:e.lodThreshold}),t}getInformationFromMaterial(e){const t={textureData:{name:null}};if(e){var n;const s=null==(n=this.tileset.materialDefinitions)?void 0:n[e.definition];if(s){var r,i;t.materialDefinition=s;const e=null==s||null==(r=s.pbrMetallicRoughness)||null==(i=r.baseColorTexture)?void 0:i.textureSetDefinitionId;"number"==typeof e&&(t.textureData=this.textureDefinitionsSelectedFormats[e]||t.textureData)}}return t}initSelectedFormatsForTextureDefinitions(e){this.textureDefinitionsSelectedFormats=[];const t=this.getSupportedTextureFormats(),n=e.textureSetDefinitions||[];for(const r of n){const e=r&&r.formats||[];let n=null;for(const r of t){const t=e.find((e=>e.format===r));if(t){n=t;break}}n&&"ktx2"===n.format&&(this.textureLoaderOptions.basis={format:(0,w.h)(),containerFormat:"ktx2",module:"encoder"}),this.textureDefinitionsSelectedFormats.push(n)}}getSupportedTextureFormats(){const e=[];if(!this.options.i3s||this.options.i3s.useCompressedTextures){const t=(0,R.U)();t.has("etc2")&&e.push("ktx-etc2"),t.has("dxt")&&e.push("dds"),e.push("ktx2")}return e.push("jpg"),e.push("png"),e}}function v(e){var t,n;const r={};let i=[0,0,0,1];if(e.mbs)i=e.mbs,r.sphere=[...a.H.WGS84.cartographicToCartesian(e.mbs.slice(0,3)),e.mbs[3]];else if(e.obb){r.box=[...a.H.WGS84.cartographicToCartesian(e.obb.center),...e.obb.halfSize,...e.obb.quaternion];const t=(new b.F7).fromCenterHalfSizeQuaternion(r.box.slice(0,3),e.obb.halfSize,e.obb.quaternion).getBoundingSphere();r.sphere=[...t.center,t.radius],i=[...e.obb.center,t.radius]}const s=null==(t=e.lodSelection)?void 0:t[0].metricType,o=null==(n=e.lodSelection)?void 0:n[0].maxError,l=S.R7.MESH,c=S.F$.REPLACE;return{...e,mbs:i,boundingVolume:r,lodMetricType:s,lodMetricValue:o,type:l,refine:c}}const O="undefined"!=typeof __VERSION__?__VERSION__:"latest",G=/layers\/[0-9]+$/,M=/nodes\/([0-9-]+|root)$/,x="PointCloud",N={name:"I3S (Indexed Scene Layers)",id:"i3s",module:"i3s",version:O,mimeTypes:["application/octet-stream"],parse:async function(e,t,n){void 0===t&&(t={});const s=n.url;t.i3s=t.i3s||{};if("504b0304"===function(e){if(e instanceof ArrayBuffer)return[...new Uint8Array(e,0,4)].map((e=>e.toString(16).padStart(2,"0"))).join("");return null}(e))throw new Error("Files with .slpk extention currently are not supported by I3SLoader");const o=(0,A.Ol)(s);let a,l;a="auto"===t.i3s.isTileset?G.test(o):t.i3s.isTileset;l="auto"===t.isTileHeader?M.test(o):t.i3s.isTileHeader;e=a?await async function(e,t,n){const r=JSON.parse((new TextDecoder).decode(e));if((null==r?void 0:r.layerType)===x)throw new Error("Point Cloud layers currently are not supported by I3SLoader");const s=await async function(e,t,n){const r=(0,A.Ol)(n.url||"");let s,o;if(e.nodePages)s=new D(e,r,t),o=await s.formTileFromNodePages(0);else{const e=t.i3s,n=(0,A.DA)(r+"/nodes/root",e.token);o=await(0,i.z)(n,N,{...t,i3s:{...t.i3s,loadContent:!1,isTileHeader:!0,isTileset:!1}})}return{...e,loader:N,url:r,basePath:r,type:S.i3.I3S,nodePagesTile:s,root:o,lodMetricType:o.lodMetricType,lodMetricValue:o.lodMetricValue}}(r,t,n);return s}(e,t,n):l?await async function(e,t){return e=JSON.parse((new TextDecoder).decode(e)),function(e,t){const n=t.url||"";let r,i,s;e.geometryData&&(r=n+"/"+e.geometryData[0].href),e.textureData&&(i=n+"/"+e.textureData[0].href),e.attributeData&&(s=(0,A.gT)(n,e));const o=e.children||[];return v({...e,children:o,url:n,contentUrl:r,textureUrl:i,textureFormat:"jpg",attributeUrls:s,isDracoGeometry:!1})}(e,t)}(e,n):await async function(e,t){return await(0,r.Q)(e,T,t)}(e,t);return e},extensions:["bin"],options:{i3s:{token:null,isTileset:"auto",isTileHeader:"auto",tile:null,tileset:null,_tileOptions:null,_tilesetOptions:null,useDracoGeometry:!0,useCompressedTextures:!0,decodeTextures:!0,coordinateSystem:p.Df.METER_OFFSETS}}}},77035:(e,t,n)=>{"use strict";n.d(t,{Df:()=>d,Jo:()=>i,LU:()=>c,OA:()=>u,PX:()=>s,Qm:()=>o,T4:()=>a,xf:()=>l});var r=n(5120);function i(e){switch(e){case"UInt8":return Uint8Array;case"UInt16":return Uint16Array;case"UInt32":return Uint32Array;case"Float32":return Float32Array;case"UInt64":return Float64Array;default:throw new Error("parse i3s tile content: unknown type of data: "+e)}}const s={UInt8:r.GL.UNSIGNED_BYTE,UInt16:r.GL.UNSIGNED_SHORT,Float32:r.GL.FLOAT,UInt32:r.GL.UNSIGNED_INT,UInt64:r.GL.DOUBLE};function o(e){switch(e){case"UInt8":return 1;case"UInt16":case"Int16":return 2;case"UInt32":case"Int32":case"Float32":return 4;case"UInt64":case"Int64":case"Float64":return 8;default:throw new Error("parse i3s tile content: unknown size of data: "+e)}}const a="String",l="Oid32",c="Float64",u="Int16";let d=function(e){return e[e.DEFAULT=-1]="DEFAULT",e[e.LNGLAT=1]="LNGLAT",e[e.METER_OFFSETS=2]="METER_OFFSETS",e[e.LNGLAT_OFFSETS=3]="LNGLAT_OFFSETS",e[e.CARTESIAN=0]="CARTESIAN",e}({})},51779:(e,t,n)=>{"use strict";function r(e){let t;try{const n=new URL(e);t=""+n.origin+n.pathname}catch(n){}return t||e}function i(e,t){return void 0===t&&(t=null),t?e+"?token="+t:e}function s(e,t){const{attributeData:n=[]}=t,r=[];for(let i=0;i<n.length;i++){const t=n[i].href.replace("./","");r.push(e+"/"+t)}return r}function o(e,t,n){const r=[],{attributeStorageInfo:i=[]}=e;for(let s=0;s<i.length;s++){const e=i[s].key;r.push(t+"/nodes/"+n+"/attributes/"+e+"/0")}return r}n.d(t,{DA:()=>i,OX:()=>o,Ol:()=>r,gT:()=>s})},48093:(e,t,n)=>{"use strict";n.d(t,{S:()=>T});const r="undefined"!=typeof __VERSION__?__VERSION__:"latest";var i,s=n(61573),o=n(82282);const a=null==(i=globalThis.loaders)?void 0:i.parseImageNode,l="undefined"!=typeof Image,c="undefined"!=typeof ImageBitmap,u=Boolean(a),d=!!o.jU||u;var h=n(74885);const f=/^data:image\/svg\+xml/,A=/\.svg((\?|#).*)?$/;function p(e){return e&&(f.test(e)||A.test(e))}function m(e,t){if(p(t))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(e)])}async function C(e,t,n){const r=function(e,t){if(p(t)){let t=(new TextDecoder).decode(e);try{"function"==typeof unescape&&"function"==typeof encodeURIComponent&&(t=unescape(encodeURIComponent(t)))}catch(n){throw new Error(n.message)}return"data:image/svg+xml;base64,"+btoa(t)}return m(e,t)}(e,n),i=self.URL||self.webkitURL,s="string"!=typeof r&&i.createObjectURL(r);try{return await async function(e,t){const n=new Image;if(n.src=e,t.image&&t.image.decode&&n.decode)return await n.decode(),n;return await new Promise(((t,r)=>{try{n.onload=()=>t(n),n.onerror=t=>r(new Error("Could not load image "+e+": "+t))}catch(i){r(i)}}))}(s||r,t)}finally{s&&i.revokeObjectURL(s)}}var g=n(25108);const B={};let _=!0;async function y(e,t,n){let r;if(p(n)){r=await C(e,t,n)}else r=m(e,n);const i=t&&t.imagebitmap;return await async function(e,t){void 0===t&&(t=null);!function(e){for(const t in e||B)return!1;return!0}(t)&&_||(t=null);if(t)try{return await createImageBitmap(e,t)}catch(n){g.warn(n),_=!1}return await createImageBitmap(e)}(r,i)}var E=n(98746);const T={id:"image",module:"images",name:"Images",version:r,mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],parse:async function(e,t,n){const r=((t=t||{}).image||{}).type||"auto",{url:i}=n||{};let o;switch(function(e){switch(e){case"auto":case"data":return function(){if(c)return"imagebitmap";if(l)return"image";if(d)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}();default:return function(e){switch(e){case"auto":return c||l||d;case"imagebitmap":return c;case"image":return l;case"data":return d;default:throw new Error("@loaders.gl/images: image "+e+" not supported in this environment")}}(e),e}}(r)){case"imagebitmap":o=await y(e,t,i);break;case"image":o=await C(e,t,i);break;case"data":o=await async function(e,t){var n;const{mimeType:r}=(0,E.I)(e)||{},i=null==(n=globalThis.loaders)?void 0:n.parseImageNode;return(0,s.h)(i),await i(e,r)}(e);break;default:(0,s.h)(!1)}return"data"===r&&(o=(0,h.n$)(o)),o},tests:[e=>Boolean((0,E.I)(new DataView(e)))],options:{image:{type:"auto",decode:!0}}}},98746:(e,t,n)=>{"use strict";function r(e){return function(e,t,n){void 0===n&&(n=0);const r=(i=t,[...i].map((e=>e.charCodeAt(0))));var i;for(let s=0;s<r.length;++s)if(r[s]!==e[s+n])return!1;return!0}(e,"ftyp",4)?0==(96&e[8])?null:function(e){switch((t=e,n=8,r=12,String.fromCharCode(...t.slice(n,r))).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}var t,n,r}(e):null}n.d(t,{I:()=>o});const i=!1,s=!0;function o(e){const t=a(e);return function(e){const t=a(e),n=t.byteLength>=24&&2303741511===t.getUint32(0,i);if(!n)return null;return{mimeType:"image/png",width:t.getUint32(16,i),height:t.getUint32(20,i)}}(t)||function(e){const t=a(e),n=t.byteLength>=3&&65496===t.getUint16(0,i)&&255===t.getUint8(2);if(!n)return null;const{tableMarkers:r,sofMarkers:s}=function(){const e=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)e.add(n);const t=new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502]);return{tableMarkers:e,sofMarkers:t}}();let o=2;for(;o+9<t.byteLength;){const e=t.getUint16(o,i);if(s.has(e))return{mimeType:"image/jpeg",height:t.getUint16(o+5,i),width:t.getUint16(o+7,i)};if(!r.has(e))return null;o+=2,o+=t.getUint16(o,i)}return null}(t)||function(e){const t=a(e),n=t.byteLength>=10&&1195984440===t.getUint32(0,i);if(!n)return null;return{mimeType:"image/gif",width:t.getUint16(6,s),height:t.getUint16(8,s)}}(t)||function(e){const t=a(e),n=t.byteLength>=14&&16973===t.getUint16(0,i)&&t.getUint32(2,s)===t.byteLength;if(!n)return null;return{mimeType:"image/bmp",width:t.getUint32(18,s),height:t.getUint32(22,s)}}(t)||function(e){const t=new Uint8Array(e instanceof DataView?e.buffer:e),n=r(t);if(!n)return null;return{mimeType:n.mimeType,width:0,height:0}}(t)}function a(e){if(e instanceof DataView)return e;if(ArrayBuffer.isView(e))return new DataView(e.buffer);if(e instanceof ArrayBuffer)return new DataView(e);throw new Error("toDataView")}},74885:(e,t,n)=>{"use strict";function r(e){const t=s(e);if(!t)throw new Error("Not an image");return t}function i(e){switch(r(e)){case"data":return e;case"image":case"imagebitmap":const t=document.createElement("canvas"),n=t.getContext("2d");if(!n)throw new Error("getImageData");return t.width=e.width,t.height=e.height,n.drawImage(e,0,0),n.getImageData(0,0,e.width,e.height);default:throw new Error("getImageData")}}function s(e){return"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?"imagebitmap":"undefined"!=typeof Image&&e instanceof Image?"image":e&&"object"==typeof e&&e.data&&e.width&&e.height?"data":null}n.d(t,{n$:()=>i})},28490:(e,t,n)=>{"use strict";function r(e,t,n){if(n=n||e.byteLength,e.byteLength<n||t.byteLength<n)return!1;const r=new Uint8Array(e),i=new Uint8Array(t);for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}function i(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=t.map((e=>e instanceof ArrayBuffer?new Uint8Array(e):e)),i=r.reduce(((e,t)=>e+t.byteLength),0),s=new Uint8Array(i);let o=0;for(const a of r)s.set(a,o),o+=a.byteLength;return s.buffer}function s(e,t,n){const r=void 0!==n?new Uint8Array(e).subarray(t,t+n):new Uint8Array(e).subarray(t);return new Uint8Array(r).buffer}n.d(t,{JY:()=>i,Xq:()=>r,qv:()=>s})},7598:(e,t,n)=>{"use strict";function r(e){if((t=e)&&"object"==typeof t&&t.isBuffer)return e;var t;if(e instanceof ArrayBuffer)return e;if(ArrayBuffer.isView(e))return 0===e.byteOffset&&e.byteLength===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);if("string"==typeof e){const t=e;return(new TextEncoder).encode(t).buffer}if(e&&"object"==typeof e&&e._toArrayBuffer)return e._toArrayBuffer();throw new Error("toArrayBuffer")}n.d(t,{rJ:()=>r})},61573:(e,t,n)=>{"use strict";function r(e,t){if(!e)throw new Error(t||"loader assertion failed.")}n.d(t,{h:()=>r})},82282:(e,t,n)=>{"use strict";n.d(t,{jU:()=>i});var r=n(34155);"undefined"!=typeof self&&self,"undefined"!=typeof window&&window,void 0!==n.g&&n.g,"undefined"!=typeof document&&document;const i=Boolean("object"!=typeof r||"[object process]"!==String(r)||r.browser),s=void 0!==r&&r.version&&/v([0-9]*)/.exec(r.version);s&&parseFloat(s[1])},78346:(e,t,n)=>{"use strict";n.d(t,{Ed:()=>i,GZ:()=>s});var r=n(28490);async function i(e,t){for(;;){const{done:n,value:r}=await e.next();if(n)return void e.return();if(t(r))return}}async function s(e){const t=[];for await(const n of e)t.push(n);return(0,r.JY)(...t)}},56525:(e,t,n)=>{"use strict";function r(e,t){return i(e||{},t)}function i(e,t){const n={...e};for(const[r,s]of Object.entries(t))s&&"object"==typeof s&&!Array.isArray(s)?n[r]=i(n[r]||{},t[r]):n[r]=t[r];return n}n.d(t,{N:()=>r})},92730:(e,t,n)=>{"use strict";n.d(t,{i3:()=>s});let r="";const i={};function s(e){for(const t in i)if(e.startsWith(t)){const n=i[t];e=e.replace(t,n)}return e.startsWith("http://")||e.startsWith("https://")||(e=""+r+e),e}},80072:(e,t,n)=>{"use strict";n.d(t,{XX:()=>o,vB:()=>s,DB:()=>a});var r=n(34155);function i(){var e;if(void 0!==r&&void 0!==r.cwd)return r.cwd();const t=null==(e=window.location)?void 0:e.pathname;return(null==t?void 0:t.slice(0,t.lastIndexOf("/")+1))||""}function s(e){const t=e?e.lastIndexOf("/"):-1;return t>=0?e.substr(t+1):""}function o(e){const t=e?e.lastIndexOf("/"):-1;return t>=0?e.substr(0,t):""}function a(){const e=[];for(let i=0;i<arguments.length;i++)e[i]=i<0||arguments.length<=i?void 0:arguments[i];let t,n="",r=!1;for(let s=e.length-1;s>=-1&&!r;s--){let o;s>=0?o=e[s]:(void 0===t&&(t=i()),o=t),0!==o.length&&(n=o+"/"+n,r=o.charCodeAt(0)===l)}return n=function(e,t){let n,r="",i=-1,s=0,o=!1;for(let a=0;a<=e.length;++a){if(a<e.length)n=e.charCodeAt(a);else{if(n===l)break;n=l}if(n===l){if(i===a-1||1===s);else if(i!==a-1&&2===s){if(r.length<2||!o||r.charCodeAt(r.length-1)!==c||r.charCodeAt(r.length-2)!==c)if(r.length>2){const e=r.length-1;let t=e;for(;t>=0&&r.charCodeAt(t)!==l;--t);if(t!==e){r=-1===t?"":r.slice(0,t),i=a,s=0,o=!1;continue}}else if(2===r.length||1===r.length){r="",i=a,s=0,o=!1;continue}t&&(r.length>0?r+="/..":r="..",o=!0)}else{const t=e.slice(i+1,a);r.length>0?r+="/"+t:r=t,o=!1}i=a,s=0}else n===c&&-1!==s?++s:s=-1}return r}(n,!r),r?"/"+n:n.length>0?n:"."}const l=47,c=46},41868:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var r=n(8700);const i={id:"request-scheduler",throttleRequests:!0,maxRequests:6};class s{constructor(e){void 0===e&&(e={}),this.activeRequestCount=0,this.requestQueue=[],this.requestMap=new Map,this.deferredUpdate=null,this.props={...i,...e},this.stats=new r.jk({id:this.props.id}),this.stats.get("Queued Requests"),this.stats.get("Active Requests"),this.stats.get("Cancelled Requests"),this.stats.get("Queued Requests Ever"),this.stats.get("Active Requests Ever")}scheduleRequest(e,t){if(void 0===t&&(t=()=>0),!this.props.throttleRequests)return Promise.resolve({done:()=>{}});if(this.requestMap.has(e))return this.requestMap.get(e);const n={handle:e,priority:0,getPriority:t},r=new Promise((e=>(n.resolve=e,n)));return this.requestQueue.push(n),this.requestMap.set(e,r),this._issueNewRequests(),r}_issueRequest(e){const{handle:t,resolve:n}=e;let r=!1;const i=()=>{r||(r=!0,this.requestMap.delete(t),this.activeRequestCount--,this._issueNewRequests())};return this.activeRequestCount++,n?n({done:i}):Promise.resolve({done:i})}_issueNewRequests(){this.deferredUpdate||(this.deferredUpdate=setTimeout((()=>this._issueNewRequestsAsync()),0))}_issueNewRequestsAsync(){this.deferredUpdate=null;const e=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(0!==e){this._updateAllRequests();for(let t=0;t<e;++t){const e=this.requestQueue.shift();e&&this._issueRequest(e)}}}_updateAllRequests(){const e=this.requestQueue;for(let t=0;t<e.length;++t){const n=e[t];this._updateRequest(n)||(e.splice(t,1),this.requestMap.delete(n.handle),t--)}e.sort(((e,t)=>e.priority-t.priority))}_updateRequest(e){return e.priority=e.getPriority(e.handle),!(e.priority<0)||(e.resolve(null),!1)}}},93203:(e,t,n)=>{"use strict";async function r(e,t,n,r){return r._parse(e,t,n,r)}n.d(t,{cr:()=>r})},5120:(e,t,n)=>{"use strict";n.d(t,{GL:()=>i,I6:()=>r});const r={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DOUBLE:5130},i={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,...r}},65293:(e,t,n)=>{"use strict";n.d(t,{ou:()=>s,qB:()=>i});var r=n(80860);function i(e,t){void 0===t&&(t={});const n=function(e){const t=[];for(const n in e){const r=e[n];t.push(s(n,r))}return t}(e);return{fields:n,metadata:t}}function s(e,t,n){const i=(0,r.C9)(t.value),s=n||function(e){const t={};"byteOffset"in e&&(t.byteOffset=e.byteOffset.toString(10));"byteStride"in e&&(t.byteStride=e.byteStride.toString(10));"normalized"in e&&(t.normalized=e.normalized.toString());return t}(t);return{name:e,type:{type:"fixed-size-list",listSize:t.size,children:[{name:"value",type:i}]},nullable:!1,metadata:s}}},9231:(e,t,n)=>{"use strict";function r(e){let t=1/0,n=1/0,r=1/0,i=-1/0,s=-1/0,o=-1/0;const a=e.POSITION?e.POSITION.value:[],l=a&&a.length;for(let c=0;c<l;c+=3){const e=a[c],l=a[c+1],u=a[c+2];t=e<t?e:t,n=l<n?l:n,r=u<r?u:r,i=e>i?e:i,s=l>s?l:s,o=u>o?u:o}return[[t,n,r],[i,s,o]]}n.d(t,{v:()=>r})},80860:(e,t,n)=>{"use strict";function r(e){let t=i(e);return"null"!==t?{type:t,nullable:!1}:e.length>0?(n=e[0],void 0===r&&(r="float32"),t=n instanceof Date?"date-millisecond":n instanceof Number?r:"string"==typeof n?"utf8":"null",{type:t,nullable:!0}):{type:"null",nullable:!0};var n,r}function i(e){switch(e.constructor){case Int8Array:return"int8";case Uint8Array:case Uint8ClampedArray:return"uint8";case Int16Array:return"int16";case Uint16Array:return"uint16";case Int32Array:return"int32";case Uint32Array:return"uint32";case Float32Array:return"float32";case Float64Array:return"float64";default:return"null"}}n.d(t,{C9:()=>i,gU:()=>r})},15004:(e,t,n)=>{"use strict";n.d(t,{x:()=>r});const r={name:"Terrain",id:"terrain",module:"terrain",version:"undefined"!=typeof __VERSION__?__VERSION__:"latest",worker:!0,extensions:["png","pngraw","jpg","jpeg","gif","webp","bmp"],mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/bmp"],options:{terrain:{tesselator:"auto",bounds:void 0,meshMaxError:10,elevationDecoder:{rScaler:1,gScaler:0,bScaler:0,offset:0},skirtHeight:void 0}}}},30202:(e,t,n)=>{"use strict";n.d(t,{G:()=>s});var r=n(14428),i=n(33313);const s={...{name:"Basis",id:"basis",module:"textures",version:r.q,worker:!0,extensions:["basis","ktx2"],mimeTypes:["application/octet-stream","image/ktx2"],tests:["sB"],binary:!0,options:{basis:{format:"auto",libraryPath:"libs/",containerFormat:"auto",module:"transcoder"}}},parse:i.Z}},11459:(e,t,n)=>{"use strict";n.d(t,{D:()=>T});var r=n(14428),i=n(59560),s=n(61573),o=n(35936),a=n(28926);const l={MAGIC_NUMBER:542327876,HEADER_LENGTH:31,MAGIC_NUMBER_INDEX:0,HEADER_SIZE_INDEX:1,HEADER_FLAGS_INDEX:2,HEADER_HEIGHT_INDEX:3,HEADER_WIDTH_INDEX:4,MIPMAPCOUNT_INDEX:7,HEADER_PF_FLAGS_INDEX:20,HEADER_PF_FOURCC_INDEX:21,DDSD_MIPMAPCOUNT:131072,DDPF_FOURCC:4},c={DXT1:o.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGB_S3TC_DXT1_EXT,DXT3:o.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_S3TC_DXT3_EXT,DXT5:o.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_S3TC_DXT5_EXT,"ATC ":o.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGB_ATC_WEBGL,ATCA:o.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL,ATCI:o.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL},u={DXT1:h,DXT3:f,DXT5:f,"ATC ":h,ATCA:f,ATCI:f};function d(e){const t=new Int32Array(e,0,l.HEADER_LENGTH),n=t[l.HEADER_PF_FOURCC_INDEX];(0,s.h)(Boolean(t[l.HEADER_PF_FLAGS_INDEX]&l.DDPF_FOURCC),"DDS: Unsupported format, must contain a FourCC code");const r=(i=n,String.fromCharCode(255&i,i>>8&255,i>>16&255,i>>24&255));var i;const o=c[r],d=u[r];(0,s.h)(o&&d,"DDS: Unknown pixel format "+n);let h=1;t[l.HEADER_FLAGS_INDEX]&l.DDSD_MIPMAPCOUNT&&(h=Math.max(1,t[l.MIPMAPCOUNT_INDEX]));const f=t[l.HEADER_WIDTH_INDEX],A=t[l.HEADER_HEIGHT_INDEX],p=t[l.HEADER_SIZE_INDEX]+4,m=new Uint8Array(e,p);return(0,a.J)(m,{mipMapLevels:h,width:f,height:A,sizeFunction:d,internalFormat:o})}function h(e,t){return(e+3>>2)*(t+3>>2)*8}function f(e,t){return(e+3>>2)*(t+3>>2)*16}const A={MAGIC_NUMBER:55727696,MAGIC_NUMBER_EXTRA:1347834371,HEADER_LENGTH:13,HEADER_SIZE:52,MAGIC_NUMBER_INDEX:0,PIXEL_FORMAT_INDEX:2,COLOUR_SPACE_INDEX:4,HEIGHT_INDEX:6,WIDTH_INDEX:7,MIPMAPCOUNT_INDEX:11,METADATA_SIZE_INDEX:12},p={0:[o.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGB_PVRTC_2BPPV1_IMG],1:[o.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG],2:[o.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGB_PVRTC_4BPPV1_IMG],3:[o.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG],6:[o.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGB_ETC1_WEBGL],7:[o.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGB_S3TC_DXT1_EXT],9:[o.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_S3TC_DXT3_EXT],11:[o.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_S3TC_DXT5_EXT],22:[o.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGB8_ETC2],23:[o.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA8_ETC2_EAC],24:[o.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2],25:[o.GL_EXTENSIONS_CONSTANTS.COMPRESSED_R11_EAC],26:[o.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RG11_EAC],27:[o.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_ASTC_4X4_KHR,o.GL_EXTENSIONS_CONSTANTS.COMPRESSED_SRGB8_ALPHA8_ASTC_4X4_KHR],28:[o.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_ASTC_5X4_KHR,o.GL_EXTENSIONS_CONSTANTS.COMPRESSED_SRGB8_ALPHA8_ASTC_5X4_KHR],29:[o.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_ASTC_5X5_KHR,o.GL_EXTENSIONS_CONSTANTS.COMPRESSED_SRGB8_ALPHA8_ASTC_5X5_KHR],30:[o.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_ASTC_6X5_KHR,o.GL_EXTENSIONS_CONSTANTS.COMPRESSED_SRGB8_ALPHA8_ASTC_6X5_KHR],31:[o.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_ASTC_6X6_KHR,o.GL_EXTENSIONS_CONSTANTS.COMPRESSED_SRGB8_ALPHA8_ASTC_6X6_KHR],32:[o.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_ASTC_8X5_KHR,o.GL_EXTENSIONS_CONSTANTS.COMPRESSED_SRGB8_ALPHA8_ASTC_8X5_KHR],33:[o.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_ASTC_8X6_KHR,o.GL_EXTENSIONS_CONSTANTS.COMPRESSED_SRGB8_ALPHA8_ASTC_8X6_KHR],34:[o.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_ASTC_8X8_KHR,o.GL_EXTENSIONS_CONSTANTS.COMPRESSED_SRGB8_ALPHA8_ASTC_8X8_KHR],35:[o.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_ASTC_10X5_KHR,o.GL_EXTENSIONS_CONSTANTS.COMPRESSED_SRGB8_ALPHA8_ASTC_10X5_KHR],36:[o.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_ASTC_10X6_KHR,o.GL_EXTENSIONS_CONSTANTS.COMPRESSED_SRGB8_ALPHA8_ASTC_10X6_KHR],37:[o.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_ASTC_10X8_KHR,o.GL_EXTENSIONS_CONSTANTS.COMPRESSED_SRGB8_ALPHA8_ASTC_10X8_KHR],38:[o.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_ASTC_10X10_KHR,o.GL_EXTENSIONS_CONSTANTS.COMPRESSED_SRGB8_ALPHA8_ASTC_10X10_KHR],39:[o.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_ASTC_12X10_KHR,o.GL_EXTENSIONS_CONSTANTS.COMPRESSED_SRGB8_ALPHA8_ASTC_12X10_KHR],40:[o.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_ASTC_12X12_KHR,o.GL_EXTENSIONS_CONSTANTS.COMPRESSED_SRGB8_ALPHA8_ASTC_12X12_KHR]},m={0:C,1:C,2:g,3:g,6:B,7:B,9:_,11:_,22:B,23:_,24:B,25:B,26:_,27:_,28:function(e,t){return Math.floor((e+4)/5)*Math.floor((t+3)/4)*16},29:function(e,t){return Math.floor((e+4)/5)*Math.floor((t+4)/5)*16},30:function(e,t){return Math.floor((e+5)/6)*Math.floor((t+4)/5)*16},31:function(e,t){return Math.floor((e+5)/6)*Math.floor((t+5)/6)*16},32:function(e,t){return Math.floor((e+7)/8)*Math.floor((t+4)/5)*16},33:function(e,t){return Math.floor((e+7)/8)*Math.floor((t+5)/6)*16},34:function(e,t){return Math.floor((e+7)/8)*Math.floor((t+7)/8)*16},35:function(e,t){return Math.floor((e+9)/10)*Math.floor((t+4)/5)*16},36:function(e,t){return Math.floor((e+9)/10)*Math.floor((t+5)/6)*16},37:function(e,t){return Math.floor((e+9)/10)*Math.floor((t+7)/8)*16},38:function(e,t){return Math.floor((e+9)/10)*Math.floor((t+9)/10)*16},39:function(e,t){return Math.floor((e+11)/12)*Math.floor((t+9)/10)*16},40:function(e,t){return Math.floor((e+11)/12)*Math.floor((t+11)/12)*16}};function C(e,t){return(e=Math.max(e,16))*(t=Math.max(t,8))/4}function g(e,t){return(e=Math.max(e,8))*(t=Math.max(t,8))/2}function B(e,t){return Math.floor((e+3)/4)*Math.floor((t+3)/4)*8}function _(e,t){return Math.floor((e+3)/4)*Math.floor((t+3)/4)*16}function y(e){if((0,i.j)(e))return(0,i.P)(e);if(function(e){return new Uint32Array(e,0,l.HEADER_LENGTH)[l.MAGIC_NUMBER_INDEX]===l.MAGIC_NUMBER}(e))return d(e);if(function(e){const t=new Uint32Array(e,0,A.HEADER_LENGTH)[A.MAGIC_NUMBER_INDEX];return t===A.MAGIC_NUMBER||t===A.MAGIC_NUMBER_EXTRA}(e))return function(e){const t=new Uint32Array(e,0,A.HEADER_LENGTH),n=t[A.PIXEL_FORMAT_INDEX],r=t[A.COLOUR_SPACE_INDEX],i=p[n]||[],s=i.length>1&&r?i[1]:i[0],o=m[n],l=t[A.MIPMAPCOUNT_INDEX],c=t[A.WIDTH_INDEX],u=t[A.HEIGHT_INDEX],d=A.HEADER_SIZE+t[A.METADATA_SIZE_INDEX],h=new Uint8Array(e,d);return(0,a.J)(h,{mipMapLevels:l,width:c,height:u,sizeFunction:o,internalFormat:s})}(e);throw new Error("Texture container format not recognized")}var E=n(33313);const T={...{name:"Texture Containers",id:"compressed-texture",module:"textures",version:r.q,worker:!0,extensions:["ktx","ktx2","dds","pvr"],mimeTypes:["image/ktx2","image/ktx","image/vnd-ms.dds","image/x-dds","application/octet-stream"],binary:!0,options:{"compressed-texture":{libraryPath:"libs/",useBasis:!1}}},parse:async(e,t)=>{var n;if(null!=t&&null!=(n=t["compressed-texture"])&&n.useBasis){t.basis={format:{alpha:"BC3",noAlpha:"BC1"},...t.basis,containerFormat:"ktx2",module:"encoder"};return(await(0,E.Z)(e,t))[0]}return y(e)}}},35936:(e,t,n)=>{"use strict";n.d(t,{GL_EXTENSIONS_CONSTANTS:()=>r});const r={COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_RGBA8_ETC2_EAC:37493,COMPRESSED_SRGB8_ETC2:37494,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37495,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37496,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37497,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,COMPRESSED_RGB_ATC_WEBGL:35986,COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL:35987,COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL:34798,COMPRESSED_RGBA_ASTC_4X4_KHR:37808,COMPRESSED_RGBA_ASTC_5X4_KHR:37809,COMPRESSED_RGBA_ASTC_5X5_KHR:37810,COMPRESSED_RGBA_ASTC_6X5_KHR:37811,COMPRESSED_RGBA_ASTC_6X6_KHR:37812,COMPRESSED_RGBA_ASTC_8X5_KHR:37813,COMPRESSED_RGBA_ASTC_8X6_KHR:37814,COMPRESSED_RGBA_ASTC_8X8_KHR:37815,COMPRESSED_RGBA_ASTC_10X5_KHR:37816,COMPRESSED_RGBA_ASTC_10X6_KHR:37817,COMPRESSED_RGBA_ASTC_10X8_KHR:37818,COMPRESSED_RGBA_ASTC_10X10_KHR:37819,COMPRESSED_RGBA_ASTC_12X10_KHR:37820,COMPRESSED_RGBA_ASTC_12X12_KHR:37821,COMPRESSED_SRGB8_ALPHA8_ASTC_4X4_KHR:37840,COMPRESSED_SRGB8_ALPHA8_ASTC_5X4_KHR:37841,COMPRESSED_SRGB8_ALPHA8_ASTC_5X5_KHR:37842,COMPRESSED_SRGB8_ALPHA8_ASTC_6X5_KHR:37843,COMPRESSED_SRGB8_ALPHA8_ASTC_6X6_KHR:37844,COMPRESSED_SRGB8_ALPHA8_ASTC_8X5_KHR:37845,COMPRESSED_SRGB8_ALPHA8_ASTC_8X6_KHR:37846,COMPRESSED_SRGB8_ALPHA8_ASTC_8X8_KHR:37847,COMPRESSED_SRGB8_ALPHA8_ASTC_10X5_KHR:37848,COMPRESSED_SRGB8_ALPHA8_ASTC_10X6_KHR:37849,COMPRESSED_SRGB8_ALPHA8_ASTC_10X8_KHR:37850,COMPRESSED_SRGB8_ALPHA8_ASTC_10X10_KHR:37851,COMPRESSED_SRGB8_ALPHA8_ASTC_12X10_KHR:37852,COMPRESSED_SRGB8_ALPHA8_ASTC_12X12_KHR:37853,COMPRESSED_RED_RGTC1_EXT:36283,COMPRESSED_SIGNED_RED_RGTC1_EXT:36284,COMPRESSED_RED_GREEN_RGTC2_EXT:36285,COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT:36286,COMPRESSED_SRGB_S3TC_DXT1_EXT:35916,COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT:35917,COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT:35918,COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT:35919}},33313:(e,t,n)=>{"use strict";n.d(t,{Z:()=>f,h:()=>B});var r=n(94236);const i={TRANSCODER:"basis_transcoder.js",TRANSCODER_WASM:"basis_transcoder.wasm",ENCODER:"basis_encoder.js",ENCODER_WASM:"basis_encoder.wasm"};let s,o;async function a(e){const t=e.modules||{};return t.basis?t.basis:(s=s||async function(e){let t=null,n=null;return[t,n]=await Promise.all([await(0,r.Y)(i.TRANSCODER,"textures",e),await(0,r.Y)(i.TRANSCODER_WASM,"textures",e)]),t=t||globalThis.BASIS,await function(e,t){const n={};t&&(n.wasmBinary=t);return new Promise((t=>{e(n).then((e=>{const{BasisFile:n,initializeBasis:r}=e;r(),t({BasisFile:n})}))}))}(t,n)}(e),await s)}async function l(e){const t=e.modules||{};return t.basisEncoder?t.basisEncoder:(o=o||async function(e){let t=null,n=null;return[t,n]=await Promise.all([await(0,r.Y)(i.ENCODER,"textures",e),await(0,r.Y)(i.ENCODER_WASM,"textures",e)]),t=t||globalThis.BASIS,await function(e,t){const n={};t&&(n.wasmBinary=t);return new Promise((t=>{e(n).then((e=>{const{BasisFile:n,KTX2File:r,initializeBasis:i,BasisEncoder:s}=e;i(),t({BasisFile:n,KTX2File:r,BasisEncoder:s})}))}))}(t,n)}(e),await o)}var c=n(35936),u=n(45475),d=n(59560);const h={etc1:{basisFormat:0,compressed:!0,format:c.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGB_ETC1_WEBGL},etc2:{basisFormat:1,compressed:!0},bc1:{basisFormat:2,compressed:!0,format:c.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGB_S3TC_DXT1_EXT},bc3:{basisFormat:3,compressed:!0,format:c.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_S3TC_DXT5_EXT},bc4:{basisFormat:4,compressed:!0},bc5:{basisFormat:5,compressed:!0},"bc7-m6-opaque-only":{basisFormat:6,compressed:!0},"bc7-m5":{basisFormat:7,compressed:!0},"pvrtc1-4-rgb":{basisFormat:8,compressed:!0,format:c.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGB_PVRTC_4BPPV1_IMG},"pvrtc1-4-rgba":{basisFormat:9,compressed:!0,format:c.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG},"astc-4x4":{basisFormat:10,compressed:!0,format:c.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_ASTC_4X4_KHR},"atc-rgb":{basisFormat:11,compressed:!0},"atc-rgba-interpolated-alpha":{basisFormat:12,compressed:!0},rgba32:{basisFormat:13,compressed:!1},rgb565:{basisFormat:14,compressed:!1},bgr565:{basisFormat:15,compressed:!1},rgba4444:{basisFormat:16,compressed:!1}};async function f(e,t){if("auto"===t.basis.containerFormat){if((0,d.j)(e)){return m((await l(t)).KTX2File,e,t)}const{BasisFile:n}=await a(t);return A(n,e,t)}if("encoder"===t.basis.module){const n=await l(t);return"ktx2"===t.basis.containerFormat?m(n.KTX2File,e,t):A(n.BasisFile,e,t)}{const{BasisFile:n}=await a(t);return A(n,e,t)}}function A(e,t,n){const r=new e(new Uint8Array(t));try{if(!r.startTranscoding())throw new Error("Failed to start basis transcoding");const e=r.getNumImages(),t=[];for(let i=0;i<e;i++){const e=r.getNumLevels(i),s=[];for(let t=0;t<e;t++)s.push(p(r,i,t,n));t.push(s)}return t}finally{r.close(),r.delete()}}function p(e,t,n,r){const i=e.getImageWidth(t,n),s=e.getImageHeight(t,n),o=e.getHasAlpha(),{compressed:a,format:l,basisFormat:c}=g(r,o),u=e.getImageTranscodedSizeInBytes(t,n,c),d=new Uint8Array(u);if(!e.transcodeImage(d,t,n,c,0,0))throw new Error("failed to start Basis transcoding");return{width:i,height:s,data:d,compressed:a,format:l,hasAlpha:o}}function m(e,t,n){const r=new e(new Uint8Array(t));try{if(!r.startTranscoding())throw new Error("failed to start KTX2 transcoding");const e=r.getLevels(),t=[];for(let i=0;i<e;i++){t.push(C(r,i,n));break}return[t]}finally{r.close(),r.delete()}}function C(e,t,n){const{alphaFlag:r,height:i,width:s}=e.getImageLevelInfo(t,0,0),{compressed:o,format:a,basisFormat:l}=g(n,r),c=e.getImageTranscodedSizeInBytes(t,0,0,l),u=new Uint8Array(c);if(!e.transcodeImage(u,t,0,0,l,0,-1,-1))throw new Error("Failed to transcode KTX2 image");return{width:s,height:i,data:u,compressed:o,levelSize:c,hasAlpha:r,format:a}}function g(e,t){let n=e&&e.basis&&e.basis.format;return"auto"===n&&(n=B()),"object"==typeof n&&(n=t?n.alpha:n.noAlpha),n=n.toLowerCase(),h[n]}function B(){const e=(0,u.U)();return e.has("astc")?"astc-4x4":e.has("dxt")?{alpha:"bc3",noAlpha:"bc1"}:e.has("pvrtc")?{alpha:"pvrtc1-4-rgba",noAlpha:"pvrtc1-4-rgb"}:e.has("etc1")?"etc1":e.has("etc2")?"etc2":"rgb565"}},59560:(e,t,n)=>{"use strict";n.d(t,{j:()=>l,P:()=>c});var r=n(31029),i=n(28926),s=n(35936);const o={131:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGB_S3TC_DXT1_EXT,132:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_SRGB_S3TC_DXT1_EXT,133:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_S3TC_DXT1_EXT,134:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,135:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_S3TC_DXT3_EXT,136:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,137:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_S3TC_DXT5_EXT,138:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT,139:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RED_RGTC1_EXT,140:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_SIGNED_RED_RGTC1_EXT,141:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RED_GREEN_RGTC2_EXT,142:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT,147:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGB8_ETC2,148:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_SRGB8_ETC2,149:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2,150:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2,151:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA8_ETC2_EAC,152:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC,153:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_R11_EAC,154:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_SIGNED_R11_EAC,155:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RG11_EAC,156:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_SIGNED_RG11_EAC,157:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_ASTC_4x4_KHR,158:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR,159:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_ASTC_5x4_KHR,160:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_SRGB8_ALPHA8_ASTC_5X4_KHR,161:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_ASTC_5x5_KHR,162:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR,163:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_ASTC_6x5_KHR,164:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR,165:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_ASTC_6x6_KHR,166:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR,167:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_ASTC_8x5_KHR,168:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR,169:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_ASTC_8x6_KHR,170:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR,171:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_ASTC_8x8_KHR,172:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR,173:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_ASTC_10x5_KHR,174:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR,175:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_ASTC_10x6_KHR,176:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR,177:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_ASTC_10x8_KHR,178:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR,179:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_ASTC_10x10_KHR,180:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR,181:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_ASTC_12x10_KHR,182:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR,183:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_ASTC_12x12_KHR,184:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR,1000054e3:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG,1000054001:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG,1000066e3:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_ASTC_4x4_KHR,1000066001:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_ASTC_5x4_KHR,1000066002:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_ASTC_5x5_KHR,1000066003:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_ASTC_6x5_KHR,1000066004:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_ASTC_6x6_KHR,1000066005:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_ASTC_8x5_KHR,1000066006:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_ASTC_8x6_KHR,1000066007:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_ASTC_8x8_KHR,1000066008:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_ASTC_10x5_KHR,1000066009:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_ASTC_10x6_KHR,1000066010:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_ASTC_10x8_KHR,1000066011:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_ASTC_10x10_KHR,1000066012:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_ASTC_12x10_KHR,1000066013:s.GL_EXTENSIONS_CONSTANTS.COMPRESSED_RGBA_ASTC_12x12_KHR};const a=[171,75,84,88,32,50,48,187,13,10,26,10];function l(e){const t=new Uint8Array(e);return!(t.byteLength<a.length||t[0]!==a[0]||t[1]!==a[1]||t[2]!==a[2]||t[3]!==a[3]||t[4]!==a[4]||t[5]!==a[5]||t[6]!==a[6]||t[7]!==a[7]||t[8]!==a[8]||t[9]!==a[9]||t[10]!==a[10]||t[11]!==a[11])}function c(e){const t=new Uint8Array(e),n=(0,r.ij)(t),s=Math.max(1,n.levels.length),a=n.pixelWidth,l=n.pixelHeight,c=(u=n.vkFormat,o[u]);var u;return(0,i.J)(n.levels,{mipMapLevels:s,width:a,height:l,sizeFunction:e=>e.uncompressedByteLength,internalFormat:c})}},28926:(e,t,n)=>{"use strict";function r(e,t){const n=new Array(t.mipMapLevels);let r=t.width,o=t.height,a=0;for(let l=0;l<t.mipMapLevels;++l){const c=s(t,r,o,e,l),u=i(e,l,a,c);n[l]={compressed:!0,format:t.internalFormat,data:u,width:r,height:o,levelSize:c},r=Math.max(1,r>>1),o=Math.max(1,o>>1),a+=c}return n}function i(e,t,n,r){return Array.isArray(e)?e[t].levelData:new Uint8Array(e.buffer,e.byteOffset+n,r)}function s(e,t,n,r,i){return Array.isArray(r)?e.sizeFunction(r[i]):e.sizeFunction(t,n)}n.d(t,{J:()=>r})},45475:(e,t,n)=>{"use strict";n.d(t,{U:()=>o});const r=["","WEBKIT_","MOZ_"],i={WEBGL_compressed_texture_s3tc:"dxt",WEBGL_compressed_texture_s3tc_srgb:"dxt-srgb",WEBGL_compressed_texture_etc1:"etc1",WEBGL_compressed_texture_etc:"etc2",WEBGL_compressed_texture_pvrtc:"pvrtc",WEBGL_compressed_texture_atc:"atc",WEBGL_compressed_texture_astc:"astc",EXT_texture_compression_rgtc:"rgtc"};let s=null;function o(e){if(!s){e=e||function(){try{return document.createElement("canvas").getContext("webgl")}catch(e){return null}}()||void 0,s=new Set;for(const t of r)for(const n in i)if(e&&e.getExtension(""+t+n)){const e=i[n];s.add(e)}}return s}},14428:(e,t,n)=>{"use strict";n.d(t,{q:()=>r});const r="undefined"!=typeof __VERSION__?__VERSION__:"beta"},5860:(e,t,n)=>{"use strict";n.d(t,{F$:()=>i,Qb:()=>r,R7:()=>s,ci:()=>a,fB:()=>l,i3:()=>o});const r={UNLOADED:0,LOADING:1,PROCESSING:2,READY:3,EXPIRED:4,FAILED:5};let i=function(e){return e[e.ADD=1]="ADD",e[e.REPLACE=2]="REPLACE",e}({}),s=function(e){return e.EMPTY="empty",e.SCENEGRAPH="scenegraph",e.POINTCLOUD="pointcloud",e.MESH="mesh",e}({}),o=function(e){return e.I3S="I3S",e.TILES3D="TILES3D",e}({}),a=function(e){return e.GEOMETRIC_ERROR="geometricError",e.MAX_SCREEN_THRESHOLD="maxScreenThreshold",e}({});const l={NOT_COMPUTED:-1,USE_OPTIMIZATION:1,SKIP_OPTIMIZATION:0}},8580:(e,t,n)=>{"use strict";n.d(t,{u:()=>Te});var r=n(85451),i=n(43855),s=n(98759),o=n(8700),a=n(80072),l=n(41868);class c{constructor(e,t,n){this.item=e,this.previous=t,this.next=n}}class u{constructor(){this.head=null,this.tail=null,this._length=0}get length(){return this._length}add(e){const t=new c(e,this.tail,null);return this.tail?(this.tail.next=t,this.tail=t):(this.head=t,this.tail=t),++this._length,t}remove(e){e&&(e.previous&&e.next?(e.previous.next=e.next,e.next.previous=e.previous):e.previous?(e.previous.next=null,this.tail=e.previous):e.next?(e.next.previous=null,this.head=e.next):(this.head=null,this.tail=null),e.next=null,e.previous=null,--this._length)}splice(e,t){e!==t&&(this.remove(t),this._insert(e,t))}_insert(e,t){const n=e.next;e.next=t,this.tail===e?this.tail=t:n.previous=t,t.next=n,t.previous=e,++this._length}}class d{constructor(){this._list=new u,this._sentinel=this._list.add("sentinel"),this._trimTiles=!1}reset(){this._list.splice(this._list.tail,this._sentinel)}touch(e){const t=e._cacheNode;t&&this._list.splice(this._sentinel,t)}add(e,t,n){t._cacheNode||(t._cacheNode=this._list.add(t),n&&n(e,t))}unloadTile(e,t,n){const r=t._cacheNode;r&&(this._list.remove(r),t._cacheNode=null,n&&n(e,t))}unloadTiles(e,t){const n=this._trimTiles;this._trimTiles=!1;const r=this._list,i=1024*e.maximumMemoryUsage*1024,s=this._sentinel;let o=r.head;for(;o!==s&&(e.gpuMemoryUsageInBytes>i||n);){const n=o.item;o=o.next,this.unloadTile(e,n,t)}}trim(){this._trimTiles=!0}}var h=n(61573);var f=n(36625);const A=new i.Z,p=new i.Z,m=new f.Mh([new f.JO,new f.JO,new f.JO,new f.JO,new f.JO,new f.JO]);function C(e,t){const{cameraDirection:n,cameraUp:r,height:o}=e,{metersPerUnit:a}=e.distanceScales,l=B(e,e.center),c=s.H.WGS84.eastNorthUpToFixedFrame(l),u=e.unprojectPosition(e.cameraPosition),d=s.H.WGS84.cartographicToCartesian(u,new i.Z),h=new i.Z(c.transformAsVector(new i.Z(n).scale(a))).normalize(),f=new i.Z(c.transformAsVector(new i.Z(r).scale(a))).normalize();!function(e){const t=e.getFrustumPlanes(),n=g(t.near,e.cameraPosition),r=B(e,n),i=B(e,e.cameraPosition,p);let s=0;m.planes[s++].fromPointNormal(r,A.copy(r).subtract(i));for(const o in t){if("near"===o)continue;const i=B(e,g(t[o],n,p),p);m.planes[s++].fromPointNormal(i,A.copy(r).subtract(i))}}(e);const C=e.constructor,{longitude:_,latitude:y,width:E,bearing:T,zoom:b}=e;return{camera:{position:d,direction:h,up:f},viewport:e,topDownViewport:new C({longitude:_,latitude:y,height:o,width:E,bearing:T,zoom:b,pitch:0}),height:o,cullingVolume:m,frameNumber:t,sseDenominator:1.15}}function g(e,t,n){void 0===n&&(n=new i.Z);const r=e.normal.dot(t);return n.copy(e.normal).scale(e.distance-r).add(t),n}function B(e,t,n){void 0===n&&(n=new i.Z);const r=e.unprojectPosition(t);return s.H.WGS84.cartographicToCartesian(r,n)}const _=6356752.314245179,y=new i.Z;function E(e,t){if(e instanceof f.F7){const{halfAxes:n}=e,r=function(e){e.getColumn(0,y);const t=e.getColumn(1),n=e.getColumn(2),r=y.add(t).add(n);return r.len()}(n);return Math.log2(_/(r+t[2]))}if(e instanceof f.KM){const{radius:n}=e;return Math.log2(_/(n+t[2]))}if(e.width&&e.height){const{width:t,height:n}=e;return(Math.log2(6378137/t)+Math.log2(6378137/n))/2}return 1}function T(e,t,n){s.H.WGS84.cartographicToCartesian([e.xmax,e.ymax,e.zmax],y);const r=Math.sqrt(Math.pow(y[0]-n[0],2)+Math.pow(y[1]-n[1],2)+Math.pow(y[2]-n[2],2));return Math.log2(_/(r+t[2]))}var b=n(35889),S=n(5860),w=n(14034),R=n(79108),I=n(80540);function D(e){return null!=e}const v=new i.Z,O=new i.Z,G=new i.Z,M=new i.Z,x=new i.Z,N=new i.Z,F=new i.Z,P=new i.Z;function L(e,t,n){if((0,h.h)(e,"3D Tile: boundingVolume must be defined"),e.box)return H(e.box,t,n);if(e.region)return function(e){const[t,n,o,a,l,c]=e,u=s.H.WGS84.cartographicToCartesian([(0,w.RW)(t),(0,w.RW)(a),l],G),d=s.H.WGS84.cartographicToCartesian([(0,w.RW)(o),(0,w.RW)(n),c],M),h=(new i.Z).addVectors(u,d).multiplyByScalar(.5);return s.H.WGS84.cartesianToCartographic(h,x),s.H.WGS84.cartographicToCartesian([(0,w.RW)(o),x[1],x[2]],N),s.H.WGS84.cartographicToCartesian([x[0],(0,w.RW)(a),x[2]],F),s.H.WGS84.cartographicToCartesian([x[0],x[1],c],P),H([...h,...N.subtract(h),...F.subtract(h),...P.subtract(h)],new r.Z)}(e.region);if(e.sphere)return function(e,t,n){const r=new i.Z(e[0],e[1],e[2]);t.transform(r,r);const s=t.getScale(O),o=Math.max(Math.max(s[0],s[1]),s[2]),a=e[3]*o;if(D(n))return n.center=r,n.radius=a,n;return new f.KM(r,a)}(e.sphere,t,n);throw new Error("3D Tile: boundingVolume must contain a sphere, region, or box")}function U(e,t){if(e.box)return function(e){const t=J(),{halfAxes:n}=e,r=new i.Z(n.getColumn(0)),s=new i.Z(n.getColumn(1)),o=new i.Z(n.getColumn(2));for(let i=0;i<2;i++){for(let n=0;n<2;n++){for(let n=0;n<2;n++)v.copy(e.center),v.add(r),v.add(s),v.add(o),X(t,v),o.negate();s.negate()}r.negate()}return t}(t);if(e.region){const[t,n,r,i,s,o]=e.region;return[[(0,w.RW)(t),(0,w.RW)(n),s],[(0,w.RW)(r),(0,w.RW)(i),o]]}if(e.sphere)return function(e){const t=J(),{center:n,radius:r}=e,o=s.H.WGS84.scaleToGeodeticSurface(n,v);let a;a=o?s.H.WGS84.geodeticSurfaceNormal(o):new i.Z(0,0,1);let l=new i.Z(a[2],-a[1],0);l.len()>0?l.normalize():l=new i.Z(0,1,0);const c=l.clone().cross(a);for(const i of[l,c,a]){O.copy(i).scale(r);for(let e=0;e<2;e++)v.copy(n),v.add(O),X(t,v),O.negate()}return t}(t);throw new Error("Unkown boundingVolume type")}function H(e,t,n){const r=new i.Z(e[0],e[1],e[2]);t.transform(r,r);let s=[];if(10===e.length){const t=e.slice(3,6),n=new R.Z;n.fromArray(e,6);const r=new i.Z([1,0,0]),o=new i.Z([0,1,0]),a=new i.Z([0,0,1]);r.transformByQuaternion(n),r.scale(t[0]),o.transformByQuaternion(n),o.scale(t[1]),a.transformByQuaternion(n),a.scale(t[2]),s=[...r.toArray(),...o.toArray(),...a.toArray()]}else s=[...e.slice(3,6),...e.slice(6,9),...e.slice(9,12)];const o=t.transformAsVector(s.slice(0,3)),a=t.transformAsVector(s.slice(3,6)),l=t.transformAsVector(s.slice(6,9)),c=new I.Z([o[0],o[1],o[2],a[0],a[1],a[2],l[0],l[1],l[2]]);return D(n)?(n.center=r,n.halfAxes=c,n):new f.F7(r,c)}function J(){return[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]]}function X(e,t){s.H.WGS84.cartesianToCartographic(t,v),e[0][0]=Math.min(e[0][0],v[0]),e[0][1]=Math.min(e[0][1],v[1]),e[0][2]=Math.min(e[0][2],v[2]),e[1][0]=Math.max(e[1][0],v[0]),e[1][1]=Math.max(e[1][1],v[1]),e[1][2]=Math.max(e[1][2],v[2])}new i.Z,new i.Z,new r.Z,new i.Z,new i.Z,new i.Z;function j(e,t){if(e.dynamicScreenSpaceError&&e.dynamicScreenSpaceErrorComputedDensity){const n=e.dynamicScreenSpaceErrorComputedDensity,r=e.dynamicScreenSpaceErrorFactor,i=function(e,t){const n=e*t;return 1-Math.exp(-n*n)}(t,n)*r;return i}return 0}const k=new i.Z,K=new i.Z,V=new i.Z,Q=new i.Z,Z=new i.Z,W=new r.Z,z=new r.Z;function Y(e,t){const{topDownViewport:n}=t,r=e.header.mbs[1],i=e.header.mbs[0],o=e.header.mbs[2],a=e.header.mbs[3],l=[...e.boundingVolume.center],c=n.unprojectPosition(n.cameraPosition);s.H.WGS84.cartographicToCartesian(c,k),K.copy(k).subtract(l).normalize(),s.H.WGS84.eastNorthUpToFixedFrame(l,W),z.copy(W).invert(),V.copy(k).transform(z);const u=Math.sqrt(V[0]*V[0]+V[1]*V[1]),d=u*u/V[2];Q.copy([V[0],V[1],d]);const h=Q.transform(W).subtract(l).normalize(),f=K.cross(h).normalize().scale(a).add(l),A=s.H.WGS84.cartesianToCartographic(f),p=n.project([i,r,o]),m=n.project(A);return Z.copy(p).subtract(m).magnitude()}class q{constructor(e){void 0===e&&(e=0),this._map=new Map,this._array=new Array(e),this._length=e}get length(){return this._length}set length(e){this._length=e,e>this._array.length&&(this._array.length=e)}get values(){return this._array}get(e){return(0,h.h)(e<this._array.length),this._array[e]}set(e,t){(0,h.h)(e>=0),e>=this.length&&(this.length=e+1),this._map.has(this._array[e])&&this._map.delete(this._array[e]),this._array[e]=t,this._map.set(t,e)}delete(e){const t=this._map.get(e);t>=0&&(this._array.splice(t,1),this._map.delete(e),this.length--)}peek(){return this._array[this._length-1]}push(e){if(!this._map.has(e)){const t=this.length++;this._array[t]=e,this._map.set(e,t)}}pop(){const e=this._array[--this.length];return this._map.delete(e),e}reserve(e){(0,h.h)(e>=0),e>this._array.length&&(this._array.length=e)}resize(e){(0,h.h)(e>=0),this.length=e}trim(e){null==e&&(e=this.length),this._array.length=e}reset(){this._array=[],this._map=new Map,this._length=0}find(e){return this._map.has(e)}}const $={loadSiblings:!1,skipLevelOfDetail:!1,maximumScreenSpaceError:2,updateTransforms:!0,onTraversalEnd:()=>{},viewportTraversersMap:{},basePath:""};class ee{traversalFinished(e){return!0}constructor(e){this.root=null,this.selectedTiles={},this.requestedTiles={},this.emptyTiles={},this.lastUpdate=(new Date).getTime(),this.updateDebounceTime=1e3,this._traversalStack=new q,this._emptyTraversalStack=new q,this._frameNumber=null,this.options={...$,...e}}traverse(e,t,n){this.root=e,this.options={...this.options,...n},this.reset(),this.updateTile(e,t),this._frameNumber=t.frameNumber,this.executeTraversal(e,t)}reset(){this.requestedTiles={},this.selectedTiles={},this.emptyTiles={},this._traversalStack.reset(),this._emptyTraversalStack.reset()}executeTraversal(e,t){const n=this._traversalStack;for(e._selectionDepth=1,n.push(e);n.length>0;){const e=n.pop();let r=!1;this.canTraverse(e,t)&&(this.updateChildTiles(e,t),r=this.updateAndPushChildren(e,t,n,e.hasRenderContent?e._selectionDepth+1:e._selectionDepth));const i=e.parent,s=Boolean(!i||i._shouldRefine),o=!r;e.hasRenderContent?e.refine===S.F$.ADD?(this.loadTile(e,t),this.selectTile(e,t)):e.refine===S.F$.REPLACE&&(this.loadTile(e,t),o&&this.selectTile(e,t)):(this.emptyTiles[e.id]=e,this.loadTile(e,t),o&&this.selectTile(e,t)),this.touchTile(e,t),e._shouldRefine=r&&s}const r=(new Date).getTime();(this.traversalFinished(t)||r-this.lastUpdate>this.updateDebounceTime)&&(this.lastUpdate=r,this.options.onTraversalEnd(t))}updateChildTiles(e,t){const n=e.children;for(const r of n)this.updateTile(r,t)}updateAndPushChildren(e,t,n,r){const{loadSiblings:i,skipLevelOfDetail:s}=this.options,o=e.children;o.sort(this.compareDistanceToCamera.bind(this));const a=e.refine===S.F$.REPLACE&&e.hasRenderContent&&!s;let l=!1,c=!0;for(const u of o)if(u._selectionDepth=r,u.isVisibleAndInRequestVolume?(n.find(u)&&n.delete(u),n.push(u),l=!0):(a||i)&&(this.loadTile(u,t),this.touchTile(u,t)),a){let e;if(e=!!u._inRequestVolume&&(u.hasRenderContent?u.contentAvailable:this.executeEmptyTraversal(u,t)),c=c&&e,!c)return!1}return l||(c=!1),c}updateTile(e,t){this.updateTileVisibility(e,t)}selectTile(e,t){this.shouldSelectTile(e)&&(e._selectedFrame=t.frameNumber,this.selectedTiles[e.id]=e)}loadTile(e,t){this.shouldLoadTile(e)&&(e._requestedFrame=t.frameNumber,e._priority=e._getPriority(),this.requestedTiles[e.id]=e)}touchTile(e,t){e.tileset._cache.touch(e),e._touchedFrame=t.frameNumber}canTraverse(e,t,n,r){return void 0===n&&(n=!1),void 0===r&&(r=!1),!!e.hasChildren&&(e.hasTilesetContent?!e.contentExpired:!(!r&&!e.isVisibleAndInRequestVolume)&&this.shouldRefine(e,t,n))}shouldLoadTile(e){return e.hasUnloadedContent||e.contentExpired}shouldSelectTile(e){return e.contentAvailable&&!this.options.skipLevelOfDetail}shouldRefine(e,t,n){void 0===n&&(n=!1);let r=e._screenSpaceError;return n&&(r=e.getScreenSpaceError(t,!0)),r>this.options.maximumScreenSpaceError}updateTileVisibility(e,t){const n=[];if(this.options.viewportTraversersMap)for(const r in this.options.viewportTraversersMap){this.options.viewportTraversersMap[r]===t.viewport.id&&n.push(r)}else n.push(t.viewport.id);e.updateVisibility(t,n)}compareDistanceToCamera(e,t){return e._distanceToCamera-t._distanceToCamera}anyChildrenVisible(e,t){let n=!1;for(const r of e.children)r.updateVisibility(t),n=n||r.isVisibleAndInRequestVolume;return n}executeEmptyTraversal(e,t){let n=!0;const r=this._emptyTraversalStack;for(r.push(e);r.length>0&&n;){const e=r.pop();this.updateTile(e,t),e.isVisibleAndInRequestVolume||this.loadTile(e,t),this.touchTile(e,t);if(!e.hasRenderContent&&this.canTraverse(e,t,!1,!0)){const t=e.children;for(const e of t)r.find(e)&&r.delete(e),r.push(e)}else e.contentAvailable||e.hasEmptyContent||(n=!1)}return n}}var te=n(25108);const ne=new i.Z;class re{constructor(e,t,n,i){void 0===i&&(i=""),this.lodMetricType="geometricError",this.lodMetricValue=0,this.boundingVolume=null,this.content=null,this.contentState=S.Qb.UNLOADED,this.gpuMemoryUsageInBytes=0,this.children=[],this.depth=0,this.viewportIds=[],this.transform=new r.Z,this.extensions=null,this.implicitTiling=null,this.userData={},this.hasEmptyContent=!1,this.hasTilesetContent=!1,this.traverser=new ee({}),this._cacheNode=null,this._frameNumber=null,this._expireDate=null,this._expiredContent=null,this._boundingBox=void 0,this._distanceToCamera=0,this._screenSpaceError=0,this._visible=void 0,this._initialTransform=new r.Z,this._priority=0,this._selectedFrame=0,this._requestedFrame=0,this._selectionDepth=0,this._touchedFrame=0,this._centerZDepth=0,this._shouldRefine=!1,this._stackLength=0,this._visitedFrame=0,this._inRequestVolume=!1,this._lodJudge=null,this.header=t,this.tileset=e,this.id=i||t.id,this.url=t.url,this.parent=n,this.refine=this._getRefine(t.refine),this.type=t.type,this.contentUrl=t.contentUrl,this._initializeLodMetric(t),this._initializeTransforms(t),this._initializeBoundingVolumes(t),this._initializeContent(t),this._initializeRenderingState(t),Object.seal(this)}destroy(){this.header=null}isDestroyed(){return null===this.header}get selected(){return this._selectedFrame===this.tileset._frameNumber}get isVisible(){return this._visible}get isVisibleAndInRequestVolume(){return this._visible&&this._inRequestVolume}get hasRenderContent(){return!this.hasEmptyContent&&!this.hasTilesetContent}get hasChildren(){return this.children.length>0||this.header.children&&this.header.children.length>0}get contentReady(){return this.contentState===S.Qb.READY||this.hasEmptyContent}get contentAvailable(){return Boolean(this.contentReady&&this.hasRenderContent||this._expiredContent&&!this.contentFailed)}get hasUnloadedContent(){return this.hasRenderContent&&this.contentUnloaded}get contentUnloaded(){return this.contentState===S.Qb.UNLOADED}get contentExpired(){return this.contentState===S.Qb.EXPIRED}get contentFailed(){return this.contentState===S.Qb.FAILED}get distanceToCamera(){return this._distanceToCamera}get screenSpaceError(){return this._screenSpaceError}get boundingBox(){return this._boundingBox||(this._boundingBox=U(this.header.boundingVolume,this.boundingVolume)),this._boundingBox}getScreenSpaceError(e,t){switch(this.tileset.type){case S.i3.I3S:return Y(this,e);case S.i3.TILES3D:return function(e,t,n){const r=e.tileset,i=e.parent&&e.parent.lodMetricValue||e.lodMetricValue,s=n?i:e.lodMetricValue;if(0===s)return 0;const o=Math.max(e._distanceToCamera,1e-7),{height:a,sseDenominator:l}=t,{viewDistanceScale:c}=r.options;let u=s*a*(c||1)/(o*l);return u-=j(r,o),u}(this,e,t);default:throw new Error("Unsupported tileset type")}}unselect(){this._selectedFrame=0}_getGpuMemoryUsageInBytes(){return this.content.gpuMemoryUsageInBytes||this.content.byteLength||0}_getPriority(){const e=this.tileset._traverser,{skipLevelOfDetail:t}=e.options,n=this.refine===S.F$.ADD||t;if(n&&!this.isVisible&&void 0!==this._visible)return-1;if(this.tileset._frameNumber-this._touchedFrame>=1)return-1;if(this.contentState===S.Qb.UNLOADED)return-1;const r=this.parent,i=r&&(!n||0===this._screenSpaceError||r.hasTilesetContent)?r._screenSpaceError:this._screenSpaceError,s=e.root?e.root._screenSpaceError:0;return Math.max(s-i,0)}async loadContent(){if(this.hasEmptyContent)return!1;if(this.content)return!0;this.contentExpired&&(this._expireDate=null),this.contentState=S.Qb.LOADING;const e=await this.tileset._requestScheduler.scheduleRequest(this.id,this._getPriority.bind(this));if(!e)return this.contentState=S.Qb.UNLOADED,!1;try{const e=this.tileset.getTileUrl(this.contentUrl),t=this.tileset.loader,n={...this.tileset.loadOptions,[t.id]:{...this.tileset.loadOptions[t.id],isTileset:"json"===this.type,...this._getLoaderSpecificOptions(t.id)}};return this.content=await(0,b.z)(e,t,n),this.tileset.options.contentLoader&&await this.tileset.options.contentLoader(this),this._isTileset()&&this.tileset._initializeTileHeaders(this.content,this),this.contentState=S.Qb.READY,this._onContentLoaded(),!0}catch(t){throw this.contentState=S.Qb.FAILED,t}finally{e.done()}}unloadContent(){return this.content&&this.content.destroy&&this.content.destroy(),this.content=null,this.header.content&&this.header.content.destroy&&this.header.content.destroy(),this.header.content=null,this.contentState=S.Qb.UNLOADED,!0}updateVisibility(e,t){if(this._frameNumber===e.frameNumber)return;const n=this.parent,r=n?n._visibilityPlaneMask:f.Mh.MASK_INDETERMINATE;if(this.tileset._traverser.options.updateTransforms){const e=n?n.computedTransform:this.tileset.modelMatrix;this._updateTransform(e)}this._distanceToCamera=this.distanceToTile(e),this._screenSpaceError=this.getScreenSpaceError(e,!1),this._visibilityPlaneMask=this.visibility(e,r),this._visible=this._visibilityPlaneMask!==f.Mh.MASK_OUTSIDE,this._inRequestVolume=this.insideViewerRequestVolume(e),this._frameNumber=e.frameNumber,this.viewportIds=t}visibility(e,t){const{cullingVolume:n}=e,{boundingVolume:r}=this;return n.computeVisibilityWithPlaneMask(r,t)}contentVisibility(){return!0}distanceToTile(e){const t=this.boundingVolume;return Math.sqrt(Math.max(t.distanceSquaredTo(e.camera.position),0))}cameraSpaceZDepth(e){let{camera:t}=e;const n=this.boundingVolume;return ne.subVectors(n.center,t.position),t.direction.dot(ne)}insideViewerRequestVolume(e){const t=this._viewerRequestVolume;return!t||t.distanceSquaredTo(e.camera.position)<=0}updateExpiration(){if(null!=this._expireDate&&this.contentReady&&!this.hasEmptyContent){const e=Date.now();Date.lessThan(this._expireDate,e)&&(this.contentState=S.Qb.EXPIRED,this._expiredContent=this.content)}}get extras(){return this.header.extras}_initializeLodMetric(e){"lodMetricType"in e?this.lodMetricType=e.lodMetricType:(this.lodMetricType=this.parent&&this.parent.lodMetricType||this.tileset.lodMetricType,te.warn("3D Tile: Required prop lodMetricType is undefined. Using parent lodMetricType")),"lodMetricValue"in e?this.lodMetricValue=e.lodMetricValue:(this.lodMetricValue=this.parent&&this.parent.lodMetricValue||this.tileset.lodMetricValue,te.warn("3D Tile: Required prop lodMetricValue is undefined. Using parent lodMetricValue"))}_initializeTransforms(e){this.transform=e.transform?new r.Z(e.transform):new r.Z;const t=this.parent,n=this.tileset,i=t&&t.computedTransform?t.computedTransform.clone():n.modelMatrix.clone();this.computedTransform=new r.Z(i).multiplyRight(this.transform);const s=t&&t._initialTransform?t._initialTransform.clone():new r.Z;this._initialTransform=new r.Z(s).multiplyRight(this.transform)}_initializeBoundingVolumes(e){this._contentBoundingVolume=null,this._viewerRequestVolume=null,this._updateBoundingVolume(e)}_initializeContent(e){this.content={_tileset:this.tileset,_tile:this},this.hasEmptyContent=!0,this.contentState=S.Qb.UNLOADED,this.hasTilesetContent=!1,e.contentUrl&&(this.content=null,this.hasEmptyContent=!1)}_initializeRenderingState(e){this.depth=e.level||(this.parent?this.parent.depth+1:0),this._shouldRefine=!1,this._distanceToCamera=0,this._centerZDepth=0,this._screenSpaceError=0,this._visibilityPlaneMask=f.Mh.MASK_INDETERMINATE,this._visible=void 0,this._inRequestVolume=!1,this._stackLength=0,this._selectionDepth=0,this._frameNumber=0,this._touchedFrame=0,this._visitedFrame=0,this._selectedFrame=0,this._requestedFrame=0,this._priority=0}_getRefine(e){return e||this.parent&&this.parent.refine||S.F$.REPLACE}_isTileset(){return-1!==this.contentUrl.indexOf(".json")}_onContentLoaded(){switch(this.content&&this.content.type){case"vctr":case"geom":this.tileset._traverser.disableSkipLevelOfDetail=!0}this._isTileset()?this.hasTilesetContent=!0:this.gpuMemoryUsageInBytes=this._getGpuMemoryUsageInBytes()}_updateBoundingVolume(e){this.boundingVolume=L(e.boundingVolume,this.computedTransform,this.boundingVolume);const t=e.content;t&&(t.boundingVolume&&(this._contentBoundingVolume=L(t.boundingVolume,this.computedTransform,this._contentBoundingVolume)),e.viewerRequestVolume&&(this._viewerRequestVolume=L(e.viewerRequestVolume,this.computedTransform,this._viewerRequestVolume)))}_updateTransform(e){void 0===e&&(e=new r.Z);const t=e.clone().multiplyRight(this.transform);!t.equals(this.computedTransform)&&(this.computedTransform=t,this._updateBoundingVolume(this.header))}_getLoaderSpecificOptions(e){return"i3s"===e?{...this.tileset.options.i3s,_tileOptions:{attributeUrls:this.header.attributeUrls,textureUrl:this.header.textureUrl,textureFormat:this.header.textureFormat,textureLoaderOptions:this.header.textureLoaderOptions,materialDefinition:this.header.materialDefinition,isDracoGeometry:this.header.isDracoGeometry,mbs:this.header.mbs},_tilesetOptions:{store:this.tileset.tileset.store,attributeStorageInfo:this.tileset.tileset.attributeStorageInfo,fields:this.tileset.tileset.fields},isTileHeader:!1}:{assetGltfUpAxis:(t=this.tileset.tileset).asset&&t.asset.gltfUpAxis||"Y"};var t}}class ie extends ee{compareDistanceToCamera(e,t){return 0===t._distanceToCamera&&0===e._distanceToCamera?t._centerZDepth-e._centerZDepth:t._distanceToCamera-e._distanceToCamera}updateTileVisibility(e,t){if(super.updateTileVisibility(e,t),!e.isVisibleAndInRequestVolume)return;const n=e.children.length>0;if(e.hasTilesetContent&&n){const n=e.children[0];return this.updateTileVisibility(n,t),void(e._visible=n._visible)}if(this.meetsScreenSpaceErrorEarly(e,t))return void(e._visible=!1);const r=e.refine===S.F$.REPLACE,i=e._optimChildrenWithinParent===S.fB.USE_OPTIMIZATION;r&&i&&n&&!this.anyChildrenVisible(e,t)&&(e._visible=!1)}meetsScreenSpaceErrorEarly(e,t){const{parent:n}=e;return!(!n||n.hasTilesetContent||n.refine!==S.F$.ADD)&&!this.shouldRefine(e,t,!0)}}class se{constructor(){this.frameNumberMap=new Map}register(e,t){const n=this.frameNumberMap.get(e)||new Map,r=n.get(t)||0;n.set(t,r+1),this.frameNumberMap.set(e,n)}deregister(e,t){const n=this.frameNumberMap.get(e);if(!n)return;const r=n.get(t)||1;n.set(t,r-1)}isZero(e,t){var n;return 0===((null==(n=this.frameNumberMap.get(e))?void 0:n.get(t))||0)}}const oe="REQUESTED",ae="COMPLETED",le="ERROR";class ce{constructor(){this.pendingTilesRegister=new se,this._statusMap={}}add(e,t,n,r){if(!this._statusMap[t]){const{frameNumber:i,viewport:{id:s}}=r;this._statusMap[t]={request:e,callback:n,key:t,frameState:r,status:oe},this.pendingTilesRegister.register(s,i),e().then((e=>{this._statusMap[t].status=ae;const{frameNumber:n,viewport:{id:i}}=this._statusMap[t].frameState;this.pendingTilesRegister.deregister(i,n),this._statusMap[t].callback(e,r)})).catch((e=>{this._statusMap[t].status=le;const{frameNumber:r,viewport:{id:i}}=this._statusMap[t].frameState;this.pendingTilesRegister.deregister(i,r),n(e)}))}}update(e,t){if(this._statusMap[e]){const{frameNumber:n,viewport:{id:r}}=this._statusMap[e].frameState;this.pendingTilesRegister.deregister(r,n);const{frameNumber:i,viewport:{id:s}}=t;this.pendingTilesRegister.register(s,i),this._statusMap[e].frameState=t}}find(e){return this._statusMap[e]}hasPendingTiles(e,t){return!this.pendingTilesRegister.isZero(e,t)}}class ue extends ee{constructor(e){super(e),this._tileManager=new ce}traversalFinished(e){return!this._tileManager.hasPendingTiles(e.viewport.id,this._frameNumber||0)}shouldRefine(e,t){return e._lodJudge=function(e,t){if(0===e.lodMetricValue||isNaN(e.lodMetricValue))return"DIG";const n=2*Y(e,t);return n<2?"OUT":!e.header.children||n<=e.lodMetricValue?"DRAW":e.header.children?"DIG":"OUT"}(e,t),"DIG"===e._lodJudge}updateChildTiles(e,t){const n=e.header.children||[],r=e.children,i=e.tileset;for(const s of n){const n=s.id+"-"+t.viewport.id,o=r&&r.find((e=>e.id===n));if(o)o&&this.updateTile(o,t);else{let r=()=>this._loadTile(s.id,i);this._tileManager.find(n)?this._tileManager.update(n,t):(i.tileset.nodePages&&(r=()=>i.tileset.nodePagesTile.formTileFromNodePages(s.id)),this._tileManager.add(r,n,(t=>this._onTileLoad(t,e,n)),t))}}return!1}async _loadTile(e,t){const{loader:n}=t,r=t.getTileUrl(t.url+"/nodes/"+e),i={...t.loadOptions,i3s:{...t.loadOptions.i3s,isTileHeader:!0}};return await(0,b.z)(r,n,i)}_onTileLoad(e,t,n){const r=new re(t.tileset,e,t,n);t.children.push(r);const i=this._tileManager.find(r.id).frameState;this.updateTile(r,i),this._frameNumber===i.frameNumber&&(this.traversalFinished(i)||(new Date).getTime()-this.lastUpdate>this.updateDebounceTime)&&this.executeTraversal(r,i)}}var de=n(25108);const he={description:"",ellipsoid:s.H.WGS84,modelMatrix:new r.Z,throttleRequests:!0,maxRequests:64,maximumMemoryUsage:32,maximumTilesSelected:0,debounceTime:0,onTileLoad:()=>{},onTileUnload:()=>{},onTileError:()=>{},onTraversalComplete:e=>e,contentLoader:void 0,viewDistanceScale:1,maximumScreenSpaceError:8,loadTiles:!0,updateTransforms:!0,viewportTraversersMap:null,loadOptions:{fetch:{}},attributions:[],basePath:"",i3s:{}},fe="Tiles In Tileset(s)",Ae="Tiles In Memory",pe="Tiles In View",me="Tiles To Render",Ce="Tiles Loaded",ge="Tiles Loading",Be="Tiles Unloaded",_e="Failed Tile Loads",ye="Points/Vertices",Ee="Tile Memory Use";class Te{constructor(e,t){this.root=null,this.roots={},this.asset={},this.description="",this.extras=null,this.attributions={},this.credits={},this.contentFormats={draco:!1,meshopt:!1,dds:!1,ktx2:!1},this.cartographicCenter=null,this.cartesianCenter=null,this.zoom=1,this.boundingVolume=null,this.dynamicScreenSpaceErrorComputedDensity=0,this.maximumMemoryUsage=32,this.gpuMemoryUsageInBytes=0,this._frameNumber=0,this._queryParams={},this._extensionsUsed=[],this._tiles={},this._pendingCount=0,this.selectedTiles=[],this.traverseCounter=0,this.geometricError=0,this.lastUpdatedVieports=null,this._requestedTiles=[],this._emptyTiles=[],this.frameStateData={},this._cache=new d,this.updatePromise=null,this.options={...he,...t},this.tileset=e,this.loader=e.loader,this.type=e.type,this.url=e.url,this.basePath=e.basePath||a.XX(this.url),this.modelMatrix=this.options.modelMatrix,this.ellipsoid=this.options.ellipsoid,this.lodMetricType=e.lodMetricType,this.lodMetricValue=e.lodMetricValue,this.refine=e.root.refine,this.loadOptions=this.options.loadOptions||{},this._traverser=this._initializeTraverser(),this._requestScheduler=new l.Z({throttleRequests:this.options.throttleRequests,maxRequests:this.options.maxRequests}),this.stats=new o.jk({id:this.url}),this._initializeStats(),this.tilesetInitializationPromise=this._initializeTileSet(e)}destroy(){this._destroy()}isLoaded(){return 0===this._pendingCount&&0!==this._frameNumber&&0===this._requestedTiles.length}get tiles(){return Object.values(this._tiles)}get frameNumber(){return this._frameNumber}get queryParams(){return new URLSearchParams(this._queryParams).toString()}setProps(e){this.options={...this.options,...e}}getTileUrl(e){if(e.startsWith("data:"))return e;let t=e;return this.queryParams.length&&(t=e+(e.includes("?")?"&":"?")+this.queryParams),t}hasExtension(e){return Boolean(this._extensionsUsed.indexOf(e)>-1)}update(e){void 0===e&&(e=null),this.tilesetInitializationPromise.then((()=>{!e&&this.lastUpdatedVieports?e=this.lastUpdatedVieports:this.lastUpdatedVieports=e,e&&this.doUpdate(e)}))}async selectTiles(e){return void 0===e&&(e=null),await this.tilesetInitializationPromise,e&&(this.lastUpdatedVieports=e),this.updatePromise||(this.updatePromise=new Promise((e=>{setTimeout((()=>{this.lastUpdatedVieports&&this.doUpdate(this.lastUpdatedVieports),e(this._frameNumber),this.updatePromise=null}),this.options.debounceTime)}))),this.updatePromise}doUpdate(e){if("loadTiles"in this.options&&!this.options.loadTiles)return;if(this.traverseCounter>0)return;const t=e instanceof Array?e:[e];this._cache.reset(),this._frameNumber++,this.traverseCounter=t.length;const n=[];for(const r of t){const e=r.id;this._needTraverse(e)?n.push(e):this.traverseCounter--}for(const r of t){const e=r.id;if(this.roots[e]||(this.roots[e]=this._initializeTileHeaders(this.tileset,null)),!n.includes(e))continue;const t=C(r,this._frameNumber);this._traverser.traverse(this.roots[e],t,this.options)}}_needTraverse(e){let t=e;return this.options.viewportTraversersMap&&(t=this.options.viewportTraversersMap[e]),t===e}_onTraversalEnd(e){const t=e.viewport.id;this.frameStateData[t]||(this.frameStateData[t]={selectedTiles:[],_requestedTiles:[],_emptyTiles:[]});const n=this.frameStateData[t],r=Object.values(this._traverser.selectedTiles),[i,s]=function(e,t,n){if(0===n||e.length<=n)return[e,[]];const r=[],{longitude:i,latitude:s}=t.viewport;for(const[c,u]of e.entries()){const[e,t]=u.header.mbs,n=Math.abs(i-e),o=Math.abs(s-t),a=Math.sqrt(o*o+n*n);r.push([c,a])}const o=r.sort(((e,t)=>e[1]-t[1])),a=[];for(let c=0;c<n;c++)a.push(e[o[c][0]]);const l=[];for(let c=n;c<o.length;c++)l.push(e[o[c][0]]);return[a,l]}(r,e,this.options.maximumTilesSelected);n.selectedTiles=i;for(const o of s)o.unselect();n._requestedTiles=Object.values(this._traverser.requestedTiles),n._emptyTiles=Object.values(this._traverser.emptyTiles),this.traverseCounter--,this.traverseCounter>0||this._updateTiles()}_updateTiles(){this.selectedTiles=[],this._requestedTiles=[],this._emptyTiles=[];for(const e in this.frameStateData){const t=this.frameStateData[e];this.selectedTiles=this.selectedTiles.concat(t.selectedTiles),this._requestedTiles=this._requestedTiles.concat(t._requestedTiles),this._emptyTiles=this._emptyTiles.concat(t._emptyTiles)}this.selectedTiles=this.options.onTraversalComplete(this.selectedTiles);for(const e of this.selectedTiles)this._tiles[e.id]=e;this._loadTiles(),this._unloadTiles(),this._updateStats()}_tilesChanged(e,t){if(e.length!==t.length)return!0;const n=new Set(e.map((e=>e.id))),r=new Set(t.map((e=>e.id)));let i=e.filter((e=>!r.has(e.id))).length>0;return i=i||t.filter((e=>!n.has(e.id))).length>0,i}_loadTiles(){for(const e of this._requestedTiles)e.contentUnloaded&&this._loadTile(e)}_unloadTiles(){this._cache.unloadTiles(this,((e,t)=>e._unloadTile(t)))}_updateStats(){let e=0,t=0;for(const n of this.selectedTiles)n.contentAvailable&&n.content&&(e++,n.content.pointCount?t+=n.content.pointCount:t+=n.content.vertexCount);this.stats.get(pe).count=this.selectedTiles.length,this.stats.get(me).count=e,this.stats.get(ye).count=t}async _initializeTileSet(e){this.type===S.i3.I3S&&(this.calculateViewPropsI3S(),e.root=await e.root),this.root=this._initializeTileHeaders(e,null),this.type===S.i3.TILES3D&&(this._initializeTiles3DTileset(e),this.calculateViewPropsTiles3D()),this.type===S.i3.I3S&&this._initializeI3STileset()}calculateViewPropsI3S(){var e;const t=this.tileset.fullExtent;if(t){const{xmin:e,xmax:n,ymin:r,ymax:o,zmin:a,zmax:l}=t;return this.cartographicCenter=new i.Z(e+(n-e)/2,r+(o-r)/2,a+(l-a)/2),this.cartesianCenter=new i.Z,s.H.WGS84.cartographicToCartesian(this.cartographicCenter,this.cartesianCenter),void(this.zoom=T(t,this.cartographicCenter,this.cartesianCenter))}const n=null==(e=this.tileset.store)?void 0:e.extent;if(n){const[e,t,r,o]=n;return this.cartographicCenter=new i.Z(e+(r-e)/2,t+(o-t)/2,0),this.cartesianCenter=new i.Z,s.H.WGS84.cartographicToCartesian(this.cartographicCenter,this.cartesianCenter),void(this.zoom=function(e,t,n){const[r,i,s,o]=e;return T({xmin:r,xmax:s,ymin:i,ymax:o,zmin:0,zmax:0},t,n)}(n,this.cartographicCenter,this.cartesianCenter))}de.warn("Extent is not defined in the tileset header"),this.cartographicCenter=new i.Z,this.zoom=1}calculateViewPropsTiles3D(){const e=this.root,{center:t}=e.boundingVolume;if(!t)return de.warn("center was not pre-calculated for the root tile"),this.cartographicCenter=new i.Z,void(this.zoom=1);0!==t[0]||0!==t[1]||0!==t[2]?(this.cartographicCenter=new i.Z,s.H.WGS84.cartesianToCartographic(t,this.cartographicCenter)):this.cartographicCenter=new i.Z(0,0,-s.H.WGS84.radii[0]),this.cartesianCenter=t,this.zoom=E(e.boundingVolume,this.cartographicCenter)}_initializeStats(){this.stats.get(fe),this.stats.get(ge),this.stats.get(Ae),this.stats.get(pe),this.stats.get(me),this.stats.get(Ce),this.stats.get(Be),this.stats.get(_e),this.stats.get(ye),this.stats.get(Ee,"memory")}_initializeTileHeaders(e,t){const n=new re(this,e.root,t);if(t&&(t.children.push(n),n.depth=t.depth+1),this.type===S.i3.TILES3D){const e=[];for(e.push(n);e.length>0;){const t=e.pop();this.stats.get(fe).incrementCount();const n=t.header.children||[];for(const i of n){var r;const n=new re(this,i,t);if(null!=(r=n.contentUrl)&&r.includes("?session=")){const e=new URL(n.contentUrl).searchParams.get("session");e&&(this._queryParams.session=e)}t.children.push(n),n.depth=t.depth+1,e.push(n)}}}return n}_initializeTraverser(){let e;switch(this.type){case S.i3.TILES3D:e=ie;break;case S.i3.I3S:e=ue;break;default:e=ee}return new e({basePath:this.basePath,onTraversalEnd:this._onTraversalEnd.bind(this)})}_destroyTileHeaders(e){this._destroySubtree(e)}async _loadTile(e){let t;try{this._onStartTileLoading(),t=await e.loadContent()}catch(n){this._onTileLoadError(e,n instanceof Error?n:new Error("load failed"))}finally{this._onEndTileLoading(),this._onTileLoad(e,t)}}_onTileLoadError(e,t){this.stats.get(_e).incrementCount();const n=t.message||t.toString(),r=e.url;de.error("A 3D tile failed to load: "+e.url+" "+n),this.options.onTileError(e,n,r)}_onTileLoad(e,t){if(t){if(this.type===S.i3.I3S){var n,o;const e=(null==(n=this.tileset)||null==(o=n.nodePagesTile)?void 0:o.nodesInNodePages)||0;this.stats.get(fe).reset(),this.stats.get(fe).addCount(e)}e&&e.content&&function(e,t){(0,h.h)(e),(0,h.h)(t);const{rtcCenter:n,gltfUpAxis:o}=t,{computedTransform:a,boundingVolume:{center:l}}=e;let c=new r.Z(a);switch(n&&c.translate(n),o){case"Z":default:break;case"Y":const e=(new r.Z).rotateX(Math.PI/2);c=c.multiplyRight(e);break;case"X":const t=(new r.Z).rotateY(-Math.PI/2);c=c.multiplyRight(t)}t.isQuantized&&c.translate(t.quantizedVolumeOffset).scale(t.quantizedVolumeScale);const u=new i.Z(l);t.cartesianModelMatrix=c,t.cartesianOrigin=u;const d=s.H.WGS84.cartesianToCartographic(u,new i.Z),f=s.H.WGS84.eastNorthUpToFixedFrame(u).invert();t.cartographicModelMatrix=f.multiplyRight(c),t.cartographicOrigin=d,t.coordinateSystem||(t.modelMatrix=t.cartographicModelMatrix)}(e,e.content),this.updateContentTypes(e),this._addTileToCache(e),this.options.onTileLoad(e)}}updateContentTypes(e){if(this.type===S.i3.I3S)switch(e.header.isDracoGeometry&&(this.contentFormats.draco=!0),e.header.textureFormat){case"dds":this.contentFormats.dds=!0;break;case"ktx2":this.contentFormats.ktx2=!0}else if(this.type===S.i3.TILES3D){var t;const{extensionsRemoved:n=[]}=(null==(t=e.content)?void 0:t.gltf)||{};n.includes("KHR_draco_mesh_compression")&&(this.contentFormats.draco=!0),n.includes("EXT_meshopt_compression")&&(this.contentFormats.meshopt=!0),n.includes("KHR_texture_basisu")&&(this.contentFormats.ktx2=!0)}}_onStartTileLoading(){this._pendingCount++,this.stats.get(ge).incrementCount()}_onEndTileLoading(){this._pendingCount--,this.stats.get(ge).decrementCount()}_addTileToCache(e){this._cache.add(this,e,(t=>t._updateCacheStats(e)))}_updateCacheStats(e){this.stats.get(Ce).incrementCount(),this.stats.get(Ae).incrementCount(),this.gpuMemoryUsageInBytes+=e.gpuMemoryUsageInBytes||0,this.stats.get(Ee).count=this.gpuMemoryUsageInBytes}_unloadTile(e){this.gpuMemoryUsageInBytes-=e.gpuMemoryUsageInBytes||0,this.stats.get(Ae).decrementCount(),this.stats.get(Be).incrementCount(),this.stats.get(Ee).count=this.gpuMemoryUsageInBytes,this.options.onTileUnload(e),e.unloadContent()}_destroy(){const e=[];for(this.root&&e.push(this.root);e.length>0;){const t=e.pop();for(const n of t.children)e.push(n);this._destroyTile(t)}this.root=null}_destroySubtree(e){const t=e,n=[];for(n.push(t);n.length>0;){e=n.pop();for(const t of e.children)n.push(t);e!==t&&this._destroyTile(e)}t.children=[]}_destroyTile(e){this._cache.unloadTile(this,e),this._unloadTile(e),e.destroy()}_initializeTiles3DTileset(e){if(e.queryString){const t=new URLSearchParams(e.queryString),n=Object.fromEntries(t.entries());this._queryParams={...this._queryParams,...n}}if(this.asset=e.asset,!this.asset)throw new Error("Tileset must have an asset property.");if("0.0"!==this.asset.version&&"1.0"!==this.asset.version&&"1.1"!==this.asset.version)throw new Error("The tileset must be 3D Tiles version either 0.0 or 1.0 or 1.1.");"tilesetVersion"in this.asset&&(this._queryParams.v=this.asset.tilesetVersion),this.credits={attributions:this.options.attributions||[]},this.description=this.options.description||"",this.properties=e.properties,this.geometricError=e.geometricError,this._extensionsUsed=e.extensionsUsed||[],this.extras=e.extras}_initializeI3STileset(){this.loadOptions.i3s&&"token"in this.loadOptions.i3s&&(this._queryParams.token=this.loadOptions.i3s.token)}}},67625:(e,t,n)=>{"use strict";function r(e,t){if(!e)throw new Error(t||"loaders.gl assertion failed.")}n.d(t,{h:()=>r})},56369:(e,t,n)=>{"use strict";n.d(t,{hJ:()=>s,jU:()=>i,tq:()=>o});var r=n(34155);"undefined"!=typeof self&&self,"undefined"!=typeof window&&window,void 0!==n.g&&n.g,"undefined"!=typeof document&&document;const i="object"!=typeof r||"[object process]"!==String(r)||r.browser,s="function"==typeof importScripts,o="undefined"!=typeof window&&void 0!==window.orientation,a=void 0!==r&&r.version&&/v([0-9]*)/.exec(r.version);a&&parseFloat(a[1])},34329:(e,t,n)=>{"use strict";n.d(t,{e:()=>i,q:()=>s});var r=n(25108);const i="beta";const s=(null!=(o=globalThis._loadersgl_)&&o.version||(globalThis._loadersgl_=globalThis._loadersgl_||{},"undefined"==typeof __VERSION__?(r.warn("loaders.gl: The __VERSION__ variable is not injected using babel plugin. Latest unstable workers would be fetched from the CDN."),globalThis._loadersgl_.version=i):globalThis._loadersgl_.version=__VERSION__),globalThis._loadersgl_.version);var o},94236:(e,t,n)=>{"use strict";n.d(t,{Y:()=>c});var r=n(56369),i=n(34184),s=n(67625),o=n(34329),a=n(25108);const l={};async function c(e,t,n,c){return void 0===t&&(t=null),void 0===n&&(n={}),void 0===c&&(c=null),t&&(e=function(e,t,n,i){void 0===n&&(n={});void 0===i&&(i=null);if(!n.useLocalLibraries&&e.startsWith("http"))return e;i=i||e;const a=n.modules||{};if(a[i])return a[i];if(!r.jU)return"modules/"+t+"/dist/libs/"+i;if(n.CDN)return(0,s.h)(n.CDN.startsWith("http")),n.CDN+"/"+t+"@"+o.q+"/dist/libs/"+i;if(r.hJ)return"../src/libs/"+i;return"modules/"+t+"/src/libs/"+i}(e,t,n,c)),l[e]=l[e]||async function(e){if(e.endsWith("wasm"))return await async function(e){if(r.jU||!i.readFileAsArrayBuffer||e.startsWith("http")){const t=await fetch(e);return await t.arrayBuffer()}return await i.readFileAsArrayBuffer(e)}(e);if(!r.jU)try{return i&&i.requireFromFile&&await i.requireFromFile(e)}catch(n){return a.error(n),null}if(r.hJ)return importScripts(e);const t=await async function(e){if(r.jU||!i.readFileAsText||e.startsWith("http")){const t=await fetch(e);return await t.text()}return await i.readFileAsText(e)}(e);return function(e,t){if(!r.jU)return i.requireFromString&&i.requireFromString(e,t);if(r.hJ)return eval.call(globalThis,e),null;const n=document.createElement("script");n.id=t;try{n.appendChild(document.createTextNode(e))}catch(s){n.text=e}return document.body.appendChild(n),null}(t,e)}(e),await l[e]}},34073:(e,t,n)=>{"use strict";n.d(t,{h6:()=>A,SK:()=>T});var r=n(67294),i=n(19521);const s=e=>"@media screen and (max-width: 480px)";i.ZP.div.withConfig({displayName:"styled__PanelContainer",componentId:"sc-1apdasb-0"})(["font-size:14px;position:absolute;top:0;right:0;width:344px;background:var(--ifm-color-white);box-shadow:var(--ifm-global-shadow-lw);margin:24px;padding:10px 24px;max-height:96%;overflow-x:hidden;overflow-y:auto;overflow-y:overlay;outline:none;z-index:1;","{width:auto;left:0;}"],s),i.ZP.div.withConfig({displayName:"styled__PanelExpander",componentId:"sc-1apdasb-1"})(["display:none;width:16px;height:16px;font-family:serif;font-size:0.8em;text-align:center;line-height:16px;border-radius:50%;background:",";color:",";","{display:block;}"],(e=>e.$expanded?"none":"var(--ifm-color-gray-900)"),(e=>e.$expanded?"var(--ifm-color-black)":"var(--ifm-color-white)"),s),i.ZP.div.withConfig({displayName:"styled__PanelTitle",componentId:"sc-1apdasb-2"})(["display:flex;align-items:center;justify-content:space-between;font:bold 1.25em var(--ifm-font-family-base);margin:8px 0;","{cursor:pointer;}"],s),i.ZP.div.withConfig({displayName:"styled__PanelContent",componentId:"sc-1apdasb-3"})(["div > *{vertical-align:middle;white-space:nowrap;}div > label{display:inline-block;width:40%;margin-right:10%;color:var(--ifm-color-gray-800);margin-top:2px;margin-bottom:2px;}div > input,div > a,div > button,div > select{background:var(--ifm-color-white);font:normal 11px/16px var(--ifm-font-family-base);line-height:20px;text-transform:none;text-overflow:ellipsis;overflow:hidden;display:inline-block;padding:0 4px;width:50%;height:20px;text-align:left;}div > button{color:initial;}div > button:disabled{color:var(--ifm-color-gray-300);cursor:default;background:var(--ifm-color-gray-300);}div > input{border:solid 1px var(--ifm-color-gray-300);&:disabled{background:var(--ifm-color-white);}&[type='checkbox']{height:auto;}}p{margin-bottom:12px;white-space:initial;}","{display:",";}"],s,(e=>e.$expanded?"block":"none")),i.ZP.a.withConfig({displayName:"styled__SourceLink",componentId:"sc-1apdasb-4"})(["display:block;text-align:right;margin-top:8px;font:bold 12px/20px var(--ifm-font-family-base);color:var(--ifm-color-gray-800);","{display:",";}"],s,(e=>e.$expanded?"block":"none")),i.ZP.div.withConfig({displayName:"input__InputContainer",componentId:"sc-1myx0c6-0"})(['position:relative;width:100%;&:last-child{margin-bottom:20px;}>*{vertical-align:middle;white-space:nowrap;}label{display:inline-block;width:40%;margin-right:10%;margin-top:2px;margin-bottom:2px;}input,a,button{background:var(--ifm-color-white);font-size:0.9em;text-transform:none;text-overflow:ellipsis;overflow:hidden;display:inline-block;padding:0 4px;margin:0;width:50%;height:20px;line-height:1.833;text-align:left;}button{color:initial;}button:disabled{color:var(--ifm-color-gray-500);cursor:default;background:var(--ifm-color-gray-300);}input{border:solid 1px var(--ifm-color-gray-500);&:disabled{background:var(--ifm-color-gray-300);}&[type="checkbox"]{height:auto;}}.tooltip{left:50%;top:24px;opacity:0;pointer-events:none;transition:opacity 200ms;}&:hover .tooltip{opacity:1;}']);i.ZP.div.withConfig({displayName:"spinner__SpinnerContainer",componentId:"sc-1bueeoo-0"})(["height:18px;line-height:18px;font-size:10px;>div{white-space:nowrap;left:0;bottom:0;position:absolute;height:18px;padding-left:20px;transition:width 0.5s;}.spinner--fill{background:$primary;color:$white;overflow:hidden;}.spinner--text{color:$black-40;}&.done{height:0 !important;line-height:0;font-size:0;transition:height 0.5s 1s;>div{height:0 !important;transition:height 0.5s 1s;}}"]);i.ZP.div.withConfig({displayName:"info-panel__InfoPanelContent",componentId:"sc-gwdklj-0"})(["hr{margin:12px -24px;}a{text-decoration:none;display:inline;color:var(--ifm-color-primary);}p{margin-bottom:16px;}.legend{display:inline-block;width:12px;height:12px;}.stat{text-transform:uppercase;font-size:0.833em;b{display:block;font-size:3em;font-weight:bold;line-height:1.833;}}hr{border:none;background:var(--ifm-color-gray-400);height:1px;}.layout{display:table;width:100%;>*{display:table-cell !important;}.col-1-3{width:33.33%;}.col-1-2{width:50%;}.text-right{text-align:right;}.text-center{text-align:center;}}"]);n(97765);var o=n(79524);i.ZP.div.withConfig({displayName:"make-example__DemoContainer",componentId:"sc-1tc496z-0"})([".tooltip,.deck-tooltip{position:absolute;padding:4px 12px;background:rgba(0,0,0,0.8);color:var(--ifm-color-white);max-width:300px;font-size:12px;z-index:9;pointer-events:none;white-space:nowrap;}"]),i.ZP.div.withConfig({displayName:"make-example__MapTip",componentId:"sc-1tc496z-1"})(["position:absolute;right:12px;bottom:20px;color:var(--ifm-color-white);mix-blend-mode:difference;font-size:14px;@media screen and (max-width:480px){display:none;}"]);var a=n(84432);const l=i.ZP.div.withConfig({displayName:"styled__ExampleHeader",componentId:"sc-wn8qmk-0"})(["font:bold 20px/28px var(--ifm-font-family-base);color:var(--ifm-color-gray-800);margin:0 20px;border-bottom:1px solid 20px;display:inline-block;padding:20px 20px 4px 0;"]),c=i.ZP.main.withConfig({displayName:"styled__MainExamples",componentId:"sc-wn8qmk-1"})(["padding:16px 0;"]),u=i.ZP.main.withConfig({displayName:"styled__ExamplesGroup",componentId:"sc-wn8qmk-2"})(["display:flex;flex-wrap:wrap;padding:16px;"]),d=i.ZP.a.withConfig({displayName:"styled__ExampleCard",componentId:"sc-wn8qmk-3"})(["cursor:pointer;text-decoration:none;width:50%;max-width:240px;line-height:0;outline:none;padding:4px;position:relative;img{transition-property:filter;transition-duration:var(--ifm-transition-slow);transition-timing-function:var(--ifm-transition-timing-default);}&:hover{box-shadow:var(--ifm-global-shadow-md);}&:hover img{filter:contrast(0.2);}","{width:33%;min-width:200px;}@media screen and (max-width:632px){width:50%;}"],s),h=i.ZP.div.withConfig({displayName:"styled__ExampleTitle",componentId:"sc-wn8qmk-4"})(["position:absolute;display:flex;justify-content:center;flex-direction:column;color:var(--ifm-color-white);font-size:1.5em;text-align:center;line-height:initial;width:90%;height:90%;top:5%;left:5%;border:solid 1px var(--ifm-color-white);opacity:0;transition-property:opacity;transition-duration:var(--ifm-transition-slow);transition-timing-function:var(--ifm-transition-timing-default);&:hover{opacity:1;}"]);function f(e,t){let{label:n,items:i}=e;return[r.createElement(l,{key:n+"-header"},n),r.createElement(u,{key:n},i.map((e=>function(e,t){const n=(0,o.Z)(t(e)),{label:i,href:s}=e;return r.createElement(d,{key:i,href:s},r.createElement("img",{width:"100%",src:n,alt:i}),r.createElement(h,null,r.createElement("span",null,i)))}(e,t))))]}function A(e){let{getThumbnail:t}=e;const n=(0,a.V)();return r.createElement(c,null,n.items.map((e=>"category"===e.type?f(e,t):null)))}var p=n(39962);const m=i.ZP.section.withConfig({displayName:"styled__Banner",componentId:"sc-exnbu5-0"})(["position:relative;height:30rem;background:var(--ifm-color-gray-400);color:var(--ifm-color-gray-900);z-index:0;","{height:80vh;}"],s),C=i.ZP.div.withConfig({displayName:"styled__Container",componentId:"sc-exnbu5-1"})(["position:relative;padding:2rem;max-width:80rem;width:100%;height:100%;margin:0;"]),g=(0,i.ZP)(C).withConfig({displayName:"styled__BannerContainer",componentId:"sc-exnbu5-2"})(["position:absolute;bottom:0;height:auto;padding-left:4rem;z-index:0;pointer-events:none;"]),B=i.ZP.div.withConfig({displayName:"styled__HeroExampleContainer",componentId:"sc-exnbu5-3"})(["position:absolute;top:0;left:0;right:0;bottom:0;z-index:-1;"]),_=(i.ZP.section.withConfig({displayName:"styled__Section",componentId:"sc-exnbu5-4"})(["&:nth-child(2n + 1){background:var(--ifm-color-gray-300);}"]),i.ZP.h1.withConfig({displayName:"styled__ProjectName",componentId:"sc-exnbu5-5"})(["font-size:5em;line-height:1;text-transform:uppercase;text-shadow:1px 1px 1px black,0 0 1em white,0 0 0.2em white;letter-spacing:4px;font-weight:700;margin:0;margin-bottom:16px;"])),y=i.ZP.p.withConfig({displayName:"styled__TagLine",componentId:"sc-exnbu5-6"})(["text-shadow:1px 1px 2px black,0 0 1em white,0 0 0.2em lightblue;"]),E=i.ZP.a.withConfig({displayName:"styled__GetStartedLink",componentId:"sc-exnbu5-7"})(["pointer-events:all;font-size:12px;line-height:44px;letter-spacing:2px;font-weight:bold;margin:24px 0;padding:0 4rem;pointer-events:all;display:inline-block;text-decoration:none;transition:background-color 250ms ease-in,color 250ms ease-in;border:solid 2px var(--ifm-color-primary);color:var(--ifm-color-gray-900);border-image:linear-gradient( to right,var(--ifm-color-gray-700) 0%,var(--ifm-color-gray-400) 100% );border-image-slice:2;&:visited{color:var(--ifm-color-gray-900);}&:active{color:var(--ifm-color-white);}&:hover{color:var(--ifm-color-white);background-color:var(--ifm-color-primary);}"]);function T(e){let{HeroExample:t,children:n}=e;const{siteConfig:i}=(0,p.Z)();return r.createElement(r.Fragment,null,r.createElement(m,null,r.createElement(B,null,t&&r.createElement(t,null)),r.createElement(g,null,r.createElement(_,null,i.title),r.createElement(y,null,i.tagline),r.createElement(E,{href:"./docs/developer-guide/get-started"},"GET STARTED"))),n)}},87218:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>f});var r=n(67294),i=n(34073),s=n(79524),o=n(19521),a=n(87833),l=n(52278);const c=o.ZP.div.withConfig({displayName:"pages__FeatureImage",componentId:"sc-tl00pn-0"})(["position:absolute;height:100%;width:50%;bottom:0;right:0;z-index:-1;background:url(",");background-size:contain;background-repeat:no-repeat;background-position:bottom right;@media screen and (max-width:1420px){width:37%;}@media screen and (max-width:768px){display:none;}"],(e=>e.src)),u=o.ZP.div.withConfig({displayName:"pages__TextContainer",componentId:"sc-tl00pn-1"})(["max-width:800px;padding:50px 112px 50px 80px;width:70%;font-size:14px;h3{font:bold 16px/24px;margin:16px 0 0;position:relative;}h3 > img{position:absolute;top:-4px;width:36px;left:-48px;}@media screen and (max-width:768px){max-width:100%;width:100%;padding:48px 80px;}"]),d=o.ZP.div.withConfig({displayName:"pages__Description",componentId:"sc-tl00pn-2"})(["display:flex;flex-direction:row;gap:15px;align-items:center;h2{font:bold 32px/48px;margin:24px 0;position:relative;}> img{width:3em;height:3em;@media screen and (max-width:768px){display:none;}}"]),h=()=>r.createElement("img",{src:"/images/icon-high-precision.svg"});function f(){const e=(0,s.Z)("/");return r.createElement(a.Z,{title:"Home",description:"deck.gl"},r.createElement(i.SK,{HeroExample:l.i5},r.createElement("div",{style:{position:"relative"}},r.createElement(c,{src:e+"images/maps.jpg"}),r.createElement(u,null,r.createElement(d,null,r.createElement(h,null),r.createElement("h2",null,"Parsers and encoders for major geospatial, tabular and 3D formats.")),r.createElement(d,null,r.createElement(h,null),r.createElement("h2",null,"Can be used with any JavaScript applications.")),r.createElement(d,null,r.createElement(h,null),r.createElement("h2",null,"Move your code between browser, worker threads and Node.js and rely on your loaders to keep working."))))))}},97765:(e,t,n)=>{"use strict";n.d(t,{V:()=>r});n(64641);function r(e,t){return t.match(/^\w+:\/\//)?t:e.replace(/\/$/,"")+"/"+t.replace(/^\//,"")}},64641:()=>{"use strict";var e="$";function t(){}function n(e,n){var r=new t;if(e instanceof t)e.each((function(e,t){r.set(t,e)}));else if(Array.isArray(e)){var i,s=-1,o=e.length;if(null==n)for(;++s<o;)r.set(s,e[s]);else for(;++s<o;)r.set(n(i=e[s],s,e),i)}else if(e)for(var a in e)r.set(a,e[a]);return r}t.prototype=n.prototype={constructor:t,has:function(t){return e+t in this},get:function(t){return this[e+t]},set:function(t,n){return this[e+t]=n,this},remove:function(t){var n=e+t;return n in this&&delete this[n]},clear:function(){for(var t in this)t[0]===e&&delete this[t]},keys:function(){var t=[];for(var n in this)n[0]===e&&t.push(n.slice(1));return t},values:function(){var t=[];for(var n in this)n[0]===e&&t.push(this[n]);return t},entries:function(){var t=[];for(var n in this)n[0]===e&&t.push({key:n.slice(1),value:this[n]});return t},size:function(){var t=0;for(var n in this)n[0]===e&&++t;return t},empty:function(){for(var t in this)if(t[0]===e)return!1;return!0},each:function(t){for(var n in this)n[0]===e&&t(this[n],n.slice(1),this)}};const r=n;function i(){}var s=r.prototype;function o(e,t){var n=new i;if(e instanceof i)e.each((function(e){n.add(e)}));else if(e){var r=-1,s=e.length;if(null==t)for(;++r<s;)n.add(e[r]);else for(;++r<s;)n.add(t(e[r],r,e))}return n}i.prototype=o.prototype={constructor:i,has:s.has,add:function(t){return this[e+(t+="")]=t,this},remove:s.remove,clear:s.clear,values:s.keys,size:s.size,empty:s.empty,each:s.each};var a={value:function(){}};function l(){for(var e,t=0,n=arguments.length,r={};t<n;++t){if(!(e=arguments[t]+"")||e in r||/[\s.]/.test(e))throw new Error("illegal type: "+e);r[e]=[]}return new c(r)}function c(e){this._=e}function u(e,t){for(var n,r=0,i=e.length;r<i;++r)if((n=e[r]).name===t)return n.value}function d(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=a,e=e.slice(0,r).concat(e.slice(r+1));break}return null!=n&&e.push({name:t,value:n}),e}c.prototype=l.prototype={constructor:c,on:function(e,t){var n,r,i=this._,s=(r=i,(e+"").trim().split(/^|\s+/).map((function(e){var t="",n=e.indexOf(".");if(n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),e&&!r.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:t}}))),o=-1,a=s.length;if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++o<a;)if(n=(e=s[o]).type)i[n]=d(i[n],e.name,t);else if(null==t)for(n in i)i[n]=d(i[n],e.name,null);return this}for(;++o<a;)if((n=(e=s[o]).type)&&(n=u(i[n],e.name)))return n},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new c(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),s=0;s<n;++s)i[s]=arguments[s+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=0,n=(r=this._[e]).length;s<n;++s)r[s].value.apply(t,i)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,s=r.length;i<s;++i)r[i].value.apply(t,n)}};const h=l;function f(e,t){var n,i,s,o,a=h("beforesend","progress","load","error"),l=r(),c=new XMLHttpRequest,u=null,d=null,f=0;function A(e){var t,r=c.status;if(!r&&function(e){var t=e.responseType;return t&&"text"!==t?e.response:e.responseText}(c)||r>=200&&r<300||304===r){if(s)try{t=s.call(n,c)}catch(i){return void a.call("error",n,i)}else t=c;a.call("load",n,t)}else a.call("error",n,e)}if("undefined"!=typeof XDomainRequest&&!("withCredentials"in c)&&/^(http(s)?:)?\/\//.test(e)&&(c=new XDomainRequest),"onload"in c?c.onload=c.onerror=c.ontimeout=A:c.onreadystatechange=function(e){c.readyState>3&&A(e)},c.onprogress=function(e){a.call("progress",n,e)},n={header:function(e,t){return e=(e+"").toLowerCase(),arguments.length<2?l.get(e):(null==t?l.remove(e):l.set(e,t+""),n)},mimeType:function(e){return arguments.length?(i=null==e?null:e+"",n):i},responseType:function(e){return arguments.length?(o=e,n):o},timeout:function(e){return arguments.length?(f=+e,n):f},user:function(e){return arguments.length<1?u:(u=null==e?null:e+"",n)},password:function(e){return arguments.length<1?d:(d=null==e?null:e+"",n)},response:function(e){return s=e,n},get:function(e,t){return n.send("GET",e,t)},post:function(e,t){return n.send("POST",e,t)},send:function(t,r,s){return c.open(t,e,!0,u,d),null==i||l.has("accept")||l.set("accept",i+",*/*"),c.setRequestHeader&&l.each((function(e,t){c.setRequestHeader(t,e)})),null!=i&&c.overrideMimeType&&c.overrideMimeType(i),null!=o&&(c.responseType=o),f>0&&(c.timeout=f),null==s&&"function"==typeof r&&(s=r,r=null),null!=s&&1===s.length&&(s=function(e){return function(t,n){e(null==t?n:null)}}(s)),null!=s&&n.on("error",s).on("load",(function(e){s(null,e)})),a.call("beforesend",n,c),c.send(null==r?null:r),n},abort:function(){return c.abort(),n},on:function(){var e=a.on.apply(a,arguments);return e===a?n:e}},null!=t){if("function"!=typeof t)throw new Error("invalid callback: "+t);return n.get(t)}return n}function A(e,t){return function(n,r){var i=f(n).mimeType(e).response(t);if(null!=r){if("function"!=typeof r)throw new Error("invalid callback: "+r);return i.get(r)}return i}}A("text/html",(function(e){return document.createRange().createContextualFragment(e.responseText)})),A("application/json",(function(e){return JSON.parse(e.responseText)})),A("text/plain",(function(e){return e.responseText})),A("application/xml",(function(e){var t=e.responseXML;if(!t)throw new Error("parse error");return t}));var p={},m={};function C(e){return new Function("d","return {"+e.map((function(e,t){return JSON.stringify(e)+": d["+t+'] || ""'})).join(",")+"}")}function g(e){var t=Object.create(null),n=[];return e.forEach((function(e){for(var r in e)r in t||n.push(t[r]=r)})),n}function B(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function _(e){var t,n=e.getUTCHours(),r=e.getUTCMinutes(),i=e.getUTCSeconds(),s=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":((t=e.getUTCFullYear())<0?"-"+B(-t,6):t>9999?"+"+B(t,6):B(t,4))+"-"+B(e.getUTCMonth()+1,2)+"-"+B(e.getUTCDate(),2)+(s?"T"+B(n,2)+":"+B(r,2)+":"+B(i,2)+"."+B(s,3)+"Z":i?"T"+B(n,2)+":"+B(r,2)+":"+B(i,2)+"Z":r||n?"T"+B(n,2)+":"+B(r,2)+"Z":"")}function y(e){var t=new RegExp('["'+e+"\n\r]"),n=e.charCodeAt(0);function r(e,t){var r,i=[],s=e.length,o=0,a=0,l=s<=0,c=!1;function u(){if(l)return m;if(c)return c=!1,p;var t,r,i=o;if(34===e.charCodeAt(i)){for(;o++<s&&34!==e.charCodeAt(o)||34===e.charCodeAt(++o););return(t=o)>=s?l=!0:10===(r=e.charCodeAt(o++))?c=!0:13===r&&(c=!0,10===e.charCodeAt(o)&&++o),e.slice(i+1,t-1).replace(/""/g,'"')}for(;o<s;){if(10===(r=e.charCodeAt(t=o++)))c=!0;else if(13===r)c=!0,10===e.charCodeAt(o)&&++o;else if(r!==n)continue;return e.slice(i,t)}return l=!0,e.slice(i,s)}for(10===e.charCodeAt(s-1)&&--s,13===e.charCodeAt(s-1)&&--s;(r=u())!==m;){for(var d=[];r!==p&&r!==m;)d.push(r),r=u();t&&null==(d=t(d,a++))||i.push(d)}return i}function i(t,n){return t.map((function(t){return n.map((function(e){return o(t[e])})).join(e)}))}function s(t){return t.map(o).join(e)}function o(e){return null==e?"":e instanceof Date?_(e):t.test(e+="")?'"'+e.replace(/"/g,'""')+'"':e}return{parse:function(e,t){var n,i,s=r(e,(function(e,r){if(n)return n(e,r-1);i=e,n=t?function(e,t){var n=C(e);return function(r,i){return t(n(r),i,e)}}(e,t):C(e)}));return s.columns=i||[],s},parseRows:r,format:function(t,n){return null==n&&(n=g(t)),[n.map(o).join(e)].concat(i(t,n)).join("\n")},formatBody:function(e,t){return null==t&&(t=g(e)),i(e,t).join("\n")},formatRows:function(e){return e.map(s).join("\n")},formatRow:s,formatValue:o}}var E=y(","),T=E.parse;E.parseRows,E.format,E.formatBody,E.formatRows,E.formatRow,E.formatValue;function b(e,t){return function(n,r,i){arguments.length<3&&(i=r,r=null);var s=f(n).mimeType(e);return s.row=function(e){return arguments.length?s.response(function(e,t){return function(n){return e(n.responseText,t)}}(t,r=e)):r},s.row(r),i?s.get(i):s}}b("text/csv",T);var S=y("\t"),w=S.parse;S.parseRows,S.format,S.formatBody,S.formatRows,S.formatRow,S.formatValue;b("text/tab-separated-values",w)},34184:()=>{}}]);